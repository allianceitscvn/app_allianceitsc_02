(this["webpackJsonpapp-admin-v5"]=this["webpackJsonpapp-admin-v5"]||[]).push([[34],{1322:function(e,t,a){"use strict";a.r(t);var n,s=a(22),i=a(31),o=a(4),r=a(16),l=a(17),c=a(18),d=a(19),u=a(0),f=a(20),p=a(88),h=a(1),g=a(11),j=a(10),k=a(661),m=a(9),b=(a(57),a(659)),v=a(658),x=a(2),O=function(e){Object(c.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).requestOptions=function(){n.setState({loading:!0},(function(){Object(p.a)({request:{method:"POST",path:"/api/v1/UserTask_Mine",name:"Options"},data:{},successCallBack:function(e){e.Data&&n.setState({options:e.Data,loading:!1},(function(){n.requestTasks(),n.requestTasksToday()}))},errorCallBack:function(e){console.log(e),n.setState({loading:!1})}})}))},n.requestTasks=function(){n.setState({loadingTasks:!0},(function(){Object(p.a)({request:{method:"POST",path:"/api/v1/UserTask_Mine",name:"List"},data:Object(o.a)(Object(o.a)({},n.state.filters),n.state.pagination),successCallBack:function(e){var t,a;n.setState({tasks:(null===(t=e.Data)||void 0===t?void 0:t.Data)||[],total:null===(a=e.Data)||void 0===a?void 0:a.Total,loadingTasks:!1})},errorCallBack:function(e){console.log(e),n.setState({loadingTasks:!1})}})}))},n.requestTasksToday=function(){n.setState({loadingTasksToday:!0},(function(){Object(p.a)({request:{method:"POST",path:"/api/v1/UserTask_Mine",name:"GetTasks"},data:{IsStartedOnToday:!0},successCallBack:function(e){var t=n.state.dailytaskId||[];if(e.Data){var a,s=Object(i.a)(e.Data);try{for(s.s();!(a=s.n()).done;){var o=a.value;o&&o.Id&&t.push(o.Id)}}catch(r){s.e(r)}finally{s.f()}}n.setState({tasksToday:e.Data,loadingTasksToday:!1,dailytaskId:t,showReportStart:0==t.length,showReportEnd:t.length>0})},errorCallBack:function(e){console.log(e),n.setState({loadingTasksToday:!1})}})}))},n.requestAddNewTask=function(){n.setState({loading:!0},(function(){Object(p.a)({request:{method:"POST",path:"/api/v1/UserTask",name:"Add"},data:{},successCallBack:function(e){if(n._hasChangedData=!0,e.Data){var t=n.state.newTasks||[],a=n.state.dailytaskId||[];t.push(e.Data),a.push(e.Data.Id),n.setState({newTasks:t,dailytaskId:a,loading:!1})}else n.setState({loading:!1})},errorCallBack:function(e){console.log(e),n.setState({loading:!1})}})}))},n.checkValidBeforeSendReport=function(e,t){var a=!0;return e&&(null!=e.ProjectId&&""!=e.ProjectId.length||(a=!1),null!=e.TaskName&&""!=e.TaskName.length||(a=!1),!0===t&&(null!=e.PercentCompleted&&""!=e.PercentCompleted&&0!=e.PercentCompleted||(a=!1))),a},n.requestSubmitDailyTask=function(){var e,t=n.props.fnList||{},a=[],s=n.state.dailytaskId||[],o=!0,r=Object(i.a)(s);try{for(r.s();!(e=r.n()).done;){var l=e.value,c=n.getTaskById(l);c&&c.Id&&(a.push({UserTaskId:l,UserTaskName:c.TaskName,ProjectId:c.ProjectId,Percent:c.PercentCompleted}),o=n.checkValidBeforeSendReport(c))}}catch(d){r.e(d)}finally{r.f()}0!=o?a.length>0?g.f.showConfirm({title:"Send task report",msg:"Are you sure you want to send task report at the beginning of the day?",onClickOK:function(e){m.g.showLoadingModal(e._fnList,[]),Object(p.a)({request:{method:"POST",path:"/api/v1/UserTaskDailyReport",name:"SubmitStart"},data:{Tasks:a},successCallBack:function(a){m.g.hideLoadingModal(e._fnList,[]),m.g.hideModal(e._fnList,[]),h.HUtils.runFuntion(t,"hideModal",[])},errorCallBack:function(t){console.log(t),m.g.hideLoadingModal(e._fnList,[])}})}}):j.k.showToastWarning("Please select your tasks before send report."):j.k.showToastWarning("Each task need Project, Name before send report")},n.requestSubmitDailyTaskEnd=function(){var e,t=n.props.fnList||{},a=[],s=n.state.dailytaskId||[],o=!0,r=Object(i.a)(s);try{for(r.s();!(e=r.n()).done;){var l=e.value,c=n.getTaskById(l);a.push({UserTaskId:l,UserTaskName:c.TaskName,ProjectId:c.ProjectId,Percent:c.PercentCompleted}),o=n.checkValidBeforeSendReport(c,!0)}}catch(d){r.e(d)}finally{r.f()}0!=o?a.length>0?g.f.showConfirm({title:"Send task report",msg:"Are you sure you want to send task report at the end of the day?",onClickOK:function(e){m.g.showLoadingModal(e._fnList,[]),Object(p.a)({request:{method:"POST",path:"/api/v1/UserTaskDailyReport",name:"SubmitEnd"},data:{Tasks:a},successCallBack:function(a){m.g.hideLoadingModal(e._fnList,[]),m.g.hideModal(e._fnList,[]),h.HUtils.runFuntion(t,"hideModal",[])},errorCallBack:function(t){console.log(t),m.g.hideLoadingModal(e._fnList,[])}})}}):j.k.showToastWarning("Please select your tasks before send report."):j.k.showToastWarning("Each task need Project, Name, Percent before send report")},n.addToDailyTask=function(e){var t=n.state.dailytaskId||[];-1==t.indexOf(e.Id)&&(t.push(e.Id),n._tasksById[e.Id]=e),n.setState({dailytaskId:t})},n.removeDailiTask=function(e){var t=n.state.dailytaskId||[],a=t.indexOf(e.Id);a>-1&&t.splice(a,1),n.setState({dailytaskId:t})},n.getTaskById=function(e){var t=n.state.tasks||[],a=n.state.newTasks||[],s=n.state.tasksToday||[];if(t)for(var i=0;i<t.length;i++)if(t[i].Id==e)return t[i];if(a)for(var o=0;o<a.length;o++)if(a[o].Id==e)return a[o];if(s)for(var r=0;r<s.length;r++)if(s[r].Id==e)return s[r];if(n._tasksById&&n._tasksById[e])return n._tasksById[e]},n.state={tasks:null,tasksToday:null,dailytaskId:[],newTasks:[],options:null,loading:!0,loadingTasks:!0,loadingTasksToday:!0,showReportStart:!1,showReportEnd:!1,filters:{},pagination:{Page:1,PageSize:20},total:0},n._hasChangedData=!1,n._tasksById={},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.requestOptions(),this._modal=h.HUtils.runFuntion(this.props.fnList,"getModal",[]),this._modal&&(console.log("modal",this._modal),this._modal.onClose=function(){console.log("on Close"),e._hasChangedData&&h.HUtils.runFuntion(e.props.fnList,"reloadTasks",[])})}},{key:"render",value:function(){var e=this,t=this.state.tasks,a=this.state.dailytaskId||[];return Object(x.jsxs)(y,{children:[Object(x.jsxs)("div",{className:"a-left",children:[Object(x.jsxs)("div",{className:"a-header",children:[Object(x.jsxs)("div",{className:"a-left-info",children:[Object(x.jsx)("div",{className:"a-left-title",children:"All tasks"}),Object(x.jsx)("div",{className:"a-left-filters",children:Object(x.jsx)(v.a,{mini:!0,fnList:{reloadTasks:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.filters;e.state.filters=a||{},e.state.pagination.Page=1,e.requestTasks()},getOptions:function(){return e.state.options}}})})]}),Object(x.jsx)("div",{className:"a-right-btns"})]}),null==t?Object(x.jsx)("div",{children:1==this.state.loadingTasks&&Object(x.jsxs)("div",{className:"a-loading-tasks",children:[Object(x.jsx)(k.a,{}),Object(x.jsx)("div",{children:"Get tasks..."})]})}):Object(x.jsx)("div",{className:"a-list",children:t.length>0?Object(x.jsxs)("div",{children:[t.map((function(t,n){return a.indexOf(t.Id)>-1?Object(x.jsx)("div",{},t.Id||n):Object(x.jsxs)("div",{className:"a-task-item",children:[Object(x.jsx)(h.MyUI,{type:"prj_task_item",data:t,mode:"list"}),-1==a.indexOf(t.Id)&&Object(x.jsx)("div",{className:"a-to-right",onClick:function(){e.addToDailyTask(t)},children:Object(x.jsx)("i",{className:"fa fa-chevron-right"})})]},t.Id||n)})),Object(x.jsx)("div",{className:"a-pagination",children:Object(x.jsx)(b.a,{page:this.state.pagination.Page,total:this.state.total,pageSize:this.state.pagination.PageSize,onChangePage:function(t){e.setState({pagination:{Page:t,PageSize:e.state.pagination.PageSize}},(function(){e.requestTasks()}))}})})]}):Object(x.jsx)("div",{style:{padding:"5px"},children:"No Task! Create new one."})})]}),Object(x.jsxs)("div",{className:"a-right",children:[Object(x.jsxs)("div",{className:"a-header",children:[Object(x.jsx)("div",{className:"a-title",children:"Your daily tasks"}),Object(x.jsxs)("div",{className:"a-right-actions",children:[null!==this.state.showReportStart&&Object(x.jsx)("button",{className:"btn btn-primary",onClick:function(){e.requestSubmitDailyTask()},children:"Send Task Report (\u0110\u1ea7u ng\xe0y)"}),null!==this.state.showReportEnd&&Object(x.jsx)("button",{className:"btn btn-success",onClick:function(){e.requestSubmitDailyTaskEnd()},children:"Send Task Report (Cu\u1ed1i ng\xe0y)"})]})]}),Object(x.jsx)("div",{className:"a-main",children:1==this.state.loadingTasksToday?Object(x.jsxs)("div",{className:"a-loading-tasks",children:[Object(x.jsx)(k.a,{size:"12"}),Object(x.jsx)("div",{children:"Get tasks today..."})]}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"a-exist-tasks",children:[a.map((function(t,a){var n=e.getTaskById(t);return n?Object(x.jsxs)("div",{className:"a-wrap-task",children:[Object(x.jsx)(h.MyUI,{type:"prj_task_item",data:n,fnList:{getCanEdit:function(){return!0},getOptions:function(){return e.state.options},afterUpdateData:function(t){e._hasChangedData=!0}}}),Object(x.jsx)("div",{className:"a-remove",onClick:function(){e.removeDailiTask(n)},children:Object(x.jsx)("i",{className:"fa fa-trash"})})]},n.Id):Object(x.jsx)("div",{})})),null==a||0==a.length&&Object(x.jsx)("div",{className:"a-empty",children:"Select or add new your task!"})]}),Object(x.jsxs)("div",{children:[Object(x.jsx)("div",{}),Object(x.jsx)("div",{className:"a-wrap-addnewtask",children:Object(x.jsxs)("div",{onClick:function(){e.requestAddNewTask()},className:"a-add-new-task",children:[Object(x.jsx)("div",{children:Object(x.jsx)("i",{className:"fa fa-plus"})}),Object(x.jsx)("div",{children:"Add new task"})]})})]})]})}),Object(x.jsx)("div",{className:"a-footer"})]}),!0===this.state.loading&&Object(x.jsxs)("div",{className:"a-loading",children:[Object(x.jsx)(k.a,{}),"Loading..."]})]})}}]),a}(u.Component),y=f.b.div(n||(n=Object(s.a)(["\n  display: flex;\n  & > .a-loading {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    padding: 10px;\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    background: #ffffffa6;\n  }\n  & > .a-left {\n    width: 300px;\n    border: 1px solid #ededed;\n    height: calc(100vh - 160px);\n    border-top-left-radius: 10px;\n    & .a-loading-tasks {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      padding: 10px;\n    }\n    & > .a-header {\n      height: 60px;\n      background: #ededed;\n      border-bottom: 1px solid #dfdfdf;\n      display: flex;\n      align-items: center;\n      padding: 5px;\n      font-size: 20px;\n      border-top-left-radius: 10px;\n      & > .a-left-info {\n        & > .a-left-filters {\n        }\n      }\n      & > .a-right-btns {\n        margin-left: auto;\n      }\n    }\n    & .a-list {\n      overflow: auto;\n      height: calc(100% - 60px);\n      & .a-pagination {\n        margin-top: 1rem;\n        & .page-item.active .page-link {\n          background-color: #0082ff;\n        }\n        & .page-item .page-link {\n          border-radius: 0px;\n        }\n        & .page-item {\n          & a {\n            border-radius: 0px;\n          }\n        }\n      }\n    }\n    & .a-task-item {\n      padding: 4px;\n      padding-bottom: 0px;\n      display: flex;\n      & > div:first-child {\n        flex: 1;\n      }\n      & > .a-to-right {\n        display: flex;\n        align-items: center;\n        font-size: 20px;\n        padding: 5px;\n        cursor: pointer;\n        height: 40px;\n        align-self: center;\n        &:hover {\n          background: #efefef;\n          border-top-right-radius: 10px;\n          border-bottom-right-radius: 10px;\n        }\n      }\n    }\n  }\n  & > .a-right {\n    flex: 1;\n    border: 1px solid #ededed;\n    padding: 10px;\n    height: calc(100vh - 160px);\n    overflow: auto;\n    & .a-loading-tasks {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      padding: 10px;\n    }\n    & .a-header {\n      display: flex;\n      margin-bottom: 10px;\n      & .a-title {\n        font-size: 20px;\n        display: flex;\n        align-items: center;\n      }\n      & .a-right-actions {\n        margin-left: auto;\n        & > button {\n          margin-left: 5px;\n        }\n      }\n    }\n\n    & .a-exist-tasks {\n      padding: 10px;\n      border: 1px dashed #c5c5c5;\n      margin-bottom: 10px;\n      overflow: hidden;\n      & .a-empty {\n        color: #c5c5c5;\n        text-align: center;\n        padding: 1rem 0px;\n      }\n      & .a-wrap-task {\n        display: flex;\n        margin-bottom: 5px;\n        & > div:first-child {\n          flex: 1;\n        }\n        & > .a-remove {\n          width: 40px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          cursor: pointer;\n          height: 40px;\n          align-self: center;\n          &:hover {\n            background: #ffc9c9;\n            color: red;\n            border-top-right-radius: 10px;\n            border-bottom-right-radius: 10px;\n          }\n        }\n      }\n    }\n    & .a-wrap-addnewtask {\n      display: flex;\n      justify-content: center;\n      & .a-add-new-task {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        flex-direction: column;\n        cursor: pointer;\n        padding: 10px;\n        & i {\n          font-size: 20px;\n        }\n        &:hover {\n          background: #efefef;\n          border-radius: 10px;\n        }\n      }\n    }\n  }\n"])));t.default=O},658:function(e,t,a){"use strict";var n,s=a(22),i=a(16),o=a(17),r=a(18),l=a(19),c=a(0),d=a(20),u=(a(88),a(547),a(1)),f=a(11),p=a(57),h=a.n(p),g=a(2),j="all",k="todo",m="doing",b="done",v="notdone",x=function(e){Object(r.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).requestTasks=function(){var e=n.props.fnList||{};u.HUtils.runFuntion(e,"reloadTasks",[{filters:n.state.filters}])},n._getTypeFilter=function(){var e=n.state.filters||{};if(0==Object.keys(e).length)return j;if(e.TaskStatusCode){if("ToDo"==e.TaskStatusCode)return k;if("Done"==e.TaskStatusCode)return b;if("Doing"==e.TaskStatusCode)return m}else if(e.TaskStatusNotDone)return v;return""},n._clickFilter=function(e){var t=n.state.filters||{};e==j?t={}:e==k?(t.TaskStatusCode="ToDo",delete t.TaskStatusNotDone):e==b?(t.TaskStatusCode="Done",delete t.TaskStatusNotDone):e==m?(t.TaskStatusCode="Doing",delete t.TaskStatusNotDone):e==v&&(delete t.TaskStatusCode,t.TaskStatusNotDone=!0),n.setState({filters:t},(function(){n.requestTasks()}))},n.state={filters:{}},n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=[{value:j,name:"All"},{value:k,name:"ToDo"},{value:m,name:"Doing"},{value:b,name:"Done"},{value:v,name:"Not Done"}];!0===this.props.mini&&(t=[{value:j,name:"All"},{value:v,name:"Not Done"}]);var a=!1,n=u.HUtils.runFuntion(this.props.fnList,"getOptions",[]);return n&&n.ProjectList&&n.ProjectList.length>0&&(a=!0),console.log("_showFilterProject project:",n),Object(g.jsxs)(O,{children:[t.map((function(t,a){return Object(g.jsx)("div",{className:h()({"a-active":e._getTypeFilter()==t.value}),onClick:function(){e._clickFilter(t.value)},children:t.name},a)})),!0===a&&Object(g.jsx)(f.i,{overlay:function(t){var a;return Object(g.jsx)(f.h,{type:"select_box_search_v2",sourceData:null===n||void 0===n?void 0:n.ProjectList,valueSelected:null===(a=e.state.filters)||void 0===a?void 0:a.ProjectId,onChange:function(a){console.warn("onChange:",a,a.Value);var n=e.state.filters||{};n.ProjectId=a.Value,n.ProjectId_Text=a.Text,e.setState({filters:n},(function(){t.hide&&t.hide(),e.requestTasks()}))}})},overlayClassName:"m-popover",placement:"bottom",destroyTooltipOnHide:!0,children:Object(g.jsx)("div",{className:h()("a-pick-project",{"a-active":null!=this.state.filters.ProjectId}),children:this.state.filters&&this.state.filters.ProjectId?"".concat(this.state.filters.ProjectId_Text):"Ch\u1ecdn Project"})})]})}}]),a}(c.Component),O=d.b.div(n||(n=Object(s.a)(["\n  display: flex;\n  & > div {\n    background: white;\n    padding: 0 8px;\n    font-size: 12px;\n    border: 1px solid #9f9f9f;\n    border-radius: 10px;\n    height: 20px;\n    margin-right: 2px;\n    cursor: pointer;\n    color: #9f9f9f;\n    &.a-active {\n      background: #2fa4e7;\n      color: white;\n      border: 1px solid #0673b1;\n    }\n  }\n"])));t.a=x},659:function(e,t,a){"use strict";var n,s=a(22),i=a(16),o=a(17),r=a(18),l=a(19),c=a(0),d=a(20),u=(a(1),a(57)),f=a.n(u),p=a(2),h=function(e){Object(r.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).onChangePage=function(e){var t=n.props.onChangePage;t&&t(e)},n.state={},n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.props,a=t.page,n=t.total,s=t.pageSize;if(0==n||s<=0)return Object(p.jsx)("div",{});var i=parseInt(n/s);return n%s>0&&(i+=1),i<2?Object(p.jsx)("div",{}):Object(p.jsx)(g,{children:Object(p.jsx)("nav",{children:Object(p.jsxs)("ul",{className:"pagination justify-content-center",children:[Object(p.jsx)("li",{className:f()("page-item",{disabled:a<2}),children:Object(p.jsx)("a",{className:"page-link",href:"#",onClick:function(t){t.preventDefault(),e.onChangePage(a-1)},children:Object(p.jsx)("i",{className:"fa fa-chevron-left"})})}),new Array(i).fill(1).map((function(t,n){return Object(p.jsx)("li",{className:f()("page-item",{active:a==n+1}),children:Object(p.jsx)("a",{className:"page-link",href:"#",onClick:function(t){t.preventDefault(),e.onChangePage(n+1)},children:n+1})},n)})),Object(p.jsx)("li",{className:f()("page-item",{disabled:a>=i}),children:Object(p.jsx)("a",{className:"page-link",href:"#",onClick:function(t){t.preventDefault(),e.onChangePage(a+1)},children:Object(p.jsx)("i",{className:"fa fa-chevron-right"})})})]})})})}}]),a}(c.Component),g=d.b.div(n||(n=Object(s.a)([""])));t.a=h},661:function(e,t,a){"use strict";var n=a(8),s=a(15),i=a(0),o=a.n(i),r=a(5),l=a.n(r),c=a(23),d=a.n(c),u=a(7),f=["className","cssModule","type","size","color","children","tag"],p={tag:u.q,type:l.a.string,size:l.a.string,color:l.a.string,className:l.a.string,cssModule:l.a.object,children:l.a.string},h=function(e){var t=e.className,a=e.cssModule,i=e.type,r=e.size,l=e.color,c=e.children,p=e.tag,h=Object(s.a)(e,f),g=Object(u.m)(d()(t,!!r&&"spinner-"+i+"-"+r,"spinner-"+i,!!l&&"text-"+l),a);return o.a.createElement(p,Object(n.a)({role:"status"},h,{className:g}),c&&o.a.createElement("span",{className:Object(u.m)("sr-only",a)},c))};h.propTypes=p,h.defaultProps={tag:"div",type:"border",children:"Loading..."},t.a=h}}]);
//# sourceMappingURL=34.504620ff.chunk.js.map