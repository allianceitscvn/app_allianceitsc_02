{"version":3,"sources":["modules/qlproject/MyPage/prj_releases.js"],"names":["MP_PRJ_Release","props","getProjectInfo","HUtils","runFuntion","fnList","requestListRelease","e","p","_key","row","console","log","Value","_data","HJson","getObj","_arrKeys","map","v","i","join","rr","_vrr","Id","Key","setState","data","state","currentE","currentP","_enviroments","this","enviroments","_platforms","platforms","length","WrapEmpty","className","_tabPlatforms","title","key","getContent","a","type","renderItem","item","style","fontWeight","HFormat","format","release_date","version","paddingBottom","changelog","config","fTitle","fContent","fDate","_tabEnviroments","tabsWrapperClass","transform","showInkBar","selectedTabKey","items","onChange","k","warn","WrapLayout","Component","styled","div"],"mappings":"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","file":"static/js/235.d0fbe793.chunk.js","sourcesContent":["import { Component } from \"react\"\r\nimport styled from \"styled-components\"\r\nimport { ApiGeneric } from \"src/services/apiServices\"\r\nimport Tabs from \"react-responsive-tabs\"\r\nimport { HFormat, HJson, HUtils, MyPage, MyUI } from \"@macashipo/mlib\"\r\n\r\nclass MP_PRJ_Release extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      data: null,\r\n      currentE: null,\r\n      currentP: null,\r\n    }\r\n  }\r\n  componentDidMount() {}\r\n  getProjectInfo = () => {\r\n    return (\r\n      HUtils.runFuntion(this.props.fnList, \"getCurrentProjectInfo\", []) || {}\r\n    )\r\n  }\r\n  requestListRelease = (e, p) => {\r\n    if (e && p) {\r\n      let _key = `${e}_${p}_releases`\r\n      HUtils.runFuntion(this.props.fnList, \"getCurrentProjectExtra\", [\r\n        _key,\r\n        row => {\r\n          console.log(\"cb1:\", row)\r\n          if (row && row.Value) {\r\n            let _data = HJson.getObj(row.Value)\r\n            console.log(\"_data:\", _data)\r\n            let _arrKeys = _data.map((v, i) => {\r\n              return `${e}_${p}_release_${v}`\r\n            })\r\n            HUtils.runFuntion(this.props.fnList, \"getCurrentProjectExtra\", [\r\n              _arrKeys.join(\",\"),\r\n              rr => {\r\n                console.log(\"cb2:\", rr)\r\n                if (rr) {\r\n                  let _vrr = rr.map((v, i) => {\r\n                    if (v.Value) {\r\n                      return {\r\n                        Id: v.Key,\r\n                        ...HJson.getObj(v.Value),\r\n                      }\r\n                    }\r\n                    return {}\r\n                  })\r\n                  this.setState(\r\n                    {\r\n                      data: _vrr,\r\n                    },\r\n                    () => {}\r\n                  )\r\n                }\r\n              },\r\n              () => {},\r\n              true,\r\n            ])\r\n          } else {\r\n            this.setState({\r\n              data: [],\r\n            })\r\n          }\r\n        },\r\n      ])\r\n    }\r\n  }\r\n  render() {\r\n    let _enviroments = this.getProjectInfo().enviroments || []\r\n    let _platforms = this.getProjectInfo().platforms || []\r\n    console.log(\"_enviroments\", _enviroments, _platforms)\r\n    if (\r\n      _enviroments == null ||\r\n      _platforms == null ||\r\n      _enviroments.length == 0 ||\r\n      _platforms.length == 0\r\n    ) {\r\n      return (\r\n        <WrapEmpty>\r\n          <div className=\"a-title\">Missing Enviroments or Platforms</div>\r\n          <div className=\"a-msg\">\r\n            Please add enviroments and platforms in Config Project\r\n          </div>\r\n        </WrapEmpty>\r\n      )\r\n    }\r\n    let _tabPlatforms = _platforms.map((v, i) => {\r\n      return {\r\n        title: v,\r\n        key: v,\r\n        getContent: a => {\r\n          console.log(\"render contentp:\", this.state.data)\r\n          if (this.state.data) {\r\n            if (this.state.data.length > 0) {\r\n              return (\r\n                <div className=\"a-timeline\">\r\n                  <div className=\"a-title\">Change logs</div>\r\n                  <MyUI\r\n                    type=\"timeline\"\r\n                    data={this.state.data}\r\n                    renderItem={(item, i) => {\r\n                      return (\r\n                        <li key={i}>\r\n                          <div style={{ fontWeight: \"bold\" }}>\r\n                            {HFormat.format(item.release_date, {\r\n                              type: \"date\",\r\n                              format: \"DD-MM-YYYY HH:mm\",\r\n                            })}\r\n                            {`  â€¢  `}Version: {item.version}\r\n                          </div>\r\n                          <div style={{ paddingBottom: \"1rem\" }}>\r\n                            {item.changelog}\r\n                          </div>\r\n                        </li>\r\n                      )\r\n                    }}\r\n                    config={{\r\n                      fTitle: \"version\",\r\n                      fContent: \"changelog\",\r\n                      fDate: \"release_date\",\r\n                    }}\r\n                  />\r\n                  {/* {this.state.data.map((v, i) => {\r\n                    return (\r\n                      <div>\r\n                        <div>Version: {v.version}</div>\r\n                        <div>Changelog: {v.changelog}</div>\r\n                      </div>\r\n                    )\r\n                  })} */}\r\n                </div>\r\n              )\r\n            }\r\n          }\r\n          return <div className=\"a-noinfo\">No info release</div>\r\n        },\r\n      }\r\n    })\r\n    let _tabEnviroments = _enviroments.map((v, i) => {\r\n      return {\r\n        title: v,\r\n        key: v,\r\n        getContent: a => {\r\n          console.log(\"render content:\", a)\r\n          return (\r\n            <div>\r\n              <Tabs\r\n                tabsWrapperClass=\"body-tabs body-tabs-layout no-print\"\r\n                transform={false}\r\n                showInkBar={true}\r\n                selectedTabKey={this.state.currentP}\r\n                items={_tabPlatforms}\r\n                onChange={k => {\r\n                  console.warn(\"onChange:\", k)\r\n                  this.setState(\r\n                    {\r\n                      currentP: k,\r\n                    },\r\n                    () => {\r\n                      this.requestListRelease(\r\n                        this.state.currentE,\r\n                        this.state.currentP\r\n                      )\r\n                    }\r\n                  )\r\n                }}\r\n              />\r\n            </div>\r\n          )\r\n        },\r\n      }\r\n    })\r\n    return (\r\n      <WrapLayout>\r\n        {_tabEnviroments && _tabEnviroments.length > 0 && (\r\n          <Tabs\r\n            tabsWrapperClass=\"body-tabs body-tabs-layout no-print\"\r\n            transform={false}\r\n            showInkBar={true}\r\n            selectedTabKey={this.state.currentE}\r\n            items={_tabEnviroments}\r\n            onChange={k => {\r\n              console.warn(\"onChange:\", k)\r\n              this.setState(\r\n                {\r\n                  currentE: k,\r\n                },\r\n                () => {\r\n                  this.requestListRelease(\r\n                    this.state.currentE,\r\n                    this.state.currentP\r\n                  )\r\n                }\r\n              )\r\n            }}\r\n          />\r\n        )}\r\n      </WrapLayout>\r\n    )\r\n  }\r\n}\r\n\r\nconst WrapLayout = styled.div`\r\n  height: 100%;\r\n  & .body-tabs > .RRT__tab {\r\n    padding: 5px 10px;\r\n  }\r\n  & .RRT__panel {\r\n    margin-top: 0px;\r\n  }\r\n  & > .RRT__container {\r\n    height: 100%;\r\n    & > .RRT__panel {\r\n      position: absolute;\r\n      left: 0;\r\n      right: 0;\r\n      top: 32px;\r\n      bottom: 0;\r\n      & > div {\r\n        height: 100%;\r\n        & > .RRT__container {\r\n          height: 100%;\r\n          & > .RRT__panel {\r\n            position: absolute;\r\n            left: 0;\r\n            right: 0;\r\n            top: 32px;\r\n            bottom: 0;\r\n            //\r\n            background: linear-gradient(45deg, #209cff, #68e0cf);\r\n            & > div.a-timeline {\r\n              padding: 1rem;\r\n              overflow: auto;\r\n              background: #eaf6ff;\r\n              padding: 2rem;\r\n              padding-top: 1rem;\r\n              height: calc(100% - 2rem);\r\n              margin: 1rem;\r\n              margin-bottom: -1rem;\r\n              border-radius: 15px;\r\n              & > .a-title {\r\n                margin-bottom: 1rem;\r\n                font-weight: bold;\r\n                font-size: 16px;\r\n              }\r\n              & > ul {\r\n              }\r\n            }\r\n            & > div.a-noinfo {\r\n              height: calc(100% - 2rem);\r\n              overflow: auto;\r\n              background: #eaf6ff;\r\n              border-radius: 15px;\r\n              margin: 1rem;\r\n              margin-bottom: -1rem;\r\n              display: flex;\r\n              align-items: center;\r\n              justify-content: center;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n`\r\n\r\nconst WrapEmpty = styled.div`\r\n  min-height: 100px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  & > .a-title {\r\n    font-weight: bold;\r\n  }\r\n`\r\n\r\nexport default MP_PRJ_Release\r\n"],"sourceRoot":""}