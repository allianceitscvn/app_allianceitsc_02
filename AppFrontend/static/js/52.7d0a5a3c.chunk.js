(this["webpackJsonpapp-admin-v5"]=this["webpackJsonpapp-admin-v5"]||[]).push([[52,220],{1229:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return F}));var o,r,a=t(32),l=t(31),i=t(4),c=t(22),s=t(1),u=t(0),f=t(11),d=t(511),p=t(20),b=t(510),m=t(156),g=t(573),h=t(9),v=t(79),j=t(6),O=t(157),w=t(2),y=p.b.div(o||(o=Object(c.a)(["\n  cursor: pointer;\n  padding: 2px;\n  & > div {\n    height: 100%;\n  }\n  & .no-items {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    min-height: 36px;\n  }\n"]))),C=p.b.div(r||(r=Object(c.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-height: 36px;\n  font-style: italic;\n  color: #adadad;\n"])));function x(e){var n=e.ctc,t=e.valueSelected,o=e.optionsSelected,r=e.configFormAddNew,c=Object(m.a)(),f=Object(u.useRef)({}).current,p=h.k.fnGetSourceData(n.fnList),b=n.moreObj.fIDOption||"Id";return Object(w.jsxs)("div",{style:{minWidth:"200px",maxWidth:"500px"},children:[(null==p||void 0==p||p&&0===p.length)&&Object(w.jsx)(C,{className:"no-items",children:"No item option"}),p&&p.length>0&&Object(w.jsx)(s.MyUI,{type:"selectcheck_box_search",multi:!0,hasRightPanel:!0,configFormAddNew:r,currentListLoadingByValue:f,onSubmitAddNew:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=t.cbSuccess;if(n.moreObj.configApiAddNew){var r=n.oneTableCell.getConfigApi({customMore:n.moreObj.configApiAddNew});null==r.query&&(r.query={}),r.query&&(r.query=Object.assign(r.query,e)),console.warn("onSubmitAddNew:",e,r),Object(d.a)(r).then((function(e){console.warn("configApiAddNew rs",e),Object(v.FlowParseResponseAndNeedReload)(Object(i.a)(Object(i.a)({},n),{},{oneTableCell:n.oneTableCell,response:e,configApi:r})),e.Data&&e.Data.Id===n.row.Id&&(n.onUpdateRow(e.Data),n.updateValueCellFromRow(),c()),o&&o(e)}))}else console.warn("Missing configApiAddNew")},sourceData:p,optionsSelected:o,valueSelected:t,onChange:function(e){var o,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.fnList;console.log("onChange:",e,e.Value,t);var c=[],u=!0,d=!1;if(s.HIs.isArray(e)?(c=e).length>0?u=!0:(d=!0,f._all=!0,u=!1,c=t):(c=[e.Value],u=!(t.indexOf(e.Value)>-1)),c){var p,m=Object(l.a)(c);try{for(m.s();!(p=m.n()).done;){var g=p.value;f[g]=!0}}catch(h){m.e(h)}finally{m.f()}}s.HUtils.runFuntion(i,"fnForceUpdate"),n.requestCustom({requestData:(o={},Object(a.a)(o,n.moreObj.fID,n.row.Id),Object(a.a)(o,n.moreObj.fList,c),o),apiPath:n.moreObj.apiPath,apiName:u?n.moreObj.apiNameAdd:n.moreObj.apiNameRemove,cbSuccess:function(t){if(console.warn("cbSuccess:",t),c){var o,r=Object(l.a)(c);try{for(r.s();!(o=r.n()).done;){var a=o.value;delete f[a]}}catch(h){r.e(h)}finally{r.f()}}if(delete f._all,t.Data)n.onUpdateRow(t.Data),n.updateValueCellFromRow({cbWhenEqual:function(){n.forceUpdate()}});else if(!1===u){console.log("update row when remove");var p=n.row[n.fieldName];if(p&&p.length>0){var m=-1;if(d)n.row[n.fieldName]=[];else{for(var g=0;g<p.length;g++)if(p[g][b]==e.Value){m=g;break}m>-1&&p.splice(m,1)}n.updateValueCellFromRow({cbWhenEqual:function(){n.forceUpdate()}})}}s.HUtils.runFuntion(i,"fnForceUpdate")},cbError:function(e){if(c){var n,t=Object(l.a)(c);try{for(t.s();!(n=t.n()).done;){var o=n.value;delete f[o]}}catch(h){t.e(h)}finally{t.f()}}delete f._all,s.HUtils.runFuntion(i,"fnForceUpdate")}})}})]})}function F(e){var n=Object(b.a)({props:e}),t=h.k.fnGetSourceData(n.fnList),o=[];n.valueCell&&s.HIs.isArray(n.valueCell)&&(o=n.valueCell);var r=n.moreObj.fIDOption||"Id",l=n.moreObj.fName,c=o.map((function(e,n){return r?e[r]:e.Id||""})),u=o.map((function(e,n){var o=e[r]||e.Id;return l?Object(a.a)({Value:o,Text:e[l]||o||""},j.o._UI_Missing,!Object(O.d)(t,o)):{Value:o,Text:o}})),d=n.oneTableCell.getConfigForm(),p=s.MyFormControlHelpers.getConfigFormFromConfigV1(d,{defaultValues:n.row}),m=Object(i.a)({placement:"bottom",autoScrollIntoViewWhenOutOfScreen:!0},Object(v.FlowGetConfigOfMore)(Object(i.a)(Object(i.a)({},n),{},{key:v.KMore.configPopover,defaultValue:{}})));return Object(w.jsx)(y,{className:n.classNameWrap("mct-array_editable_modal"),children:Object(w.jsx)(f.i,{disabled:!n.canEdit,autoScrollIntoViewWhenOutOfScreen:m.autoScrollIntoViewWhenOutOfScreen,overlay:function(e){return Object(w.jsx)(x,Object(i.a)({ctc:n,optionsSelected:u,valueSelected:c,configFormAddNew:p},e))},overlayClassName:"m-popover m-popover-full",placement:m.placement,destroyTooltipOnHide:!0,children:Object(w.jsx)("div",{children:Object(w.jsx)(g.default,{options:u})})})})}},510:function(e,n,t){"use strict";var o=t(32),r=t(13),a=t(31),l=t(4),i=t(1),c=t(57),s=t.n(c),u=t(0),f=t.n(u),d=t(11),p=t(9),b=t(511),m=t(155),g=t(157),h=t(79),v=t(2),j="fnGetScreenCode",O=function(e){var n=e.oneTableCell,t=Object(l.a)({},n.fnList);return t[p.O]=function(){var e=n.row,o=n.extra,r=n.extra.Type.source,a=p.j.getSourceList(t);if(g.e(r))return g.b(a,r,e,o.Type.sourceField);if(r&&r.startsWith("["))return i.HJson.getObj(r);if(r&&r.startsWith("f")){var l=r.slice(1,r.length);return null!=e[l]&&Array.isArray(e[l])?e[l]:null!=e[r]&&Array.isArray(e[r])?e[r]:[]}return a[r]||[]},t[p.T]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.customMore,o=e.count,r=e.tooltip,a=n.row,l=n.more;return y.renderBadge({more:t||l,row:a,count:o,tooltip:r})},t[p.H]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.customTitle;return m.a.Cell_GetHeaderTitle({extra:n.extra,customTitle:t})},t[p.u]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,o=n.more,r=t;return o&&o.hasOwnProperty(e)&&(r=o[e]),r},t[p.v]=function(){var e=n.row,t=n.extra,o=n.more;return m.a.Cell_GetConfigModal({extra:t,more:o,row:e})},t[p.I]=function(){var e=n.row,t=n.extra,o=n.more,r=n.getValue();if(!1===Object(h.FlowGetCanShow)({extra:t,row:e,more:o}))return!0;return!(!o[h.KMore.hideWhenEmpty]||""!==r&&null!=r&&0!==r)||(!(!o[h.KMore.hideWhenNull]||null!=r)||!!(i.MyTableCellHelpers.ConfigByTypes&&i.MyTableCellHelpers.ConfigByTypes[n.type]&&i.MyTableCellHelpers.ConfigByTypes[n.type].isHide&&i.MyTableCellHelpers.ConfigByTypes[n.type].isHide(n)))},t.onSendMsg=function(e){console.error("missing onSendMsg, need update fnList",e)},t.onReExpand=function(){var e=n.row;i.HUtils.runFuntion(e,"_fnForceUpdateDetail")},n.fnList=t,t},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return i.HUtils.runFuntion(e.fnList,j,n)},y={renderBadge:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.more,t=void 0===n?{}:n,o=e.row,r=void 0===o?{}:o,a=e.count,l=e.tooltip,c=t.configBadge||t.badge;if(null!=a||c&&!0===c.show){var s=a,u=l;if(c&&c.fCount&&null!=r[c.fCount]&&(s=r[c.fCount]),s)return c&&c.fTooltip&&r[c.fTooltip]&&(u=r[c.fTooltip]),u?Object(v.jsx)(d.k,{overlay:Object(v.jsx)(i.MyUI,{type:"html",html:u}),children:Object(v.jsx)("span",{className:"mct-ui-badge",children:s})}):Object(v.jsx)("span",{className:"mct-ui-badge",children:s})}}},C=t(156),x="fnRequestUpdate",F="fnRequestCustom";function M(e){var n=e.ctc,t=e.more,o=n.row.Id,r=w(n),a={};t&&(t.fID&&n.row[t.fID]&&(o=n.row[t.fID]),a=t.configFile||t.file||{});var c=Object(l.a)({needRequestPhotos:!0,pasteAsFile:!0,showUploadFromGGDrive:!1},a),s={ScreenCode:r,ProjectId:"",Id:o,FieldName:n.fieldName};return Object(v.jsx)("div",{children:Object(v.jsx)(i.MyUI,{type:"file_manager",requestData:s,fnList:e.fnList,configFile:c,canUpload:e.canUpload})})}var S=function(e){e.fieldName;var n=e.extra,t=e.row,o=n||{},r=e.more,l=!1;if("boolean"===typeof o.CanEdit&&(l=o.CanEdit),1==l)if(null==r.fCanEdit&&null!=r.canEditF&&(r.fCanEdit=r.canEditF),"boolean"===typeof r.fCanEdit)l=r.fCanEdit;else if("string"===typeof r.fCanEdit&&r.fCanEdit.length>0)if(null!=t[r.fCanEdit])l=t[r.fCanEdit];else if(r.fCanEdit.indexOf(",")>-1){var i=r.fCanEdit.split(",");if(i&&i.length>0){var c,s=Object(a.a)(i);try{for(s.s();!(c=s.n()).done;){if(0==t[c.value]){l=!1;break}}}catch(b){s.e(b)}finally{s.f()}}}if(null!=r.lockF||null!=r.fLock){var u=r.lockF||r.fLock;if("boolean"==typeof u)l=!u;else if("string"==typeof u&&u.length>0)if(null!=t[u])l=!t[u];else if(u.indexOf(",")>-1){var f=u.split(",");if(f&&f.length>0){var d,p=Object(a.a)(f);try{for(p.s();!(d=p.n()).done;){if(1==t[d.value]){l=!1;break}}}catch(b){p.e(b)}finally{p.f()}}}}return l};n.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.props;0;var t=Object(u.useState)(0),a=Object(r.a)(t,2),c=(a[0],a[1],Object(u.useState)(null===n.cell||void 0===n.cell?"":n.cell)),g=Object(r.a)(c,2),j=g[0],w=g[1],y=n.cell,T=n.extra,A=T.fieldName,N=Object(u.useState)(!1),U=Object(r.a)(N,2),E=U[0],I=U[1],k=Object(u.useState)(!1),R=Object(r.a)(k,2),D=R[0],H=R[1],L=f.a.useRef(new i.OneTableCell(n)),P=L.current;P.row=n.row,P.extra=T,n.custom&&!0!==P._updateCustom&&(P.more=Object(l.a)(Object(l.a)({},n.custom.more),P.more),P._updateCustom=!0);var V=P.row,q=f.a.useRef(O({oneTableCell:P,row:V,extra:T,cell:y})),_=q.current;null==P._onePage&&P.updateOnePage(p.j.fnGetOnePage(_));var B=P.more,W=Object(C.a)(),G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.cbWhenEqual,t=V[A];console.log("updateValueCellFromRow:",t),j!=t?w(null===t||void 0===t?"":t):(console.log("call cbWhenEqual"),n&&n())};return!0===V.IsLocked?P.canEdit=!1:null!=P.canEdit&&!0!==P.canEdit&&!1!==P.canEdit||(P.canEdit=S({extra:P.extra,more:B,row:V})),f.a.useEffect((function(){"string"===typeof n.cell||"number"===typeof n.cell||"boolean"===typeof n.cell?n.cell!=j&&w(n.cell):w(n.cell)}),[n.cell]),{forceUpdate:W,fnList:_,updateValueCellFromRow:G,oneTableCell:P,extra:P.extra,row:P.row,fieldName:P.fieldName,more:P.more,moreObj:P.more,canEdit:P.canEdit,updateFieldData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.warn("updateFieldData:",e,P),e==y||null==y&&""==e?(console.warn("not update:",e,y,t),t&&t.cbError&&t.cbError({msg:"Nothing to change"})):(I(!0),i.HUtils.runFuntion(P.fnList,x,[Object(l.a)(Object(l.a)({},t),{},{apiController:p.j.fnGetApiPath(_),fieldName:t.fieldName||P.fieldName,row:P.row,newValue:e,cbSuccess:function(e){console.warn("cbss",e),I(!1),p.j.fnForceUpdateTable(_,[]),t&&t.cbSuccess&&t.cbSuccess(e),n.fnList&&n.fnList.cbSuccessUpdate&&n.fnList.cbSuccessUpdate()},cbError:function(n){console.warn("cber",n),I(!1),t&&t.cbError&&t.cbError(e)}})]))},requestCustom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("requestCustom:",e),i.HUtils.runFuntion(P.fnList,F,[Object(l.a)({},e)])},getSharedConfig:function(){return{}},getMoreAttrsFromCustomConfig:function(){return i.MyTableCellHelpers.ConfigByTypes&&i.MyTableCellHelpers.ConfigByTypes[P.type]&&i.MyTableCellHelpers.ConfigByTypes[P.type].moreAttrs?i.MyTableCellHelpers.ConfigByTypes[P.type].moreAttrs:{}},getMorePropsButton:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.defaultStyle,t={},o=n||{};return D&&(t.disabled=!0),B&&B.button&&B.button.style&&(o=Object(l.a)(Object(l.a)({},o),B.button.style)),o&&Object.keys(o).length>0&&(t.style=o),t},renderHide:function(){return Object(v.jsx)("div",{className:"disabled"})},isUpdating:E,setIsUpdating:function(e){I(e)},isFetching:D,setIsFetching:H,valueCell:j,setValueCell:w,classNameWrap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s()(e,Object(l.a)({disabled:!1===P.canEdit,"a-scrwhhover":null!=B.scrwhhover?B.scrwhhover:t.scrwhhover||!1,"styled-mini":B.styledMini},null!=n.custom&&null!=n.custom.className?Object(o.a)({},n.custom.className,!0):{}))},styleWrap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return m.a.Cell_GetStyleCell({extra:T,more:B,row:V,defaultStyle:e,overideStyle:n})},onUpdateRow:function(e){i.HUtils.runFuntion(P.fnList,"onUpdateRow",[{row:V,newRow:e}])},getTextDisplaySelect:function(){var e="";if(B.fDisplay&&V[B.fDisplay]?e=V[B.fDisplay]:B.fShow&&V[B.fShow]&&(e=V[B.fShow]),""==e&&null!=j&&""!==j){var n=_.fnGetSourceData(),t=i.HOptions.getTextDisplayOfValueFromOptions(n,j);t&&(e=t)}return""==e&&(e=j||""),e},renderTopRight:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(v.jsx)(i.MyTableCell,Object(l.a)(Object(l.a)({},n),{},{fnList:_,more:B,oneTableCell:P,type:"_barTopRight",moreBtns:e,moreConfig:t}))},renderLoadingOverlay:function(){return Object(v.jsx)("div",{className:"a-overlay-center",children:Object(v.jsx)(i.MyLoading,{type:"threedotsvertical",size:12})})},onClickForm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.customMore,t=e.cbSuccess,o=e.customShowForm,r=n||B;console.warn("onClickForm:",r),H(!0),Object(h.FlowCheckApiShowModal)({extra:T,row:V,more:B,fnList:_,cb:function(e){var n=e.canShow;e.config;if(n){var a=P.getConfigForm({customMore:r}),c=V;if(r.fDefaultValues&&(c=V[r.fDefaultValues]?V[r.fDefaultValues]:{}),a){var s=i.MyFormControlHelpers.getConfigFormFromConfigV1(a,{defaultValues:c,fnList:Object(l.a)(Object(l.a)({},_),{},{onSubmitForm:function(e,n){var o=n.myForm;console.warn("onSubmitForm:",e);var a=P.getConfigApi({customMore:r});return new Promise((function(n,r){a?(a.query=Object.assign(a.query,e),Object(b.a)(a).then((function(e){console.warn("onClickBtn API rs",e),Object(h.FlowParseResponseAndNeedReload)({extra:T,row:V,fieldName:A,more:B,oneTableCell:P,response:e}),o.closeMyModal&&o.closeMyModal(),t&&t(e),n(e)})).catch((function(e){r(e)}))):(console.warn("Missing configApi"),r("Missing configApi"))}))}})}),u=P.getConfigModal({customMore:r});o?o(s,Object(l.a)({},u)):d.f.showFromMyForm(s,Object(l.a)({},u))}else console.error("Missing configForm:",a)}H(!1)}})},onClickApi:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.customMore,t=(e.cbSuccess,e.cbError),o=e.cbBeforeRequest,r=e.cbAfterRequest,a=n||B;console.warn("onClickApi:",a);var l=P.getConfigApi({customMore:a});a.confirmMsg?d.f.showConfirm({title:a.titleConfirm||"Confirm",msg:a.confirmMsg,onClickOK:function(e){l?(o&&o(),Object(b.a)(l).then((function(e){console.warn("onClickBtn API rs",e),Object(h.FlowParseResponseAndNeedReload)({extra:T,row:V,fieldName:A,more:a,oneTableCell:P,response:e})})).finally((function(){r&&r()}))):console.warn("Missing configApi"),e&&e.hide&&e.hide()}}):l?(o&&o(),Object(b.a)(l).then((function(e){console.warn("onClickBtn API rs",e),Object(h.FlowParseResponseAndNeedReload)({extra:T,row:V,fieldName:A,more:a,oneTableCell:P,response:e})})).finally((function(){r&&r()}))):(console.warn("Missing configApi"),t&&t())},onClickFiles:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.ctc,t=e.customMore,o=e.canUpload,r=t||B;console.warn("onClickFiles:",r),d.f.showFromComponent((function(e){return Object(v.jsx)(M,Object(l.a)(Object(l.a)({},e),{},{more:r,canUpload:o,ctc:n}))}),{title:"Modal",backdrop:"static",size:"xl",showHeader:!1,fnList:{updateCell:function(e,n){console.warn("Updatecell:",e,n)},fnGetApiPath:function(){return p.j.fnGetApiPath(_)},onChangeData:function(e){console.warn("onChangeData:",e,y),e&&y?e.Id===y.Id||y.hasOwnProperty&&e.hasOwnProperty&&y.hasOwnProperty("Photos")&&e.hasOwnProperty("Photos")?(i.HUtils.mergeObjIfExist(V[A],e),i.HUtils.runFuntion(P.fnList,"onUpdateRow",[{row:V,newRow:V}]),W()):console.warn("Update data row, wrong ID",e,y):console.warn("Update data row, wrong data",e,y)}}})}}}},511:function(e,n,t){"use strict";var o=t(52);n.a=o.apiWithConfigApi},573:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return s}));var o,r=t(22),a=(t(0),t(6)),l=t(20),i=t(2),c=l.b.div(o||(o=Object(r.a)(["\n  display: inline-block;\n  & > span {\n    padding: 0px 2px;\n    margin-bottom: 2px;\n    background: red;\n    display: inline-block;\n    margin-right: 2px;\n    border: 1px solid rgba(0, 126, 255, 0.08);\n    border-radius: 3px;\n    background-color: rgba(0, 126, 255, 0.08);\n    color: #007eff;\n    &.a-missing {\n      color: #c7c7c7;\n      background-color: #c7c7c722;\n      border-color: #c7c7c755;\n    }\n  }\n"])));function s(e){var n=e.values,t=e.options;return Object(i.jsxs)(c,{className:"mui-arr_tags",children:[t&&t.length>0&&t.map((function(e,n){return Object(i.jsx)("span",{title:e.Text,className:"".concat(!0===e[a.o._UI_Missing]?"a-missing":""),children:e.Text},n)})),n&&n.length>0&&n.map((function(e,n){return Object(i.jsx)("span",{title:e,children:e},n)}))]})}}}]);
//# sourceMappingURL=52.7d0a5a3c.chunk.js.map