(this["webpackJsonpapp-admin-v5"]=this["webpackJsonpapp-admin-v5"]||[]).push([[46],{1244:function(e,t,n){"use strict";n.r(t),n.d(t,"JsonContainer",(function(){return x})),n.d(t,"JsonContainerMini",(function(){return F})),n.d(t,"default",(function(){return E}));var o,a,r,l=n(4),i=n(32),c=n(13),s=n(61),f=n(22),d=n(1),u=n(0),p=n.n(u),b=n(633),g=n.n(b),m=n(183),v=n.n(m),h=n(28),j=(n(35),n(20)),y=n(510),w=(n(563),n(172)),C=n(9),O=n(2),x=j.b.div(o||(o=Object(f.a)(["\n  // max-height: 120px;\n  overflow: overlay;\n"]))),F=j.b.div(a||(a=Object(f.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  color: green;\n  font-weight: bold;\n  padding: 5px;\n"]))),T=j.b.div(r||(r=Object(f.a)(["\n  overflow: hidden;\n  max-height: calc(100vh - 6rem);\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  & .a-mode-text textarea {\n    // border: 1px solid rgb(233, 236, 239);\n    // border-radius: 4px;\n    width: 100%;\n    min-height: 50vh;\n    outline: none;\n  }\n  & .mp-admin_table .mpat-header {\n    padding: 0px;\n    margin: 0px;\n    margin-bottom: 5px;\n  }\n  & .mp-admin_table .mpat-table {\n    margin-bottom: 0px !important;\n    & > .card-body {\n      padding: 0px;\n    }\n    & .react-bs-table-pagination {\n      display: none;\n    }\n  }\n"]))),M=function e(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n.prefixKey,a=n.levelConfig,r=Object.keys(t),l=[],i=0;i<r.length;i++){var c=r[i],f=t[c],d=typeof f;"object"==d&&(null==f&&(d="null"),Array.isArray(f)&&(d="array"));var u="".concat(null!=o?o+".":"").concat(c),p=5,b=[];if(a&&a.length>0){b=Object(s.a)(a);for(var g=0;g<b.length;g++)2==b[g]||3==b[g]?b[g]=3:b[g]=0}"object"==d?(p=1,i==r.length-1&&(p=2)):p=i==r.length-1?2:1;var m=[].concat(Object(s.a)(b),[p]);if(l.push({Id:u,Key:c,Type:d,Value:f,TreeLevel:u.split(".").length-1,LastOfLevel:i==r.length-1,HasChild:"object"==d,LevelConfigs:m,UI_MergeRowByField:"object"==d?"Key":null,UI_CellType_Value:"boolean"==d?"checkbox":"textarea",UI_StyleRow:{display:"flex",alignItems:"center",textAlign:"left",justifyContent:"flex-start",paddingLeft:"5px",fontWeight:"object"==d?"bold":"normal"}}),"object"==d){var v=e(f,{prefixKey:u,levelConfig:m});v&&v.length>0&&(l=l.concat(v))}}return l},S=function(e){var t,n=e.ctc,o=e.obj,a=(e.config,e.fnList),r=e.configFromModal,l=p.a.useState(o),s=Object(c.a)(l,2),f=s[0],u=(s[1],p.a.useState(M(f))),b=Object(c.a)(u,2),g=b[0],m=b[1],j=p.a.useState(!1),y=Object(c.a)(j,2),x=y[0],F=y[1],S=n.canEdit;return p.a.useEffect((function(){}),[]),console.warn("render ModalEditor:",e),Object(O.jsxs)(T,{children:[h.a.renderHeader({cModal:e.inMyModal,styleModalHeader:{marginBottom:"0.5rem"},title:function(e){return Object(O.jsx)(O.Fragment,{children:r.title})}}),Object(O.jsx)("div",{style:{flex:1,overflow:"auto",minHeight:"100px"},children:Object(O.jsx)(d.MyPage,{configPage:{UIUrl:"",ScreenCode:"PageNotFound",Title:"",APIName:"",UIType:"admin_table_client",Config:null,RequestData:"",Id:""},fnList:(t={},Object(i.a)(t,C.J,(function(){return!0})),Object(i.a)(t,"fnCustomUpdateField",(function(e){e.apiController;var t=e.cbSuccess,n=(e.cbError,e.requestData,e.row),o=e.newValue,r=e.fieldName;if(console.warn("Update field",n,o,r),n.Id){v()(f,n.Id,o),n.Value=o,m(M(f)),t&&t(),console.warn("v",f);F(!0),d.HUtils.runFuntion(a,"updateCell",[d.HJson.getString(f),{cbSuccess:function(e){console.warn("cbSuccess:",e),F(!1)},cbError:function(e){console.warn("cbErrro:",e),F(!1)}}])}})),Object(i.a)(t,"getClientOptions",(function(){return Object(w.a)({configHeader:{sticky:!0},configTable:{canDelete:!1,optionsTable:{sizePerPage:1e4,hideSizePerPage:!0,paginationShowsTotal:!1}}})})),Object(i.a)(t,"getClientList",(function(){return{Data:g,ExtraData:{Columns:{Id:{FieldName:"Id",CanShow:!0},Key:{FieldName:"Key",CanShow:!0,CanSort:!1,Width:"30%",Type:{type:"readonly_with_tree",more:JSON.stringify({fLevel:"TreeLevel",fLastOfLevel:"LastOfLevel",fHasChild:"HasChild",fLevelConfig:"LevelConfigs"})}},Value:{FieldName:"Value",CanShow:!0,CanSort:!1,CanEdit:!!S,Width:"70%",Type:{type:"superman"}}}}}})),t)})}),Object(O.jsx)("div",{style:{borderTop:"1px solid #e9ecef"}}),x&&Object(O.jsx)("div",{style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",background:"#ffffff99"}})]})};function E(e){var t=Object(y.a)({props:e}),n=null;"string"===typeof t.valueCell&&t.valueCell.length>0&&(n=d.HJson.getObj(t.valueCell));var o=Object(l.a)(Object(l.a)(Object(l.a)({},t.getSharedConfig()),t.moreObj),{},{jsonview:Object(l.a)({showMini:!0,enableClipboard:!1,displayDataTypes:!1},t.moreObj.jsonview)});return Object(O.jsxs)("div",{className:t.classNameWrap("mtc-json_editor"),onClick:function(){console.warn("Click json:",e),h.a.showFromComponent((function(e){return Object(O.jsx)(S,Object(l.a)(Object(l.a)({},e),{},{ctc:t,obj:n||{},config:o}))}),{title:C.k.fnGetHeaderTitle(t.fnList)||"JSON",backdrop:"static",showHeader:!1,fnList:{updateCell:function(e,n){console.warn("Updatecell:",e,n),t.updateFieldData(e,n)}}})},style:Object(l.a)({cursor:!0===t.canEdit?"pointer":"inherit"},o.style),children:[null!=n&&!0===o.jsonview.showMini&&Object(O.jsxs)(F,{children:[Object(O.jsxs)("div",{children:["JSON (",null!=n&&"".concat(Object.keys(n).length),")"]}),Object(O.jsx)("div",{style:{color:"grey",fontWeight:"normal"},children:t.valueCell})]}),null==n&&!0===o.jsonview.showMini&&Object(O.jsx)(F,{style:{color:"grey"},children:Object(O.jsx)("div",{children:"JSON"})}),null!=n&&!0!==o.jsonview.showMini&&Object(O.jsx)(x,{children:Object(O.jsx)(g.a,Object(l.a)({src:n},o.jsonview))})]})}},510:function(e,t,n){"use strict";var o=n(32),a=n(13),r=n(31),l=n(4),i=n(1),c=n(57),s=n.n(c),f=n(0),d=n.n(f),u=n(11),p=n(9),b=n(511),g=n(155),m=n(157),v=n(79),h=n(2),j="fnGetScreenCode",y=function(e){var t=e.oneTableCell,n=Object(l.a)({},t.fnList);return n[p.O]=function(){var e=t.row,o=t.extra,a=t.extra.Type.source,r=p.j.getSourceList(n);if(m.e(a))return m.b(r,a,e,o.Type.sourceField);if(a&&a.startsWith("["))return i.HJson.getObj(a);if(a&&a.startsWith("f")){var l=a.slice(1,a.length);return null!=e[l]&&Array.isArray(e[l])?e[l]:null!=e[a]&&Array.isArray(e[a])?e[a]:[]}return r[a]||[]},n[p.T]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.customMore,o=e.count,a=e.tooltip,r=t.row,l=t.more;return C.renderBadge({more:n||l,row:r,count:o,tooltip:a})},n[p.H]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.customTitle;return g.a.Cell_GetHeaderTitle({extra:t.extra,customTitle:n})},n[p.u]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0,o=t.more,a=n;return o&&o.hasOwnProperty(e)&&(a=o[e]),a},n[p.v]=function(){var e=t.row,n=t.extra,o=t.more;return g.a.Cell_GetConfigModal({extra:n,more:o,row:e})},n[p.I]=function(){var e=t.row,n=t.extra,o=t.more,a=t.getValue();if(!1===Object(v.FlowGetCanShow)({extra:n,row:e,more:o}))return!0;return!(!o[v.KMore.hideWhenEmpty]||""!==a&&null!=a&&0!==a)||(!(!o[v.KMore.hideWhenNull]||null!=a)||!!(i.MyTableCellHelpers.ConfigByTypes&&i.MyTableCellHelpers.ConfigByTypes[t.type]&&i.MyTableCellHelpers.ConfigByTypes[t.type].isHide&&i.MyTableCellHelpers.ConfigByTypes[t.type].isHide(t)))},n.onSendMsg=function(e){console.error("missing onSendMsg, need update fnList",e)},n.onReExpand=function(){var e=t.row;i.HUtils.runFuntion(e,"_fnForceUpdateDetail")},t.fnList=n,n},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return i.HUtils.runFuntion(e.fnList,j,t)},C={renderBadge:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.more,n=void 0===t?{}:t,o=e.row,a=void 0===o?{}:o,r=e.count,l=e.tooltip,c=n.configBadge||n.badge;if(null!=r||c&&!0===c.show){var s=r,f=l;if(c&&c.fCount&&null!=a[c.fCount]&&(s=a[c.fCount]),s)return c&&c.fTooltip&&a[c.fTooltip]&&(f=a[c.fTooltip]),f?Object(h.jsx)(u.k,{overlay:Object(h.jsx)(i.MyUI,{type:"html",html:f}),children:Object(h.jsx)("span",{className:"mct-ui-badge",children:s})}):Object(h.jsx)("span",{className:"mct-ui-badge",children:s})}}},O=n(156),x="fnRequestUpdate",F="fnRequestCustom";function T(e){var t=e.ctc,n=e.more,o=t.row.Id,a=w(t),r={};n&&(n.fID&&t.row[n.fID]&&(o=t.row[n.fID]),r=n.configFile||n.file||{});var c=Object(l.a)({needRequestPhotos:!0,pasteAsFile:!0,showUploadFromGGDrive:!1},r),s={ScreenCode:a,ProjectId:"",Id:o,FieldName:t.fieldName};return Object(h.jsx)("div",{children:Object(h.jsx)(i.MyUI,{type:"file_manager",requestData:s,fnList:e.fnList,configFile:c,canUpload:e.canUpload})})}var M=function(e){e.fieldName;var t=e.extra,n=e.row,o=t||{},a=e.more,l=!1;if("boolean"===typeof o.CanEdit&&(l=o.CanEdit),1==l)if(null==a.fCanEdit&&null!=a.canEditF&&(a.fCanEdit=a.canEditF),"boolean"===typeof a.fCanEdit)l=a.fCanEdit;else if("string"===typeof a.fCanEdit&&a.fCanEdit.length>0)if(null!=n[a.fCanEdit])l=n[a.fCanEdit];else if(a.fCanEdit.indexOf(",")>-1){var i=a.fCanEdit.split(",");if(i&&i.length>0){var c,s=Object(r.a)(i);try{for(s.s();!(c=s.n()).done;){if(0==n[c.value]){l=!1;break}}}catch(b){s.e(b)}finally{s.f()}}}if(null!=a.lockF||null!=a.fLock){var f=a.lockF||a.fLock;if("boolean"==typeof f)l=!f;else if("string"==typeof f&&f.length>0)if(null!=n[f])l=!n[f];else if(f.indexOf(",")>-1){var d=f.split(",");if(d&&d.length>0){var u,p=Object(r.a)(d);try{for(p.s();!(u=p.n()).done;){if(1==n[u.value]){l=!1;break}}}catch(b){p.e(b)}finally{p.f()}}}}return l};t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.props;0;var n=Object(f.useState)(0),r=Object(a.a)(n,2),c=(r[0],r[1],Object(f.useState)(null===t.cell||void 0===t.cell?"":t.cell)),m=Object(a.a)(c,2),j=m[0],w=m[1],C=t.cell,S=t.extra,E=S.fieldName,U=Object(f.useState)(!1),L=Object(a.a)(U,2),P=L[0],H=L[1],A=Object(f.useState)(!1),N=Object(a.a)(A,2),k=N[0],I=N[1],D=d.a.useRef(new i.OneTableCell(t)),R=D.current;R.row=t.row,R.extra=S,t.custom&&!0!==R._updateCustom&&(R.more=Object(l.a)(Object(l.a)({},t.custom.more),R.more),R._updateCustom=!0);var _=R.row,B=d.a.useRef(y({oneTableCell:R,row:_,extra:S,cell:C})),V=B.current;null==R._onePage&&R.updateOnePage(p.j.fnGetOnePage(V));var q=R.more,W=Object(O.a)(),G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.cbWhenEqual,n=_[E];console.log("updateValueCellFromRow:",n),j!=n?w(null===n||void 0===n?"":n):(console.log("call cbWhenEqual"),t&&t())};return!0===_.IsLocked?R.canEdit=!1:null!=R.canEdit&&!0!==R.canEdit&&!1!==R.canEdit||(R.canEdit=M({extra:R.extra,more:q,row:_})),d.a.useEffect((function(){"string"===typeof t.cell||"number"===typeof t.cell||"boolean"===typeof t.cell?t.cell!=j&&w(t.cell):w(t.cell)}),[t.cell]),{forceUpdate:W,fnList:V,updateValueCellFromRow:G,oneTableCell:R,extra:R.extra,row:R.row,fieldName:R.fieldName,more:R.more,moreObj:R.more,canEdit:R.canEdit,updateFieldData:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.warn("updateFieldData:",e,R),e==C||null==C&&""==e?(console.warn("not update:",e,C,n),n&&n.cbError&&n.cbError({msg:"Nothing to change"})):(H(!0),i.HUtils.runFuntion(R.fnList,x,[Object(l.a)(Object(l.a)({},n),{},{apiController:p.j.fnGetApiPath(V),fieldName:n.fieldName||R.fieldName,row:R.row,newValue:e,cbSuccess:function(e){console.warn("cbss",e),H(!1),p.j.fnForceUpdateTable(V,[]),n&&n.cbSuccess&&n.cbSuccess(e),t.fnList&&t.fnList.cbSuccessUpdate&&t.fnList.cbSuccessUpdate()},cbError:function(t){console.warn("cber",t),H(!1),n&&n.cbError&&n.cbError(e)}})]))},requestCustom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("requestCustom:",e),i.HUtils.runFuntion(R.fnList,F,[Object(l.a)({},e)])},getSharedConfig:function(){return{}},getMoreAttrsFromCustomConfig:function(){return i.MyTableCellHelpers.ConfigByTypes&&i.MyTableCellHelpers.ConfigByTypes[R.type]&&i.MyTableCellHelpers.ConfigByTypes[R.type].moreAttrs?i.MyTableCellHelpers.ConfigByTypes[R.type].moreAttrs:{}},getMorePropsButton:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.defaultStyle,n={},o=t||{};return k&&(n.disabled=!0),q&&q.button&&q.button.style&&(o=Object(l.a)(Object(l.a)({},o),q.button.style)),o&&Object.keys(o).length>0&&(n.style=o),n},renderHide:function(){return Object(h.jsx)("div",{className:"disabled"})},isUpdating:P,setIsUpdating:function(e){H(e)},isFetching:k,setIsFetching:I,valueCell:j,setValueCell:w,classNameWrap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s()(e,Object(l.a)({disabled:!1===R.canEdit,"a-scrwhhover":null!=q.scrwhhover?q.scrwhhover:n.scrwhhover||!1,"styled-mini":q.styledMini},null!=t.custom&&null!=t.custom.className?Object(o.a)({},t.custom.className,!0):{}))},styleWrap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return g.a.Cell_GetStyleCell({extra:S,more:q,row:_,defaultStyle:e,overideStyle:t})},onUpdateRow:function(e){i.HUtils.runFuntion(R.fnList,"onUpdateRow",[{row:_,newRow:e}])},getTextDisplaySelect:function(){var e="";if(q.fDisplay&&_[q.fDisplay]?e=_[q.fDisplay]:q.fShow&&_[q.fShow]&&(e=_[q.fShow]),""==e&&null!=j&&""!==j){var t=V.fnGetSourceData(),n=i.HOptions.getTextDisplayOfValueFromOptions(t,j);n&&(e=n)}return""==e&&(e=j||""),e},renderTopRight:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(h.jsx)(i.MyTableCell,Object(l.a)(Object(l.a)({},t),{},{fnList:V,more:q,oneTableCell:R,type:"_barTopRight",moreBtns:e,moreConfig:n}))},renderLoadingOverlay:function(){return Object(h.jsx)("div",{className:"a-overlay-center",children:Object(h.jsx)(i.MyLoading,{type:"threedotsvertical",size:12})})},onClickForm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.customMore,n=e.cbSuccess,o=e.customShowForm,a=t||q;console.warn("onClickForm:",a),I(!0),Object(v.FlowCheckApiShowModal)({extra:S,row:_,more:q,fnList:V,cb:function(e){var t=e.canShow;e.config;if(t){var r=R.getConfigForm({customMore:a}),c=_;if(a.fDefaultValues&&(c=_[a.fDefaultValues]?_[a.fDefaultValues]:{}),r){var s=i.MyFormControlHelpers.getConfigFormFromConfigV1(r,{defaultValues:c,fnList:Object(l.a)(Object(l.a)({},V),{},{onSubmitForm:function(e,t){var o=t.myForm;console.warn("onSubmitForm:",e);var r=R.getConfigApi({customMore:a});return new Promise((function(t,a){r?(r.query=Object.assign(r.query,e),Object(b.a)(r).then((function(e){console.warn("onClickBtn API rs",e),Object(v.FlowParseResponseAndNeedReload)({extra:S,row:_,fieldName:E,more:q,oneTableCell:R,response:e}),o.closeMyModal&&o.closeMyModal(),n&&n(e),t(e)})).catch((function(e){a(e)}))):(console.warn("Missing configApi"),a("Missing configApi"))}))}})}),f=R.getConfigModal({customMore:a});o?o(s,Object(l.a)({},f)):u.f.showFromMyForm(s,Object(l.a)({},f))}else console.error("Missing configForm:",r)}I(!1)}})},onClickApi:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.customMore,n=(e.cbSuccess,e.cbError),o=e.cbBeforeRequest,a=e.cbAfterRequest,r=t||q;console.warn("onClickApi:",r);var l=R.getConfigApi({customMore:r});r.confirmMsg?u.f.showConfirm({title:r.titleConfirm||"Confirm",msg:r.confirmMsg,onClickOK:function(e){l?(o&&o(),Object(b.a)(l).then((function(e){console.warn("onClickBtn API rs",e),Object(v.FlowParseResponseAndNeedReload)({extra:S,row:_,fieldName:E,more:r,oneTableCell:R,response:e})})).finally((function(){a&&a()}))):console.warn("Missing configApi"),e&&e.hide&&e.hide()}}):l?(o&&o(),Object(b.a)(l).then((function(e){console.warn("onClickBtn API rs",e),Object(v.FlowParseResponseAndNeedReload)({extra:S,row:_,fieldName:E,more:r,oneTableCell:R,response:e})})).finally((function(){a&&a()}))):(console.warn("Missing configApi"),n&&n())},onClickFiles:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.ctc,n=e.customMore,o=e.canUpload,a=n||q;console.warn("onClickFiles:",a),u.f.showFromComponent((function(e){return Object(h.jsx)(T,Object(l.a)(Object(l.a)({},e),{},{more:a,canUpload:o,ctc:t}))}),{title:"Modal",backdrop:"static",size:"xl",showHeader:!1,fnList:{updateCell:function(e,t){console.warn("Updatecell:",e,t)},fnGetApiPath:function(){return p.j.fnGetApiPath(V)},onChangeData:function(e){console.warn("onChangeData:",e,C),e&&C?e.Id===C.Id||C.hasOwnProperty&&e.hasOwnProperty&&C.hasOwnProperty("Photos")&&e.hasOwnProperty("Photos")?(i.HUtils.mergeObjIfExist(_[E],e),i.HUtils.runFuntion(R.fnList,"onUpdateRow",[{row:_,newRow:_}]),W()):console.warn("Update data row, wrong ID",e,C):console.warn("Update data row, wrong data",e,C)}}})}}}},511:function(e,t,n){"use strict";var o=n(52);t.a=o.apiWithConfigApi},563:function(e,t,n){"use strict";var o={fnUpload:null,fnPatse:function(e){e.preventDefault(),console.warn("paste:",e);var t=e.clipboardData.items;console.warn("paste items:",t);var n=[];if(t){for(var a=0;a<t.length;a++){var r=t[a];if(console.log("Paste Item type: "+r.type,r.kind),"file"==r.kind){var l=r.getAsFile();n.push(l),console.log("Paste Item file: "+r,l)}else{var i=(e.originalEvent||e).clipboardData.getData("text/plain");window.document.execCommand&&window.document.execCommand("insertText",!1,i),console.log("paste text:",i)}}console.log("PasteHelper.fnUpload:",o.fnUpload),o.fnUpload&&n.length>0&&o.fnUpload(n)}},checkPasteSupported:function(){var e=document.createElement("div");return e.setAttribute("onpaste","return;"),"function"==typeof e.onpaste},addEventUploadFileAfterPaste:function(e){o.fnUpload=e},removeEventUploadFileAfterPaste:function(){o.fnUpload=null},removeEvenPaste:function(){window.removeEventListener("paste",o.fnPatse,!1)},addEventPaste:function(){window.addEventListener("paste",o.fnPatse,!1)},copyTextToClipboard:function(e,t){navigator&&navigator.clipboard&&navigator.clipboard.writeText&&e&&navigator.clipboard.writeText(e).then((function(){t&&t()}))}};t.a=o}}]);
//# sourceMappingURL=46.e7f5241a.chunk.js.map