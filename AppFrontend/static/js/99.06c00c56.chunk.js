(this["webpackJsonpapp-admin-v5"]=this["webpackJsonpapp-admin-v5"]||[]).push([[99],{1342:function(e,a,t){"use strict";t.r(a);var n,r,o=t(4),s=t(16),i=t(17),d=t(18),l=t(19),c=t(0),u=t.n(c),p=t(10),m=t(822),f=t(11),h=t(87),b=t(680),v=(t(821),t(22)),j=t(20),w=t(2),y=Object(j.c)(n||(n=Object(v.a)(["\n  from {\n    transform: rotate(0deg);\n  }\n\n  to {\n    transform: rotate(360deg);\n  }\n"]))),g=j.b.div(r||(r=Object(v.a)(["\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  background-color: rgba(255, 255, 255, 0.8);\n  & svg {\n    fill: var(--color-primary);\n    animation: "," 2s linear infinite;\n  }\n  & p {\n    color: var(--color-primary);\n    margin-top: 1rem;\n  }\n  & > div {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-direction: column;\n    height: 100vh;\n  }\n"])),y);function N(){return Object(w.jsx)(g,{children:Object(w.jsxs)("div",{children:[Object(w.jsx)(b.a,{style:{width:30,height:30}}),Object(w.jsx)("p",{children:"Please wait a second..."})]})})}var P=t(6),O=t(99),x=function(e){Object(d.a)(t,e);var a=Object(l.a)(t);function t(){var e;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=a.call.apply(a,[this].concat(r))).state={data:null,tabId:0,uploading:!1,dataLoading:!1,keyForm:0},e.requestProfile=function(){var a=e.state.keyForm;e.setState({dataLoading:!0},(function(){p.a.apiGeneric({method:"GET",path:"Account",name:"UserInfo"}).then((function(t){e.setState({dataLoading:!1},(function(){(null===t||void 0===t?void 0:t.Data)&&e.setState({data:t.Data,keyForm:a+1})}))})).catch((function(a){console.error("requestProfile error:",a),e.setState({dataLoading:!1})}))}))},e.requestUpdateChanges=function(a){var t=e.state.keyForm;e.setState({dataLoading:!0},(function(){p.a.apiGeneric({method:"POST",path:"Account",name:"UpdateFields",data:a}).then((function(a){e.setState({dataLoading:!1},(function(){var n,r;(null===a||void 0===a?void 0:a.Data)&&(e.setState({data:a.Data,keyForm:t+1}),Object(O.FlowUpdateAuthInfo)({name:null===a||void 0===a||null===(n=a.Data)||void 0===n?void 0:n.DisplayName,avatar:null===a||void 0===a||null===(r=a.Data)||void 0===r?void 0:r.ProfilePicturePath}))}))})).catch((function(a){console.error("requestUpdateChanges error:",a),e.setState({dataLoading:!1})}))}))},e.requestUpdatePwd=function(a){e.setState({dataLoading:!0},(function(){p.a.apiGeneric({method:"POST",url:"Account/ChangePassword",data:a}).then((function(a){e.setState({dataLoading:!1})})).catch((function(a){console.error("requestUpdatePwd error:",a),e.setState({dataLoading:!1})}))}))},e.requestUploadAvatar=function(a){e.setState({uploading:!0},(function(){p.a.apiUpload({url:"Upload/User/MyAvatar",data:a}).then((function(a){e.setState({uploading:!1},(function(){if(null===a||void 0===a?void 0:a.Data){var t,n,r=e.state.data;r.ProfilePicturePath=null===(t=a.Data)||void 0===t?void 0:t.Avatar,e.setState({data:Object(o.a)({},r)}),Object(O.FlowUpdateAuthInfo)({name:null,avatar:null===(n=a.Data)||void 0===n?void 0:n.Avatar})}}))})).catch((function(a){console.error("requestUploadAvatar error:",a),e.setState({uploading:!1})}))}))},e.onChangeTab=function(a){e.setState({tabId:a})},e.onSaveChanges=function(a){console.warn("onSaveChanges - newValues",a);var t=e.state.data,n=!1,r=[];a&&(Object.keys(a).forEach((function(e){(!a[e]&&t[e]||a[e]!==t[e])&&(n=!0,r.push({FieldName:e,NewValue:a[e]}))})),n?e.requestUpdateChanges({Id:t.Id,Values:r}):p.k.showToast("There is no changes",{type:"warning"}))},e.onUploadAvatar=function(a){var t=null===a||void 0===a?void 0:a[0],n=new FileReader;n.onloadend=function(){var a=new FormData;a.append("file[]",t),e.requestUploadAvatar(a)},n.readAsDataURL(t)},e.onChangePassword=function(a){if(console.warn("onChangePassword - newValues",a),a){var t=e.state.data;a.Password&&a.NewPassword&&a.ConfirmPassword&&a.Password!==a.ConfirmPassword?e.requestUpdatePwd(Object(o.a)({Id:null===t||void 0===t?void 0:t.Id},a)):a.Password&&a.ConfirmPassword&&a.Password===a.ConfirmPassword?p.k.showToast("New password must be different with current password",{type:"warning"}):p.k.showToast("Please enter all password",{type:"warning"})}},e.renderTabs=function(){var a=e.state.tabId;return Object(w.jsxs)("div",{className:"p-row-dFaCjFs tabs",children:[Object(w.jsx)("span",{className:"tab-item".concat(0===a?" active":""),onClick:function(){return e.onChangeTab(0)},children:"Profile"}),Object(w.jsx)("span",{className:"tab-item".concat(1===a?" active":""),onClick:function(){return e.onChangeTab(1)},children:"Change Password"})]})},e.renderInfoTab=function(){var a=e.state,t=a.data,n=a.keyForm,r={defaultValues:t,more:{typeWrapControl:"wfc_inline"},controls:[{label:"Username",fieldName:"Username",type:"text",more:{placeholder:"Enter your username",disabled:!0}},{label:"Email Address",fieldName:"EmailAddress",type:"text",more:{placeholder:"Enter your email",disabled:!0}},{label:"Display Name",fieldName:"DisplayName",type:"text",more:{placeholder:"Enter your display name"}},{label:"First Name",fieldName:"FirstName",type:"text",more:{placeholder:"Enter your first name"}},{label:"Middle Name",fieldName:"MiddleName",type:"text",more:{placeholder:"Enter your middle name"}},{label:"Last Name",fieldName:"LastName",type:"text",more:{placeholder:"Enter your last name"}},{label:"Date Of Birth",fieldName:"DateOfBirth",type:"v1_mfc_lable_control_inline",more:{controlType:"esc_date_flatpickr",moreOptionsDateFlatPickr:{dateFormat:"Y/m/d"},morePropsDateFlatPickr:{placeholder:"yyyy/mm/dd"}}},{label:"Phone Number",fieldName:"PhoneNumber",type:"text",more:{placeholder:"Enter your phone number"}},{label:"Address",fieldName:"Address",type:"text",more:{placeholder:"Enter your address"}},{label:"Note",fieldName:"Note",type:"textarea",more:{placeholder:"Enter your note",rows:5}}]};return Object(w.jsxs)("div",{className:"p-info-tab",children:[Object(w.jsx)("strong",{className:"p-title-tab",children:"My Profile Infomation"}),Object(w.jsx)(f.c,{configForm:r,fnList:{},renderFooter:function(a){return Object(w.jsx)("div",{className:"p-row-dFaCjFe",children:Object(w.jsx)(h.a,{color:"esc-info",onClick:function(){return e.onSaveChanges(a.getCurrentValues())},children:"Save Changes"})})}},n)]})},e.renderPwdTab=function(){var a={defaultValues:e.state.data,more:{typeWrapControl:"wfc_inline"},controls:[{label:"Current Password",fieldName:"Password",type:"password",more:{placeholder:"Enter your current password"}},{label:"New Password",fieldName:"NewPassword",type:"password",more:{placeholder:"Enter your new password"}},{label:"Confirm Password",fieldName:"ConfirmPassword",type:"password",more:{placeholder:"Confirm new password"}}]};return Object(w.jsxs)("div",{className:"p-info-tab",children:[Object(w.jsx)("strong",{className:"p-title-tab",children:"My Password"}),Object(w.jsx)(f.c,{configForm:a,fnList:{},renderFooter:function(a){return Object(w.jsx)("div",{className:"p-row-dFaCjFe",children:Object(w.jsx)(h.a,{color:"esc-info",onClick:function(){return e.onChangePassword(a.getCurrentValues())},children:"Save Changes"})})}})]})},e.renderHeader=function(){var a=e.state,t=a.data,n=a.uploading,r=null===t||void 0===t?void 0:t.ProfilePicturePath,o=null===t||void 0===t?void 0:t.DisplayName,s=null===t||void 0===t?void 0:t.EmailAddress;return Object(w.jsxs)("div",{className:"p-header bg-gradient-primary text-white",children:[Object(w.jsxs)("div",{className:"p-row-dFaCjFs",children:[Object(w.jsxs)("label",{htmlFor:"upload-profile-picture",className:"p-avatar",style:{margin:"0px"},children:[Object(w.jsx)(f.h,{type:"avatar",src:r}),n&&Object(w.jsx)("div",{className:"p-overlay-loading rounded",children:Object(w.jsx)(b.a,{})}),Object(w.jsxs)("div",{className:"p-upload",children:[Object(w.jsx)("label",{htmlFor:"upload-profile-picture",style:{margin:"0px"},children:Object(w.jsx)(m.a,{})}),Object(w.jsx)("input",{id:"upload-profile-picture",type:"file",accept:"image/*",disabled:n,onChange:function(a){return e.onUploadAvatar(a.target.files)}})]})]}),Object(w.jsxs)("div",{className:"p-short-info",children:[Object(w.jsx)("span",{className:"name",children:o}),Object(w.jsx)("span",{children:s})]})]}),e.renderTabs()]})},e.renderContent=function(){var a=e.state.tabId;return Object(w.jsxs)("div",{className:"p-content",children:[0===a&&e.renderInfoTab(),1===a&&e.renderPwdTab()]})},e}return Object(i.a)(t,[{key:"componentDidMount",value:function(){p.d.changeTitle("My Profile","My Profile"),this.requestProfile(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";document.body.classList.add(e)}(P.b.appFullContainer)}},{key:"componentWillUnmount",value:function(){!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";document.body.classList.remove(e)}(P.b.appFullContainer)}},{key:"render",value:function(){var e=this.state.dataLoading;return Object(w.jsxs)("div",{className:"mp_pprofile",children:[this.renderHeader(),this.renderContent(),e&&Object(w.jsx)(N,{})]})}}]),t}(u.a.Component);a.default=x},821:function(e,a,t){}}]);
//# sourceMappingURL=99.06c00c56.chunk.js.map