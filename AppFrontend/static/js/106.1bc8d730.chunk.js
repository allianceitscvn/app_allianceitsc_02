(this["webpackJsonpapp-admin-v5"]=this["webpackJsonpapp-admin-v5"]||[]).push([[106],{510:function(e,n,o){"use strict";var t=o(32),r=o(13),i=o(31),l=o(4),a=o(1),c=o(57),s=o.n(c),u=o(0),f=o.n(u),d=o(11),b=o(9),p=o(511),m=o(155),g=o(157),h=o(79),v=o(2),y="fnGetScreenCode",C=function(e){var n=e.oneTableCell,o=Object(l.a)({},n.fnList);return o[b.O]=function(){var e=n.row,t=n.extra,r=n.extra.Type.source,i=b.j.getSourceList(o);if(g.e(r))return g.b(i,r,e,t.Type.sourceField);if(r&&r.startsWith("["))return a.HJson.getObj(r);if(r&&r.startsWith("f")){var l=r.slice(1,r.length);return null!=e[l]&&Array.isArray(e[l])?e[l]:null!=e[r]&&Array.isArray(e[r])?e[r]:[]}return i[r]||[]},o[b.T]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=e.customMore,t=e.count,r=e.tooltip,i=n.row,l=n.more;return j.renderBadge({more:o||l,row:i,count:t,tooltip:r})},o[b.H]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=e.customTitle;return m.a.Cell_GetHeaderTitle({extra:n.extra,customTitle:o})},o[b.u]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1?arguments[1]:void 0,t=n.more,r=o;return t&&t.hasOwnProperty(e)&&(r=t[e]),r},o[b.v]=function(){var e=n.row,o=n.extra,t=n.more;return m.a.Cell_GetConfigModal({extra:o,more:t,row:e})},o[b.I]=function(){var e=n.row,o=n.extra,t=n.more,r=n.getValue();if(!1===Object(h.FlowGetCanShow)({extra:o,row:e,more:t}))return!0;return!(!t[h.KMore.hideWhenEmpty]||""!==r&&null!=r&&0!==r)||(!(!t[h.KMore.hideWhenNull]||null!=r)||!!(a.MyTableCellHelpers.ConfigByTypes&&a.MyTableCellHelpers.ConfigByTypes[n.type]&&a.MyTableCellHelpers.ConfigByTypes[n.type].isHide&&a.MyTableCellHelpers.ConfigByTypes[n.type].isHide(n)))},o.onSendMsg=function(e){console.error("missing onSendMsg, need update fnList",e)},o.onReExpand=function(){var e=n.row;a.HUtils.runFuntion(e,"_fnForceUpdateDetail")},n.fnList=o,o},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return a.HUtils.runFuntion(e.fnList,y,n)},j={renderBadge:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.more,o=void 0===n?{}:n,t=e.row,r=void 0===t?{}:t,i=e.count,l=e.tooltip,c=o.configBadge||o.badge;if(null!=i||c&&!0===c.show){var s=i,u=l;if(c&&c.fCount&&null!=r[c.fCount]&&(s=r[c.fCount]),s)return c&&c.fTooltip&&r[c.fTooltip]&&(u=r[c.fTooltip]),u?Object(v.jsx)(d.k,{overlay:Object(v.jsx)(a.MyUI,{type:"html",html:u}),children:Object(v.jsx)("span",{className:"mct-ui-badge",children:s})}):Object(v.jsx)("span",{className:"mct-ui-badge",children:s})}}},O=o(156),x="fnRequestUpdate",F="fnRequestCustom";function M(e){var n=e.ctc,o=e.more,t=n.row.Id,r=w(n),i={};o&&(o.fID&&n.row[o.fID]&&(t=n.row[o.fID]),i=o.configFile||o.file||{});var c=Object(l.a)({needRequestPhotos:!0,pasteAsFile:!0,showUploadFromGGDrive:!1},i),s={ScreenCode:r,ProjectId:"",Id:t,FieldName:n.fieldName};return Object(v.jsx)("div",{children:Object(v.jsx)(a.MyUI,{type:"file_manager",requestData:s,fnList:e.fnList,configFile:c,canUpload:e.canUpload})})}var T=function(e){e.fieldName;var n=e.extra,o=e.row,t=n||{},r=e.more,l=!1;if("boolean"===typeof t.CanEdit&&(l=t.CanEdit),1==l)if(null==r.fCanEdit&&null!=r.canEditF&&(r.fCanEdit=r.canEditF),"boolean"===typeof r.fCanEdit)l=r.fCanEdit;else if("string"===typeof r.fCanEdit&&r.fCanEdit.length>0)if(null!=o[r.fCanEdit])l=o[r.fCanEdit];else if(r.fCanEdit.indexOf(",")>-1){var a=r.fCanEdit.split(",");if(a&&a.length>0){var c,s=Object(i.a)(a);try{for(s.s();!(c=s.n()).done;){if(0==o[c.value]){l=!1;break}}}catch(p){s.e(p)}finally{s.f()}}}if(null!=r.lockF||null!=r.fLock){var u=r.lockF||r.fLock;if("boolean"==typeof u)l=!u;else if("string"==typeof u&&u.length>0)if(null!=o[u])l=!o[u];else if(u.indexOf(",")>-1){var f=u.split(",");if(f&&f.length>0){var d,b=Object(i.a)(f);try{for(b.s();!(d=b.n()).done;){if(1==o[d.value]){l=!1;break}}}catch(p){b.e(p)}finally{b.f()}}}}return l};n.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.props;0;var o=Object(u.useState)(0),i=Object(r.a)(o,2),c=(i[0],i[1],Object(u.useState)(null===n.cell||void 0===n.cell?"":n.cell)),g=Object(r.a)(c,2),y=g[0],w=g[1],j=n.cell,k=n.extra,N=k.fieldName,E=Object(u.useState)(!1),P=Object(r.a)(E,2),S=P[0],D=P[1],U=Object(u.useState)(!1),A=Object(r.a)(U,2),H=A[0],L=A[1],R=f.a.useRef(new a.OneTableCell(n)),I=R.current;I.row=n.row,I.extra=k,n.custom&&!0!==I._updateCustom&&(I.more=Object(l.a)(Object(l.a)({},n.custom.more),I.more),I._updateCustom=!0);var B=I.row,G=f.a.useRef(C({oneTableCell:I,row:B,extra:k,cell:j})),q=G.current;null==I._onePage&&I.updateOnePage(b.j.fnGetOnePage(q));var V=I.more,W=Object(O.a)(),_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.cbWhenEqual,o=B[N];console.log("updateValueCellFromRow:",o),y!=o?w(null===o||void 0===o?"":o):(console.log("call cbWhenEqual"),n&&n())};return!0===B.IsLocked?I.canEdit=!1:null!=I.canEdit&&!0!==I.canEdit&&!1!==I.canEdit||(I.canEdit=T({extra:I.extra,more:V,row:B})),f.a.useEffect((function(){"string"===typeof n.cell||"number"===typeof n.cell||"boolean"===typeof n.cell?n.cell!=y&&w(n.cell):w(n.cell)}),[n.cell]),{forceUpdate:W,fnList:q,updateValueCellFromRow:_,oneTableCell:I,extra:I.extra,row:I.row,fieldName:I.fieldName,more:I.more,moreObj:I.more,canEdit:I.canEdit,updateFieldData:function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.warn("updateFieldData:",e,I),e==j||null==j&&""==e?(console.warn("not update:",e,j,o),o&&o.cbError&&o.cbError({msg:"Nothing to change"})):(D(!0),a.HUtils.runFuntion(I.fnList,x,[Object(l.a)(Object(l.a)({},o),{},{apiController:b.j.fnGetApiPath(q),fieldName:o.fieldName||I.fieldName,row:I.row,newValue:e,cbSuccess:function(e){console.warn("cbss",e),D(!1),b.j.fnForceUpdateTable(q,[]),o&&o.cbSuccess&&o.cbSuccess(e),n.fnList&&n.fnList.cbSuccessUpdate&&n.fnList.cbSuccessUpdate()},cbError:function(n){console.warn("cber",n),D(!1),o&&o.cbError&&o.cbError(e)}})]))},requestCustom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("requestCustom:",e),a.HUtils.runFuntion(I.fnList,F,[Object(l.a)({},e)])},getSharedConfig:function(){return{}},getMoreAttrsFromCustomConfig:function(){return a.MyTableCellHelpers.ConfigByTypes&&a.MyTableCellHelpers.ConfigByTypes[I.type]&&a.MyTableCellHelpers.ConfigByTypes[I.type].moreAttrs?a.MyTableCellHelpers.ConfigByTypes[I.type].moreAttrs:{}},getMorePropsButton:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.defaultStyle,o={},t=n||{};return H&&(o.disabled=!0),V&&V.button&&V.button.style&&(t=Object(l.a)(Object(l.a)({},t),V.button.style)),t&&Object.keys(t).length>0&&(o.style=t),o},renderHide:function(){return Object(v.jsx)("div",{className:"disabled"})},isUpdating:S,setIsUpdating:function(e){D(e)},isFetching:H,setIsFetching:L,valueCell:y,setValueCell:w,classNameWrap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s()(e,Object(l.a)({disabled:!1===I.canEdit,"a-scrwhhover":null!=V.scrwhhover?V.scrwhhover:o.scrwhhover||!1,"styled-mini":V.styledMini},null!=n.custom&&null!=n.custom.className?Object(t.a)({},n.custom.className,!0):{}))},styleWrap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return m.a.Cell_GetStyleCell({extra:k,more:V,row:B,defaultStyle:e,overideStyle:n})},onUpdateRow:function(e){a.HUtils.runFuntion(I.fnList,"onUpdateRow",[{row:B,newRow:e}])},getTextDisplaySelect:function(){var e="";if(V.fDisplay&&B[V.fDisplay]?e=B[V.fDisplay]:V.fShow&&B[V.fShow]&&(e=B[V.fShow]),""==e&&null!=y&&""!==y){var n=q.fnGetSourceData(),o=a.HOptions.getTextDisplayOfValueFromOptions(n,y);o&&(e=o)}return""==e&&(e=y||""),e},renderTopRight:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(v.jsx)(a.MyTableCell,Object(l.a)(Object(l.a)({},n),{},{fnList:q,more:V,oneTableCell:I,type:"_barTopRight",moreBtns:e,moreConfig:o}))},renderLoadingOverlay:function(){return Object(v.jsx)("div",{className:"a-overlay-center",children:Object(v.jsx)(a.MyLoading,{type:"threedotsvertical",size:12})})},onClickForm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.customMore,o=e.cbSuccess,t=e.customShowForm,r=n||V;console.warn("onClickForm:",r),L(!0),Object(h.FlowCheckApiShowModal)({extra:k,row:B,more:V,fnList:q,cb:function(e){var n=e.canShow;e.config;if(n){var i=I.getConfigForm({customMore:r}),c=B;if(r.fDefaultValues&&(c=B[r.fDefaultValues]?B[r.fDefaultValues]:{}),i){var s=a.MyFormControlHelpers.getConfigFormFromConfigV1(i,{defaultValues:c,fnList:Object(l.a)(Object(l.a)({},q),{},{onSubmitForm:function(e,n){var t=n.myForm;console.warn("onSubmitForm:",e);var i=I.getConfigApi({customMore:r});return new Promise((function(n,r){i?(i.query=Object.assign(i.query,e),Object(p.a)(i).then((function(e){console.warn("onClickBtn API rs",e),Object(h.FlowParseResponseAndNeedReload)({extra:k,row:B,fieldName:N,more:V,oneTableCell:I,response:e}),t.closeMyModal&&t.closeMyModal(),o&&o(e),n(e)})).catch((function(e){r(e)}))):(console.warn("Missing configApi"),r("Missing configApi"))}))}})}),u=I.getConfigModal({customMore:r});t?t(s,Object(l.a)({},u)):d.f.showFromMyForm(s,Object(l.a)({},u))}else console.error("Missing configForm:",i)}L(!1)}})},onClickApi:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.customMore,o=(e.cbSuccess,e.cbError),t=e.cbBeforeRequest,r=e.cbAfterRequest,i=n||V;console.warn("onClickApi:",i);var l=I.getConfigApi({customMore:i});i.confirmMsg?d.f.showConfirm({title:i.titleConfirm||"Confirm",msg:i.confirmMsg,onClickOK:function(e){l?(t&&t(),Object(p.a)(l).then((function(e){console.warn("onClickBtn API rs",e),Object(h.FlowParseResponseAndNeedReload)({extra:k,row:B,fieldName:N,more:i,oneTableCell:I,response:e})})).finally((function(){r&&r()}))):console.warn("Missing configApi"),e&&e.hide&&e.hide()}}):l?(t&&t(),Object(p.a)(l).then((function(e){console.warn("onClickBtn API rs",e),Object(h.FlowParseResponseAndNeedReload)({extra:k,row:B,fieldName:N,more:i,oneTableCell:I,response:e})})).finally((function(){r&&r()}))):(console.warn("Missing configApi"),o&&o())},onClickFiles:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.ctc,o=e.customMore,t=e.canUpload,r=o||V;console.warn("onClickFiles:",r),d.f.showFromComponent((function(e){return Object(v.jsx)(M,Object(l.a)(Object(l.a)({},e),{},{more:r,canUpload:t,ctc:n}))}),{title:"Modal",backdrop:"static",size:"xl",showHeader:!1,fnList:{updateCell:function(e,n){console.warn("Updatecell:",e,n)},fnGetApiPath:function(){return b.j.fnGetApiPath(q)},onChangeData:function(e){console.warn("onChangeData:",e,j),e&&j?e.Id===j.Id||j.hasOwnProperty&&e.hasOwnProperty&&j.hasOwnProperty("Photos")&&e.hasOwnProperty("Photos")?(a.HUtils.mergeObjIfExist(B[N],e),a.HUtils.runFuntion(I.fnList,"onUpdateRow",[{row:B,newRow:B}]),W()):console.warn("Update data row, wrong ID",e,j):console.warn("Update data row, wrong data",e,j)}}})}}}},511:function(e,n,o){"use strict";var t=o(52);n.a=t.apiWithConfigApi},701:function(e,n,o){"use strict";o.r(n),o.d(n,"default",(function(){return m}));var t,r,i=o(4),l=o(22),a=(o(0),o(510)),c=(o(155),o(1),o(20)),s=o(79),u=o(9),f=o(2),d=c.b.div(t||(t=Object(l.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  &.disabled > div > div {\n    cursor: auto;\n  }\n"]))),b=c.b.div(r||(r=Object(l.a)(['\n  display: inline-block;\n  position: relative;\n  display: block;\n  & > div {\n    min-height: 20px;\n    margin-bottom: 0;\n    font-weight: normal;\n    cursor: pointer;\n  }\n  & input[type="checkbox"] {\n    display: none;\n    position: absolute;\n    margin-left: -20px;\n  }\n  & input[type="checkbox"] + i:before {\n    content: "','";\n    position: relative;\n    color: ',';\n  }\n  &:hover input[type="checkbox"] + i:before {\n    color: ',';\n  }\n  & input[type="checkbox"]:checked + i:before {\n    content: "','";\n    color: ',';\n  }\n  & input[type="checkbox"]:disabled + i:before {\n    color: ',';\n  }\n  & input[type="checkbox"]:disabled:checked + i:before {\n    color: ',";\n  }\n"])),(function(e){return e.cbNormal&&e.cbNormal.iconChar?e.cbNormal.iconChar:"\f096"}),(function(e){return e.cbNormal&&e.cbNormal.color?e.cbNormal.color:"#999"}),(function(e){return e.cbPositive&&e.cbPositive.color?e.cbPositive.color:"#3db73d"}),(function(e){return e.cbPositive&&e.cbPositive.iconChar?e.cbPositive.iconChar:"\f046"}),(function(e){return e.cbPositive&&e.cbPositive.color?e.cbPositive.color:"#3db73d"}),(function(e){return e.cbNormal&&e.cbNormal.colorDisabled?e.cbNormal.colorDisabled:"#ddd"}),(function(e){return e.cbPositive&&e.cbPositive.colorDisabled?e.cbPositive.colorDisabled:"#228322"})),p=function(e,n,o,t){o&&o[t]&&(n[t]=o[t],o[t].fColor&&e[o[t].fColor]&&(n[t].color=e[o[t].fColor]),o[t].fColorDisabled&&e[o[t].fColorDisabled]&&(n[t].colorDisabled=e[o[t].fColorDisabled]))};function m(e){var n=Object(a.a)({props:e}),o=n.more,t=n.row;if(u.k.fnGetIsHide(n.fnList))return n.renderHide();var r=function(e,n){var o={};return p(e,o,n,s.KMore.cbNormal),p(e,o,n,s.KMore.cbPositive),o}(t,o);return Object(f.jsxs)(d,{className:n.classNameWrap("mtc-checkbox"),style:n.styleWrap(),children:[Object(f.jsx)(b,Object(i.a)(Object(i.a)({onClick:function(){console.warn("onClick:"),n.canEdit&&n.updateFieldData(!0!==n.valueCell)},title:Object(s.FlowGetTitleTooltipOfColumn)(Object(i.a)({},n))},r),{},{children:Object(f.jsxs)("div",{onClick:function(){},children:[Object(f.jsx)("input",{type:"checkbox",disabled:!n.canEdit,checked:!0===n.valueCell,onChange:function(){}}),Object(f.jsx)("i",{className:"fa fa-2x"})]})})),!0===n.isUpdating&&n.renderLoadingOverlay()]})}}}]);
//# sourceMappingURL=106.1bc8d730.chunk.js.map