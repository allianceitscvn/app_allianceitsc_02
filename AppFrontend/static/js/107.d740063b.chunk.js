(this["webpackJsonpapp-admin-v5"]=this["webpackJsonpapp-admin-v5"]||[]).push([[107],{1242:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return h}));var o,r=n(4),l=n(13),a=n(22),i=n(1),c=n(0),s=n.n(c),u=n(11),f=n(20),d=n(510),p=n(87),b=n(2),m=f.b.div(o||(o=Object(a.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  & > div {\n    border: 1px solid #f1f4f6;\n    border-radius: 12px;\n    height: 24px;\n    width: 24px;\n    cursor: pointer;\n    box-shadow: inset 0 0 1px #ffffff;\n  }\n"])));function g(e){var t=e.ctc,n=s.a.useState(t.valueCell||"#999"),o=Object(l.a)(n,2),r=o[0],a=o[1];return Object(b.jsxs)("div",{style:{minWidth:"100px",minHeight:"50px"},children:[Object(b.jsx)(i.MyLib,{type:"chromepicker",color:r,style:{boxShadow:"none"},onChange:function(e){a(e)}}),Object(b.jsx)(p.a,{color:"primary",style:{width:"100%"},onClick:function(){var n=r.hex||r;t.updateFieldData(n),e.hide&&e.hide()},children:"OK"})]})}function h(e){e.cell;var t=Object(d.a)({props:e}),n=!1,o="";t.valueCell&&(o=t.valueCell),null!=o&&""!=o||(n=!0);var l={background:o};return n&&(l={}),Object(b.jsx)(m,{className:t.classNameWrap("mct-chromecolor"),children:Object(b.jsx)(u.i,{overlay:function(e){return Object(b.jsx)(g,Object(r.a)({ctc:t},e))},overlayClassName:"m-popover m-popover-full",placement:"bottom",destroyTooltipOnHide:!0,disabled:!1===t.canEdit,children:Object(b.jsx)("div",{style:l,className:n?"bg-no-color":""})})})}},510:function(e,t,n){"use strict";var o=n(32),r=n(13),l=n(31),a=n(4),i=n(1),c=n(57),s=n.n(c),u=n(0),f=n.n(u),d=n(11),p=n(9),b=n(511),m=n(155),g=n(157),h=n(79),v=n(2),y="fnGetScreenCode",w=function(e){var t=e.oneTableCell,n=Object(a.a)({},t.fnList);return n[p.O]=function(){var e=t.row,o=t.extra,r=t.extra.Type.source,l=p.j.getSourceList(n);if(g.e(r))return g.b(l,r,e,o.Type.sourceField);if(r&&r.startsWith("["))return i.HJson.getObj(r);if(r&&r.startsWith("f")){var a=r.slice(1,r.length);return null!=e[a]&&Array.isArray(e[a])?e[a]:null!=e[r]&&Array.isArray(e[r])?e[r]:[]}return l[r]||[]},n[p.T]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.customMore,o=e.count,r=e.tooltip,l=t.row,a=t.more;return j.renderBadge({more:n||a,row:l,count:o,tooltip:r})},n[p.H]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.customTitle;return m.a.Cell_GetHeaderTitle({extra:t.extra,customTitle:n})},n[p.u]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0,o=t.more,r=n;return o&&o.hasOwnProperty(e)&&(r=o[e]),r},n[p.v]=function(){var e=t.row,n=t.extra,o=t.more;return m.a.Cell_GetConfigModal({extra:n,more:o,row:e})},n[p.I]=function(){var e=t.row,n=t.extra,o=t.more,r=t.getValue();if(!1===Object(h.FlowGetCanShow)({extra:n,row:e,more:o}))return!0;return!(!o[h.KMore.hideWhenEmpty]||""!==r&&null!=r&&0!==r)||(!(!o[h.KMore.hideWhenNull]||null!=r)||!!(i.MyTableCellHelpers.ConfigByTypes&&i.MyTableCellHelpers.ConfigByTypes[t.type]&&i.MyTableCellHelpers.ConfigByTypes[t.type].isHide&&i.MyTableCellHelpers.ConfigByTypes[t.type].isHide(t)))},n.onSendMsg=function(e){console.error("missing onSendMsg, need update fnList",e)},n.onReExpand=function(){var e=t.row;i.HUtils.runFuntion(e,"_fnForceUpdateDetail")},t.fnList=n,n},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return i.HUtils.runFuntion(e.fnList,y,t)},j={renderBadge:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.more,n=void 0===t?{}:t,o=e.row,r=void 0===o?{}:o,l=e.count,a=e.tooltip,c=n.configBadge||n.badge;if(null!=l||c&&!0===c.show){var s=l,u=a;if(c&&c.fCount&&null!=r[c.fCount]&&(s=r[c.fCount]),s)return c&&c.fTooltip&&r[c.fTooltip]&&(u=r[c.fTooltip]),u?Object(v.jsx)(d.k,{overlay:Object(v.jsx)(i.MyUI,{type:"html",html:u}),children:Object(v.jsx)("span",{className:"mct-ui-badge",children:s})}):Object(v.jsx)("span",{className:"mct-ui-badge",children:s})}}},O=n(156),x="fnRequestUpdate",F="fnRequestCustom";function M(e){var t=e.ctc,n=e.more,o=t.row.Id,r=C(t),l={};n&&(n.fID&&t.row[n.fID]&&(o=t.row[n.fID]),l=n.configFile||n.file||{});var c=Object(a.a)({needRequestPhotos:!0,pasteAsFile:!0,showUploadFromGGDrive:!1},l),s={ScreenCode:r,ProjectId:"",Id:o,FieldName:t.fieldName};return Object(v.jsx)("div",{children:Object(v.jsx)(i.MyUI,{type:"file_manager",requestData:s,fnList:e.fnList,configFile:c,canUpload:e.canUpload})})}var T=function(e){e.fieldName;var t=e.extra,n=e.row,o=t||{},r=e.more,a=!1;if("boolean"===typeof o.CanEdit&&(a=o.CanEdit),1==a)if(null==r.fCanEdit&&null!=r.canEditF&&(r.fCanEdit=r.canEditF),"boolean"===typeof r.fCanEdit)a=r.fCanEdit;else if("string"===typeof r.fCanEdit&&r.fCanEdit.length>0)if(null!=n[r.fCanEdit])a=n[r.fCanEdit];else if(r.fCanEdit.indexOf(",")>-1){var i=r.fCanEdit.split(",");if(i&&i.length>0){var c,s=Object(l.a)(i);try{for(s.s();!(c=s.n()).done;){if(0==n[c.value]){a=!1;break}}}catch(b){s.e(b)}finally{s.f()}}}if(null!=r.lockF||null!=r.fLock){var u=r.lockF||r.fLock;if("boolean"==typeof u)a=!u;else if("string"==typeof u&&u.length>0)if(null!=n[u])a=!n[u];else if(u.indexOf(",")>-1){var f=u.split(",");if(f&&f.length>0){var d,p=Object(l.a)(f);try{for(p.s();!(d=p.n()).done;){if(1==n[d.value]){a=!1;break}}}catch(b){p.e(b)}finally{p.f()}}}}return a};t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.props;0;var n=Object(u.useState)(0),l=Object(r.a)(n,2),c=(l[0],l[1],Object(u.useState)(null===t.cell||void 0===t.cell?"":t.cell)),g=Object(r.a)(c,2),y=g[0],C=g[1],j=t.cell,E=t.extra,S=E.fieldName,A=Object(u.useState)(!1),N=Object(r.a)(A,2),U=N[0],k=N[1],H=Object(u.useState)(!1),L=Object(r.a)(H,2),P=L[0],R=L[1],D=f.a.useRef(new i.OneTableCell(t)),I=D.current;I.row=t.row,I.extra=E,t.custom&&!0!==I._updateCustom&&(I.more=Object(a.a)(Object(a.a)({},t.custom.more),I.more),I._updateCustom=!0);var B=I.row,q=f.a.useRef(w({oneTableCell:I,row:B,extra:E,cell:j})),G=q.current;null==I._onePage&&I.updateOnePage(p.j.fnGetOnePage(G));var V=I.more,W=Object(O.a)(),_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.cbWhenEqual,n=B[S];console.log("updateValueCellFromRow:",n),y!=n?C(null===n||void 0===n?"":n):(console.log("call cbWhenEqual"),t&&t())};return!0===B.IsLocked?I.canEdit=!1:null!=I.canEdit&&!0!==I.canEdit&&!1!==I.canEdit||(I.canEdit=T({extra:I.extra,more:V,row:B})),f.a.useEffect((function(){"string"===typeof t.cell||"number"===typeof t.cell||"boolean"===typeof t.cell?t.cell!=y&&C(t.cell):C(t.cell)}),[t.cell]),{forceUpdate:W,fnList:G,updateValueCellFromRow:_,oneTableCell:I,extra:I.extra,row:I.row,fieldName:I.fieldName,more:I.more,moreObj:I.more,canEdit:I.canEdit,updateFieldData:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.warn("updateFieldData:",e,I),e==j||null==j&&""==e?(console.warn("not update:",e,j,n),n&&n.cbError&&n.cbError({msg:"Nothing to change"})):(k(!0),i.HUtils.runFuntion(I.fnList,x,[Object(a.a)(Object(a.a)({},n),{},{apiController:p.j.fnGetApiPath(G),fieldName:n.fieldName||I.fieldName,row:I.row,newValue:e,cbSuccess:function(e){console.warn("cbss",e),k(!1),p.j.fnForceUpdateTable(G,[]),n&&n.cbSuccess&&n.cbSuccess(e),t.fnList&&t.fnList.cbSuccessUpdate&&t.fnList.cbSuccessUpdate()},cbError:function(t){console.warn("cber",t),k(!1),n&&n.cbError&&n.cbError(e)}})]))},requestCustom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("requestCustom:",e),i.HUtils.runFuntion(I.fnList,F,[Object(a.a)({},e)])},getSharedConfig:function(){return{}},getMoreAttrsFromCustomConfig:function(){return i.MyTableCellHelpers.ConfigByTypes&&i.MyTableCellHelpers.ConfigByTypes[I.type]&&i.MyTableCellHelpers.ConfigByTypes[I.type].moreAttrs?i.MyTableCellHelpers.ConfigByTypes[I.type].moreAttrs:{}},getMorePropsButton:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.defaultStyle,n={},o=t||{};return P&&(n.disabled=!0),V&&V.button&&V.button.style&&(o=Object(a.a)(Object(a.a)({},o),V.button.style)),o&&Object.keys(o).length>0&&(n.style=o),n},renderHide:function(){return Object(v.jsx)("div",{className:"disabled"})},isUpdating:U,setIsUpdating:function(e){k(e)},isFetching:P,setIsFetching:R,valueCell:y,setValueCell:C,classNameWrap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s()(e,Object(a.a)({disabled:!1===I.canEdit,"a-scrwhhover":null!=V.scrwhhover?V.scrwhhover:n.scrwhhover||!1,"styled-mini":V.styledMini},null!=t.custom&&null!=t.custom.className?Object(o.a)({},t.custom.className,!0):{}))},styleWrap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return m.a.Cell_GetStyleCell({extra:E,more:V,row:B,defaultStyle:e,overideStyle:t})},onUpdateRow:function(e){i.HUtils.runFuntion(I.fnList,"onUpdateRow",[{row:B,newRow:e}])},getTextDisplaySelect:function(){var e="";if(V.fDisplay&&B[V.fDisplay]?e=B[V.fDisplay]:V.fShow&&B[V.fShow]&&(e=B[V.fShow]),""==e&&null!=y&&""!==y){var t=G.fnGetSourceData(),n=i.HOptions.getTextDisplayOfValueFromOptions(t,y);n&&(e=n)}return""==e&&(e=y||""),e},renderTopRight:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(v.jsx)(i.MyTableCell,Object(a.a)(Object(a.a)({},t),{},{fnList:G,more:V,oneTableCell:I,type:"_barTopRight",moreBtns:e,moreConfig:n}))},renderLoadingOverlay:function(){return Object(v.jsx)("div",{className:"a-overlay-center",children:Object(v.jsx)(i.MyLoading,{type:"threedotsvertical",size:12})})},onClickForm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.customMore,n=e.cbSuccess,o=e.customShowForm,r=t||V;console.warn("onClickForm:",r),R(!0),Object(h.FlowCheckApiShowModal)({extra:E,row:B,more:V,fnList:G,cb:function(e){var t=e.canShow;e.config;if(t){var l=I.getConfigForm({customMore:r}),c=B;if(r.fDefaultValues&&(c=B[r.fDefaultValues]?B[r.fDefaultValues]:{}),l){var s=i.MyFormControlHelpers.getConfigFormFromConfigV1(l,{defaultValues:c,fnList:Object(a.a)(Object(a.a)({},G),{},{onSubmitForm:function(e,t){var o=t.myForm;console.warn("onSubmitForm:",e);var l=I.getConfigApi({customMore:r});return new Promise((function(t,r){l?(l.query=Object.assign(l.query,e),Object(b.a)(l).then((function(e){console.warn("onClickBtn API rs",e),Object(h.FlowParseResponseAndNeedReload)({extra:E,row:B,fieldName:S,more:V,oneTableCell:I,response:e}),o.closeMyModal&&o.closeMyModal(),n&&n(e),t(e)})).catch((function(e){r(e)}))):(console.warn("Missing configApi"),r("Missing configApi"))}))}})}),u=I.getConfigModal({customMore:r});o?o(s,Object(a.a)({},u)):d.f.showFromMyForm(s,Object(a.a)({},u))}else console.error("Missing configForm:",l)}R(!1)}})},onClickApi:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.customMore,n=(e.cbSuccess,e.cbError),o=e.cbBeforeRequest,r=e.cbAfterRequest,l=t||V;console.warn("onClickApi:",l);var a=I.getConfigApi({customMore:l});l.confirmMsg?d.f.showConfirm({title:l.titleConfirm||"Confirm",msg:l.confirmMsg,onClickOK:function(e){a?(o&&o(),Object(b.a)(a).then((function(e){console.warn("onClickBtn API rs",e),Object(h.FlowParseResponseAndNeedReload)({extra:E,row:B,fieldName:S,more:l,oneTableCell:I,response:e})})).finally((function(){r&&r()}))):console.warn("Missing configApi"),e&&e.hide&&e.hide()}}):a?(o&&o(),Object(b.a)(a).then((function(e){console.warn("onClickBtn API rs",e),Object(h.FlowParseResponseAndNeedReload)({extra:E,row:B,fieldName:S,more:l,oneTableCell:I,response:e})})).finally((function(){r&&r()}))):(console.warn("Missing configApi"),n&&n())},onClickFiles:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.ctc,n=e.customMore,o=e.canUpload,r=n||V;console.warn("onClickFiles:",r),d.f.showFromComponent((function(e){return Object(v.jsx)(M,Object(a.a)(Object(a.a)({},e),{},{more:r,canUpload:o,ctc:t}))}),{title:"Modal",backdrop:"static",size:"xl",showHeader:!1,fnList:{updateCell:function(e,t){console.warn("Updatecell:",e,t)},fnGetApiPath:function(){return p.j.fnGetApiPath(G)},onChangeData:function(e){console.warn("onChangeData:",e,j),e&&j?e.Id===j.Id||j.hasOwnProperty&&e.hasOwnProperty&&j.hasOwnProperty("Photos")&&e.hasOwnProperty("Photos")?(i.HUtils.mergeObjIfExist(B[S],e),i.HUtils.runFuntion(I.fnList,"onUpdateRow",[{row:B,newRow:B}]),W()):console.warn("Update data row, wrong ID",e,j):console.warn("Update data row, wrong data",e,j)}}})}}}},511:function(e,t,n){"use strict";var o=n(52);t.a=o.apiWithConfigApi}}]);
//# sourceMappingURL=107.d740063b.chunk.js.map