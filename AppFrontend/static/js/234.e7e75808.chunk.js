(this["webpackJsonpapp-admin-v5"]=this["webpackJsonpapp-admin-v5"]||[]).push([[234],{1313:function(e,t,n){"use strict";n.r(t);var a,r,o=n(22),i=n(16),s=n(17),c=n(18),l=n(19),p=n(0),u=n(20),d=n(88),j=n(547),f=n.n(j),h=n(1),g=n(11),b=n(2);function m(e){var t=e.sourceData,n=e.valueSelected,a=e.onChange,r=e.virtualized;return Object(b.jsx)("div",{style:{maxHeight:"calc(100vh - 5rem)"},children:Object(b.jsx)(h.MyUI,{type:!0===r?"select_box_search_virtualized":"select_box_search",sourceData:t,valueSelected:n,onChange:a,inModal:!0})})}var x=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(e){var a,r;return Object(i.a)(this,n),(r=t.call(this,e)).requestList=function(){Object(d.a)({request:{method:"POST",path:"ProjectMgmt",name:"List"},data:{},successCallBack:function(e){if(e.Data&&e.Data.Data){var t;if(t=e.Data.Data.map((function(e,t){return{Value:e.UniqueId,Text:e.Name}})),r._projectUniqueId){var n=e.Data.Data.filter((function(e,t){return e.UniqueId==r._projectUniqueId})),a=null;0==n.length&&e.Data.Data.length>0?(r._projectUniqueId=e.Data.Data[0].UniqueId,r._projectId=e.Data.Data[0].Id,window.location.href="/pj/".concat(r._projectUniqueId)):n.length>0&&(a=n[0],r._projectId=a.Id),r.setState({currentProject:a,projects:e.Data.Data,projectsOptions:t},(function(){r.requestProjectInfo()}))}else r.setState({projects:e.Data.Data,projectsOptions:t},(function(){r.requestProjectInfo()}))}},errorCallBack:function(e){console.log(e)}})},r.requestProjectInfo=function(){Object(d.a)({request:{method:"POST",path:"Project_Ext",name:"GetItemsWithKey"},data:{ProjectId:r._projectId,Key:"Info"},successCallBack:function(e){console.warn("res:",e);var t={enviroments:[],platforms:[]};if(e&&e.Data)for(var n=0;n<e.Data.length;n++){var a=e.Data[n];"Info"==a.Key&&(t=h.HJson.getObj(a.Value)||{})}r.setState({projectInfo:t})},errorCallBack:function(e){console.log(e)}})},r.requestProjectExtraOfKey=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Object(d.a)({request:{method:"POST",path:"Project_Ext",name:"GetItemsWithKey"},data:{ProjectId:r._projectId,Key:e},successCallBack:function(n){console.warn("requestProjectExtraOfKey res:",n);var r=null;if(n&&n.Data)if(a)r=n.Data;else for(var o=0;o<n.Data.length;o++){var i=n.Data[o];if(i.Key==e){r=i;break}}t&&t(r)},errorCallBack:function(e){console.log(e),n&&n(e)}})},r.requestUpdate=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.key,n=e.value,a=e.title,o=e.isUpdateValue,i=e.isUpdateTitle,s=(e.isUpdateBoth,e.cbSuccess);if(t){var c=[];i&&c.push({FieldName:"Title",NewValue:a}),o&&c.push({FieldName:"Value",NewValue:n}),Object(d.a)({request:{method:"POST",path:"Project_Ext",name:"UpdateFields"},data:{Id:t,ProjectId:r._projectId,Values:c},successCallBack:function(e){s&&s(e)},errorCallBack:function(e){console.log(e)}})}else console.warn("Missing key")},r.requestUpdateInfo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.key,n=e.value,a=e.cbSuccess,o=r.state.projectInfo||{};o[t]=n,r.requestUpdate({key:"Info",value:h.HJson.getString(o),isUpdateValue:!0,cbSuccess:a})},r.state={projects:[],projectsOptions:[],currentProject:null,projectInfo:{},open:!0},r._params=null===e||void 0===e||null===(a=e.match)||void 0===a?void 0:a.params,r._projectId=r._params.pj,r._projectUniqueId=r._params.pj,r._paramsurl=h.HLink.getAllParamOnUrl()||{},r._tabkey=r._paramsurl.tab,r._fnList={getCurrentProjectId:function(){return r._projectId},getCurrentProjectUniqueId:function(){return r._projectUniqueId},getCurrentProjectInfo:function(){return r.state.projectInfo},getCurrentProjectExtra:function(e,t,n,a){return r.requestProjectExtraOfKey(e,t,n,a)},onUpdateProjectExtra:function(e){r.requestUpdate(e)},onUpdateProjectInfo:function(e){r.requestUpdateInfo(e)}},console.warn("props",e),r}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.requestList()}},{key:"render",value:function(){var e=this;if(console.log("MP_PRJManager"),null==this._projectId||""==this._projectId)return Object(b.jsxs)(v,{className:"a-pj-list",children:[Object(b.jsxs)("div",{className:"a-header",children:[Object(b.jsx)("div",{className:"a-hleft",children:"Projects"}),Object(b.jsx)("div",{className:"a-hright",children:Object(b.jsx)("div",{children:Object(b.jsx)("button",{className:"btn btn-primary",onClick:function(){g.f.showFromMyUI({type:"prj_new_project",fnList:{reloadList:function(){e.requestList()}}},{title:"New Project",size:"xs"})},children:"+ Project"})})})]}),Object(b.jsx)("div",{children:null!=this.state.projects&&this.state.projects.length>0?Object(b.jsx)("div",{children:Object(b.jsx)(h.MyUI,{type:"grid",data:this.state.projects,typeItem:"prj_pj_item",morePropsItem:{},fnList:{onClickItem:function(e){console.log("click item:",e),window.location.href="/pj/".concat(e.UniqueId)}}})}):Object(b.jsx)("div",{children:"No Project"})})]});var t=[],n=this.state.currentProject;if(null==n)return Object(b.jsx)("div",{});!1!==n.CanSeeOverview&&t.push({title:"Overview",key:"info",getContent:function(){return Object(b.jsx)(h.MyPage,{configPage:{UIType:"prj_info"},fnList:e._fnList})}}),t.push({title:"Api",key:"api",getContent:function(){return Object(b.jsx)(h.MyPage,{configPage:{UIType:"prj_api"},fnList:e._fnList})}}),t.push({title:"Tasks",key:"task",getContent:function(){return Object(b.jsx)("div",{style:{height:"100%",overflow:"auto"},children:Object(b.jsx)(h.MyPage,{configPage:{UIType:"prj_dailytask",RequestData:{ProjectId:e._projectUniqueId},Config:{apiPath:"UserTask",hideHeader:!0,showAssignTo:!0}},fnList:e._fnList})})}}),t.push({title:"Users",key:"users",getContent:function(){return Object(b.jsx)(h.MyPage,{configPage:{UIType:"prj_users"},fnList:e._fnList})}}),t.push({title:Object(b.jsxs)("div",{children:["Releases",Object(b.jsx)(_,{style:{marginLeft:"5px"},onClick:function(t){t.preventDefault(),t.stopPropagation(),g.f.showFromMyUI({type:"prj_new_release",fnList:e._fnList},{title:"New release"})},className:"fa fa-plus"})]}),key:"releases",getContent:function(){return Object(b.jsx)(h.MyPage,{configPage:{UIType:"prj_releases"},fnList:e._fnList})}});var a=t[0].key;if(this._tabkey)for(var r=0;r<t.length;r++){var o=t[r];if(o.key==this._tabkey){a=o.key;break}}return console.warn("selected:",a),Object(b.jsxs)(v,{className:"mp-prj_manager",children:[Object(b.jsxs)("div",{className:"prj-header",children:[Object(b.jsxs)("div",{className:"a-hleft",onClick:function(){g.f.showFromComponent((function(t){return Object(b.jsx)(m,{sourceData:e.state.projectsOptions,onChange:function(e){console.warn("onChange:",e,e.Value),window.location.href="/pj/".concat(e.Value),h.HUtils.runFuntion(t.fnList,"hideModal",[])}})}),{title:"Select",fnList:{updateCell:function(e,t){console.warn("Updatecell:",e,t)}}})},children:["Project ",this._projectUniqueId]}),Object(b.jsx)("div",{className:"a-hright"})]}),Object(b.jsx)("div",{className:"prj-tabs",children:t&&t.length>0&&Object(b.jsx)(f.a,{tabsWrapperClass:"body-tabs body-tabs-layout no-print",transform:!1,showInkBar:!0,items:t,selectedTabKey:a,onChange:function(e){console.warn("onChange:",e),h.HLink.updateParamOnUrl("tab",e),h.HLink.clearParamOnUrl("api")}})}),Object(b.jsx)("div",{className:"prj-content",children:t&&0==t.length&&Object(b.jsx)("div",{children:"No Contents in Options!"})})]})}}]),n}(p.Component),v=u.b.div(a||(a=Object(o.a)(["\n  &.a-pj-list {\n    & .a-header {\n      border-bottom: 1px solid #dbdbdb;\n      margin-bottom: 10px;\n      padding-bottom: 10px;\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      & .a-hleft {\n        font-size: 20px;\n        font-weight: bold;\n      }\n      & .a-hright {\n        display: flex;\n        align-items: center;\n        & > div {\n          padding-left: 5px;\n        }\n      }\n    }\n    & .a-pj-item {\n    }\n  }\n  &.mp-prj_manager {\n    margin-top: -30px;\n    margin-left: -30px;\n    margin-right: -30px;\n    height: calc(100% + 30px);\n    display: flex;\n    flex-direction: column;\n  }\n  & .prj-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 1.25rem;\n\n    & .a-hleft {\n    }\n    & .a-hright {\n      display: flex;\n      align-items: center;\n      & > div {\n        padding-left: 5px;\n      }\n    }\n  }\n  & .prj-tabs {\n    height: 100%;\n    background: white;\n    & > .RRT__container {\n      height: 100%;\n      & > .RRT__panel {\n        // height: 700px;\n        margin-top: 0px;\n        background: #f7f7f7;\n        position: absolute;\n        left: 0;\n        right: 0;\n        top: 54px;\n        bottom: 0;\n      }\n      & .prjapi-right {\n        & .RRT__container {\n          height: calc(100% - 22px);\n          & > .RRT__panel {\n            height: calc(100% - 32px);\n            margin: 0px;\n          }\n        }\n      }\n    }\n  }\n"]))),_=u.b.i(r||(r=Object(o.a)(["\n  margin-left: 5px;\n  background: #cfefcd;\n  width: 20px;\n  height: 20px;\n  padding: 3px;\n  text-align: center;\n  border-radius: 10px;\n  color: green;\n  border: 1px solid green;\n"])));t.default=x}}]);
//# sourceMappingURL=234.e7e75808.chunk.js.map