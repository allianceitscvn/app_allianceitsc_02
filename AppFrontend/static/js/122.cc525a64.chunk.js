(this["webpackJsonpapp-admin-v5"]=this["webpackJsonpapp-admin-v5"]||[]).push([[122],{1247:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return y}));var o,r,a,i=n(4),l=n(32),c=n(22),s=(n(0),n(1)),f=n(510),u=n(11),d=n(9),p=n(172),b=n(20),m=n(79),g=n(2),h=b.b.div(o||(o=Object(c.a)(["\n  overflow: hidden;\n  & .mpat-header {\n    padding: 0px;\n    margin: 0px;\n    margin-bottom: 10px;\n  }\n  & .mpat-table {\n    margin-bottom: 0px !important;\n    box-shadow: none;\n    > .card-body {\n      padding: 0px;\n    }\n  }\n"]))),v=b.b.div(r||(r=Object(c.a)(["\n  border: 1px solid #e9ecef;\n"]))),w=b.b.button(a||(a=Object(c.a)(["\n  font-size: 18px;\n  color: #283343;\n  background: #c1daff;\n  padding: 2px;\n  border-radius: 4px;\n  line-height: 15px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  border: 0px;\n"]))),j=function(e){console.warn("render modal",e);var t=null;if(e.fnList&&e.fnList.fnGetData&&(t=e.fnList.fnGetData()),t){var n;if(t.Data&&t.ExtraData)return Object(g.jsx)(h,{children:Object(g.jsx)(s.MyPage,{configPage:{UIUrl:"",ScreenCode:"ClientTableExtra",Title:"",APIName:"",UIType:"admin_table_client",Config:null,RequestData:"",Id:""},fnList:(n={fnCustomUpdateField:function(e){e.apiController,e.cbSuccess,e.cbError,e.requestData;var t=e.row,n=e.newValue,o=e.fieldName;console.warn("Update field",t,n,o)}},Object(l.a)(n,d.J,(function(){return!0})),Object(l.a)(n,"getClientOptions",(function(){return Object(p.a)({configHeader:{show:!1},configTable:{canDelete:!1,optionsTable:{sizePerPage:1e4,hideSizePerPage:!0,paginationShowsTotal:!1},tableProps:{pagination:!1}}})})),Object(l.a)(n,"getClientList",(function(){return{Data:t.Data,ExtraData:t.ExtraData}})),n)})});var o="";return t&&(o=JSON.stringify(t,0,2)),Object(g.jsx)(v,{children:Object(g.jsx)(s.MyLib,{type:"code_mirror",value:o,options:{mode:{name:"javascript",json:!0,statementIndent:2},lineNumbers:!0,lineWrapping:!0,indentWithTabs:!1,tabSize:2,theme:"default"}})})}return Object(g.jsx)("div",{children:"No data"})};function y(e){var t=Object(f.a)({props:e}),n=e.cell;if(s.HIs.isObject(n))return Object(g.jsx)("div",{});var o=[];return n&&n.length>0&&o.push(Object(g.jsx)(w,{onClick:function(){console.warn("Click show");var e=s.HJson.getObj(n);e&&u.f.showFromComponent(j,{title:d.k.fnGetHeaderTitle(t.fnList)||t.fieldName,size:"xl",fnList:{fnGetData:function(){return e}}})},children:Object(g.jsx)("i",{className:"fa fa-table"})})),Object(g.jsxs)("div",{className:t.classNameWrap("mct-modal_table_extra",{scrwhhover:!0}),style:t.styleWrap({cursor:!0===t.canEdit?"pointer":"inherit",overflow:"auto"}),children:[Object(m.FlowGetCustomDisplay)(Object(i.a)(Object(i.a)({},t),{},{value:n,defaultConfigDisplay:{showShortText:!0,countShort:50}})),t.renderTopRight(o,{ctc:t})]})}},510:function(e,t,n){"use strict";var o=n(32),r=n(13),a=n(31),i=n(4),l=n(1),c=n(57),s=n.n(c),f=n(0),u=n.n(f),d=n(11),p=n(9),b=n(511),m=n(155),g=n(157),h=n(79),v=n(2),w="fnGetScreenCode",j=function(e){var t=e.oneTableCell,n=Object(i.a)({},t.fnList);return n[p.O]=function(){var e=t.row,o=t.extra,r=t.extra.Type.source,a=p.j.getSourceList(n);if(g.e(r))return g.b(a,r,e,o.Type.sourceField);if(r&&r.startsWith("["))return l.HJson.getObj(r);if(r&&r.startsWith("f")){var i=r.slice(1,r.length);return null!=e[i]&&Array.isArray(e[i])?e[i]:null!=e[r]&&Array.isArray(e[r])?e[r]:[]}return a[r]||[]},n[p.T]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.customMore,o=e.count,r=e.tooltip,a=t.row,i=t.more;return C.renderBadge({more:n||i,row:a,count:o,tooltip:r})},n[p.H]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.customTitle;return m.a.Cell_GetHeaderTitle({extra:t.extra,customTitle:n})},n[p.u]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0,o=t.more,r=n;return o&&o.hasOwnProperty(e)&&(r=o[e]),r},n[p.v]=function(){var e=t.row,n=t.extra,o=t.more;return m.a.Cell_GetConfigModal({extra:n,more:o,row:e})},n[p.I]=function(){var e=t.row,n=t.extra,o=t.more,r=t.getValue();if(!1===Object(h.FlowGetCanShow)({extra:n,row:e,more:o}))return!0;return!(!o[h.KMore.hideWhenEmpty]||""!==r&&null!=r&&0!==r)||(!(!o[h.KMore.hideWhenNull]||null!=r)||!!(l.MyTableCellHelpers.ConfigByTypes&&l.MyTableCellHelpers.ConfigByTypes[t.type]&&l.MyTableCellHelpers.ConfigByTypes[t.type].isHide&&l.MyTableCellHelpers.ConfigByTypes[t.type].isHide(t)))},n.onSendMsg=function(e){console.error("missing onSendMsg, need update fnList",e)},n.onReExpand=function(){var e=t.row;l.HUtils.runFuntion(e,"_fnForceUpdateDetail")},t.fnList=n,n},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return l.HUtils.runFuntion(e.fnList,w,t)},C={renderBadge:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.more,n=void 0===t?{}:t,o=e.row,r=void 0===o?{}:o,a=e.count,i=e.tooltip,c=n.configBadge||n.badge;if(null!=a||c&&!0===c.show){var s=a,f=i;if(c&&c.fCount&&null!=r[c.fCount]&&(s=r[c.fCount]),s)return c&&c.fTooltip&&r[c.fTooltip]&&(f=r[c.fTooltip]),f?Object(v.jsx)(d.k,{overlay:Object(v.jsx)(l.MyUI,{type:"html",html:f}),children:Object(v.jsx)("span",{className:"mct-ui-badge",children:s})}):Object(v.jsx)("span",{className:"mct-ui-badge",children:s})}}},O=n(156),x="fnRequestUpdate",F="fnRequestCustom";function T(e){var t=e.ctc,n=e.more,o=t.row.Id,r=y(t),a={};n&&(n.fID&&t.row[n.fID]&&(o=t.row[n.fID]),a=n.configFile||n.file||{});var c=Object(i.a)({needRequestPhotos:!0,pasteAsFile:!0,showUploadFromGGDrive:!1},a),s={ScreenCode:r,ProjectId:"",Id:o,FieldName:t.fieldName};return Object(v.jsx)("div",{children:Object(v.jsx)(l.MyUI,{type:"file_manager",requestData:s,fnList:e.fnList,configFile:c,canUpload:e.canUpload})})}var M=function(e){e.fieldName;var t=e.extra,n=e.row,o=t||{},r=e.more,i=!1;if("boolean"===typeof o.CanEdit&&(i=o.CanEdit),1==i)if(null==r.fCanEdit&&null!=r.canEditF&&(r.fCanEdit=r.canEditF),"boolean"===typeof r.fCanEdit)i=r.fCanEdit;else if("string"===typeof r.fCanEdit&&r.fCanEdit.length>0)if(null!=n[r.fCanEdit])i=n[r.fCanEdit];else if(r.fCanEdit.indexOf(",")>-1){var l=r.fCanEdit.split(",");if(l&&l.length>0){var c,s=Object(a.a)(l);try{for(s.s();!(c=s.n()).done;){if(0==n[c.value]){i=!1;break}}}catch(b){s.e(b)}finally{s.f()}}}if(null!=r.lockF||null!=r.fLock){var f=r.lockF||r.fLock;if("boolean"==typeof f)i=!f;else if("string"==typeof f&&f.length>0)if(null!=n[f])i=!n[f];else if(f.indexOf(",")>-1){var u=f.split(",");if(u&&u.length>0){var d,p=Object(a.a)(u);try{for(p.s();!(d=p.n()).done;){if(1==n[d.value]){i=!1;break}}}catch(b){p.e(b)}finally{p.f()}}}}return i};t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.props;0;var n=Object(f.useState)(0),a=Object(r.a)(n,2),c=(a[0],a[1],Object(f.useState)(null===t.cell||void 0===t.cell?"":t.cell)),g=Object(r.a)(c,2),w=g[0],y=g[1],C=t.cell,E=t.extra,S=E.fieldName,D=Object(f.useState)(!1),N=Object(r.a)(D,2),U=N[0],L=N[1],P=Object(f.useState)(!1),A=Object(r.a)(P,2),H=A[0],k=A[1],I=u.a.useRef(new l.OneTableCell(t)),R=I.current;R.row=t.row,R.extra=E,t.custom&&!0!==R._updateCustom&&(R.more=Object(i.a)(Object(i.a)({},t.custom.more),R.more),R._updateCustom=!0);var B=R.row,G=u.a.useRef(j({oneTableCell:R,row:B,extra:E,cell:C})),q=G.current;null==R._onePage&&R.updateOnePage(p.j.fnGetOnePage(q));var _=R.more,W=Object(O.a)(),V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.cbWhenEqual,n=B[S];console.log("updateValueCellFromRow:",n),w!=n?y(null===n||void 0===n?"":n):(console.log("call cbWhenEqual"),t&&t())};return!0===B.IsLocked?R.canEdit=!1:null!=R.canEdit&&!0!==R.canEdit&&!1!==R.canEdit||(R.canEdit=M({extra:R.extra,more:_,row:B})),u.a.useEffect((function(){"string"===typeof t.cell||"number"===typeof t.cell||"boolean"===typeof t.cell?t.cell!=w&&y(t.cell):y(t.cell)}),[t.cell]),{forceUpdate:W,fnList:q,updateValueCellFromRow:V,oneTableCell:R,extra:R.extra,row:R.row,fieldName:R.fieldName,more:R.more,moreObj:R.more,canEdit:R.canEdit,updateFieldData:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.warn("updateFieldData:",e,R),e==C||null==C&&""==e?(console.warn("not update:",e,C,n),n&&n.cbError&&n.cbError({msg:"Nothing to change"})):(L(!0),l.HUtils.runFuntion(R.fnList,x,[Object(i.a)(Object(i.a)({},n),{},{apiController:p.j.fnGetApiPath(q),fieldName:n.fieldName||R.fieldName,row:R.row,newValue:e,cbSuccess:function(e){console.warn("cbss",e),L(!1),p.j.fnForceUpdateTable(q,[]),n&&n.cbSuccess&&n.cbSuccess(e),t.fnList&&t.fnList.cbSuccessUpdate&&t.fnList.cbSuccessUpdate()},cbError:function(t){console.warn("cber",t),L(!1),n&&n.cbError&&n.cbError(e)}})]))},requestCustom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("requestCustom:",e),l.HUtils.runFuntion(R.fnList,F,[Object(i.a)({},e)])},getSharedConfig:function(){return{}},getMoreAttrsFromCustomConfig:function(){return l.MyTableCellHelpers.ConfigByTypes&&l.MyTableCellHelpers.ConfigByTypes[R.type]&&l.MyTableCellHelpers.ConfigByTypes[R.type].moreAttrs?l.MyTableCellHelpers.ConfigByTypes[R.type].moreAttrs:{}},getMorePropsButton:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.defaultStyle,n={},o=t||{};return H&&(n.disabled=!0),_&&_.button&&_.button.style&&(o=Object(i.a)(Object(i.a)({},o),_.button.style)),o&&Object.keys(o).length>0&&(n.style=o),n},renderHide:function(){return Object(v.jsx)("div",{className:"disabled"})},isUpdating:U,setIsUpdating:function(e){L(e)},isFetching:H,setIsFetching:k,valueCell:w,setValueCell:y,classNameWrap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s()(e,Object(i.a)({disabled:!1===R.canEdit,"a-scrwhhover":null!=_.scrwhhover?_.scrwhhover:n.scrwhhover||!1,"styled-mini":_.styledMini},null!=t.custom&&null!=t.custom.className?Object(o.a)({},t.custom.className,!0):{}))},styleWrap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return m.a.Cell_GetStyleCell({extra:E,more:_,row:B,defaultStyle:e,overideStyle:t})},onUpdateRow:function(e){l.HUtils.runFuntion(R.fnList,"onUpdateRow",[{row:B,newRow:e}])},getTextDisplaySelect:function(){var e="";if(_.fDisplay&&B[_.fDisplay]?e=B[_.fDisplay]:_.fShow&&B[_.fShow]&&(e=B[_.fShow]),""==e&&null!=w&&""!==w){var t=q.fnGetSourceData(),n=l.HOptions.getTextDisplayOfValueFromOptions(t,w);n&&(e=n)}return""==e&&(e=w||""),e},renderTopRight:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(v.jsx)(l.MyTableCell,Object(i.a)(Object(i.a)({},t),{},{fnList:q,more:_,oneTableCell:R,type:"_barTopRight",moreBtns:e,moreConfig:n}))},renderLoadingOverlay:function(){return Object(v.jsx)("div",{className:"a-overlay-center",children:Object(v.jsx)(l.MyLoading,{type:"threedotsvertical",size:12})})},onClickForm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.customMore,n=e.cbSuccess,o=e.customShowForm,r=t||_;console.warn("onClickForm:",r),k(!0),Object(h.FlowCheckApiShowModal)({extra:E,row:B,more:_,fnList:q,cb:function(e){var t=e.canShow;e.config;if(t){var a=R.getConfigForm({customMore:r}),c=B;if(r.fDefaultValues&&(c=B[r.fDefaultValues]?B[r.fDefaultValues]:{}),a){var s=l.MyFormControlHelpers.getConfigFormFromConfigV1(a,{defaultValues:c,fnList:Object(i.a)(Object(i.a)({},q),{},{onSubmitForm:function(e,t){var o=t.myForm;console.warn("onSubmitForm:",e);var a=R.getConfigApi({customMore:r});return new Promise((function(t,r){a?(a.query=Object.assign(a.query,e),Object(b.a)(a).then((function(e){console.warn("onClickBtn API rs",e),Object(h.FlowParseResponseAndNeedReload)({extra:E,row:B,fieldName:S,more:_,oneTableCell:R,response:e}),o.closeMyModal&&o.closeMyModal(),n&&n(e),t(e)})).catch((function(e){r(e)}))):(console.warn("Missing configApi"),r("Missing configApi"))}))}})}),f=R.getConfigModal({customMore:r});o?o(s,Object(i.a)({},f)):d.f.showFromMyForm(s,Object(i.a)({},f))}else console.error("Missing configForm:",a)}k(!1)}})},onClickApi:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.customMore,n=(e.cbSuccess,e.cbError),o=e.cbBeforeRequest,r=e.cbAfterRequest,a=t||_;console.warn("onClickApi:",a);var i=R.getConfigApi({customMore:a});a.confirmMsg?d.f.showConfirm({title:a.titleConfirm||"Confirm",msg:a.confirmMsg,onClickOK:function(e){i?(o&&o(),Object(b.a)(i).then((function(e){console.warn("onClickBtn API rs",e),Object(h.FlowParseResponseAndNeedReload)({extra:E,row:B,fieldName:S,more:a,oneTableCell:R,response:e})})).finally((function(){r&&r()}))):console.warn("Missing configApi"),e&&e.hide&&e.hide()}}):i?(o&&o(),Object(b.a)(i).then((function(e){console.warn("onClickBtn API rs",e),Object(h.FlowParseResponseAndNeedReload)({extra:E,row:B,fieldName:S,more:a,oneTableCell:R,response:e})})).finally((function(){r&&r()}))):(console.warn("Missing configApi"),n&&n())},onClickFiles:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.ctc,n=e.customMore,o=e.canUpload,r=n||_;console.warn("onClickFiles:",r),d.f.showFromComponent((function(e){return Object(v.jsx)(T,Object(i.a)(Object(i.a)({},e),{},{more:r,canUpload:o,ctc:t}))}),{title:"Modal",backdrop:"static",size:"xl",showHeader:!1,fnList:{updateCell:function(e,t){console.warn("Updatecell:",e,t)},fnGetApiPath:function(){return p.j.fnGetApiPath(q)},onChangeData:function(e){console.warn("onChangeData:",e,C),e&&C?e.Id===C.Id||C.hasOwnProperty&&e.hasOwnProperty&&C.hasOwnProperty("Photos")&&e.hasOwnProperty("Photos")?(l.HUtils.mergeObjIfExist(B[S],e),l.HUtils.runFuntion(R.fnList,"onUpdateRow",[{row:B,newRow:B}]),W()):console.warn("Update data row, wrong ID",e,C):console.warn("Update data row, wrong data",e,C)}}})}}}},511:function(e,t,n){"use strict";var o=n(52);t.a=o.apiWithConfigApi}}]);
//# sourceMappingURL=122.cc525a64.chunk.js.map