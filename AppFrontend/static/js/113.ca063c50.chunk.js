(this["webpackJsonpapp-admin-v5"]=this["webpackJsonpapp-admin-v5"]||[]).push([[113],{1223:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return y}));var o,l,r=n(4),a=n(22),i=n(1),c=n(0),s=n(87),f=n(11),u=n(20),d=n(510),p=n(6),b=n(9),m=n(25),g=n(2),h=u.b.div(o||(o=Object(a.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  & button {\n    white-space: nowrap;\n    text-overflow: ellipsis;\n    overflow: hidden;\n    word-break: break-all;\n    width: 100%;\n    border: 0px;\n    padding: 5px 2px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 1.5rem;\n    height: 36px;\n  }\n"]))),w=u.b.div(l||(l=Object(a.a)(["\n  & textarea {\n    width: 100%;\n    border: 1px solid #e8e9ea;\n    border-radius: 4px;\n    outline: none;\n    &:focus {\n      outline: none !important;\n      border-color: #719ece;\n      box-shadow: 0 0 2px #0072ff;\n    }\n  }\n"])));function C(e){var t=e.ctc,n=e.row,o=e.title,l=e.msg,r=e.msgHtml,a=e.deleteWithNote,s=(e.updateNote,Object(c.useRef)("")),f=l;r&&(f=Object(g.jsx)(i.MyUI,{type:"html",html:r,data:n}));var u=f;return a&&(u=Object(g.jsxs)(w,{children:[f,Object(g.jsx)(i.MyBase,{type:"textarea",onChange:function(e){s.current=e},attrs:{rows:3,autoFocus:!0,placeholder:"Note"}})]})),Object(g.jsx)("div",{style:{width:"250px",maxHeight:"300px",maxWidth:"300px"},children:Object(g.jsx)(i.MyUI,{type:"msgbox_confirm",styleBody:{whiteSpace:"pre-wrap"},title:o,msg:u,colorOK:"danger",onOK:function(){console.warn("onOK",e);var o={};s.current&&(o.Note=s.current),i.HUtils.runFuntion(t.oneTableCell.fnList,"fnRequestDelete",[{row:n,moreQuery:o,cbSuccess:function(){i.HUtils.runFuntion(t.oneTableCell.fnList,"fnDeleteItem",[n])}}]),e.hide&&e.hide()},onCancel:function(){console.warn("onCancel"),e.hide&&e.hide()}})})}function y(e){var t=e.row,n=Object(d.a)({props:e}),o=n.moreObj;if(null==n.oneTableCell._cellDelete){var l={canDelete:!0,title:b.j.fnGetConfigPageTable(n.fnList,[p.g.deleteTitle,m.a.t("Delete")]),msg:b.j.fnGetConfigPageTable(n.fnList,[p.g.deleteContent,m.a.t("Are you sure you want to delete")]),msgHtml:b.j.fnGetConfigPageTable(n.fnList,[p.g.deleteContentHtml,null]),deleteWithNote:b.j.fnGetConfigPageTable(n.fnList,[p.g.deleteWithNote,null]),fCanDeleteFromTableConfig:b.j.fnGetConfigPageTable(n.fnList,[p.g.fDelete,null]),fCanDeleteFromMore:o.fDelete};n.oneTableCell._cellDelete=l}var a=n.oneTableCell._cellDelete||{},c=a.title,u=a.msg,w=a.msgHtml,y=a.deleteWithNote,j=a.canDelete,v=a.fCanDeleteFromMore,O=a.fCanDeleteFromTableConfig;return t.IsLocked&&(j=!1),j&&O&&!1===t[O]&&(j=!1),j&&v&&!1===t[v]&&(j=!1),c.indexOf("[")>-1&&(c=i.HUtils.getTextWithData(c,t)),u.indexOf("[")>-1&&(u=i.HUtils.getTextWithData(u,t)),Object(g.jsx)(h,{className:"mtc-api",children:!0===j&&Object(g.jsx)(f.i,{overlay:function(t){return Object(g.jsx)(C,Object(r.a)(Object(r.a)(Object(r.a)({ctc:n},e),t),{},{title:c,msg:u,msgHtml:w,deleteWithNote:y}))},overlayClassName:"m-popover",placement:"topRight",destroyTooltipOnHide:!0,children:Object(g.jsx)(s.a,{title:c,color:"danger",outline:!0,onClick:function(){console.warn("onDelete")},children:Object(g.jsx)("i",{className:"fa fa-trash"})})})})}},510:function(e,t,n){"use strict";var o=n(32),l=n(13),r=n(31),a=n(4),i=n(1),c=n(57),s=n.n(c),f=n(0),u=n.n(f),d=n(11),p=n(9),b=n(511),m=n(155),g=n(157),h=n(79),w=n(2),C="fnGetScreenCode",y=function(e){var t=e.oneTableCell,n=Object(a.a)({},t.fnList);return n[p.O]=function(){var e=t.row,o=t.extra,l=t.extra.Type.source,r=p.j.getSourceList(n);if(g.e(l))return g.b(r,l,e,o.Type.sourceField);if(l&&l.startsWith("["))return i.HJson.getObj(l);if(l&&l.startsWith("f")){var a=l.slice(1,l.length);return null!=e[a]&&Array.isArray(e[a])?e[a]:null!=e[l]&&Array.isArray(e[l])?e[l]:[]}return r[l]||[]},n[p.T]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.customMore,o=e.count,l=e.tooltip,r=t.row,a=t.more;return v.renderBadge({more:n||a,row:r,count:o,tooltip:l})},n[p.H]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.customTitle;return m.a.Cell_GetHeaderTitle({extra:t.extra,customTitle:n})},n[p.u]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0,o=t.more,l=n;return o&&o.hasOwnProperty(e)&&(l=o[e]),l},n[p.v]=function(){var e=t.row,n=t.extra,o=t.more;return m.a.Cell_GetConfigModal({extra:n,more:o,row:e})},n[p.I]=function(){var e=t.row,n=t.extra,o=t.more,l=t.getValue();if(!1===Object(h.FlowGetCanShow)({extra:n,row:e,more:o}))return!0;return!(!o[h.KMore.hideWhenEmpty]||""!==l&&null!=l&&0!==l)||(!(!o[h.KMore.hideWhenNull]||null!=l)||!!(i.MyTableCellHelpers.ConfigByTypes&&i.MyTableCellHelpers.ConfigByTypes[t.type]&&i.MyTableCellHelpers.ConfigByTypes[t.type].isHide&&i.MyTableCellHelpers.ConfigByTypes[t.type].isHide(t)))},n.onSendMsg=function(e){console.error("missing onSendMsg, need update fnList",e)},n.onReExpand=function(){var e=t.row;i.HUtils.runFuntion(e,"_fnForceUpdateDetail")},t.fnList=n,n},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return i.HUtils.runFuntion(e.fnList,C,t)},v={renderBadge:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.more,n=void 0===t?{}:t,o=e.row,l=void 0===o?{}:o,r=e.count,a=e.tooltip,c=n.configBadge||n.badge;if(null!=r||c&&!0===c.show){var s=r,f=a;if(c&&c.fCount&&null!=l[c.fCount]&&(s=l[c.fCount]),s)return c&&c.fTooltip&&l[c.fTooltip]&&(f=l[c.fTooltip]),f?Object(w.jsx)(d.k,{overlay:Object(w.jsx)(i.MyUI,{type:"html",html:f}),children:Object(w.jsx)("span",{className:"mct-ui-badge",children:s})}):Object(w.jsx)("span",{className:"mct-ui-badge",children:s})}}},O=n(156),x="fnRequestUpdate",T="fnRequestCustom";function F(e){var t=e.ctc,n=e.more,o=t.row.Id,l=j(t),r={};n&&(n.fID&&t.row[n.fID]&&(o=t.row[n.fID]),r=n.configFile||n.file||{});var c=Object(a.a)({needRequestPhotos:!0,pasteAsFile:!0,showUploadFromGGDrive:!1},r),s={ScreenCode:l,ProjectId:"",Id:o,FieldName:t.fieldName};return Object(w.jsx)("div",{children:Object(w.jsx)(i.MyUI,{type:"file_manager",requestData:s,fnList:e.fnList,configFile:c,canUpload:e.canUpload})})}var M=function(e){e.fieldName;var t=e.extra,n=e.row,o=t||{},l=e.more,a=!1;if("boolean"===typeof o.CanEdit&&(a=o.CanEdit),1==a)if(null==l.fCanEdit&&null!=l.canEditF&&(l.fCanEdit=l.canEditF),"boolean"===typeof l.fCanEdit)a=l.fCanEdit;else if("string"===typeof l.fCanEdit&&l.fCanEdit.length>0)if(null!=n[l.fCanEdit])a=n[l.fCanEdit];else if(l.fCanEdit.indexOf(",")>-1){var i=l.fCanEdit.split(",");if(i&&i.length>0){var c,s=Object(r.a)(i);try{for(s.s();!(c=s.n()).done;){if(0==n[c.value]){a=!1;break}}}catch(b){s.e(b)}finally{s.f()}}}if(null!=l.lockF||null!=l.fLock){var f=l.lockF||l.fLock;if("boolean"==typeof f)a=!f;else if("string"==typeof f&&f.length>0)if(null!=n[f])a=!n[f];else if(f.indexOf(",")>-1){var u=f.split(",");if(u&&u.length>0){var d,p=Object(r.a)(u);try{for(p.s();!(d=p.n()).done;){if(1==n[d.value]){a=!1;break}}}catch(b){p.e(b)}finally{p.f()}}}}return a};t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.props;0;var n=Object(f.useState)(0),r=Object(l.a)(n,2),c=(r[0],r[1],Object(f.useState)(null===t.cell||void 0===t.cell?"":t.cell)),g=Object(l.a)(c,2),C=g[0],j=g[1],v=t.cell,D=t.extra,H=D.fieldName,N=Object(f.useState)(!1),E=Object(l.a)(N,2),S=E[0],U=E[1],L=Object(f.useState)(!1),A=Object(l.a)(L,2),P=A[0],k=A[1],R=u.a.useRef(new i.OneTableCell(t)),I=R.current;I.row=t.row,I.extra=D,t.custom&&!0!==I._updateCustom&&(I.more=Object(a.a)(Object(a.a)({},t.custom.more),I.more),I._updateCustom=!0);var B=I.row,G=u.a.useRef(y({oneTableCell:I,row:B,extra:D,cell:v})),W=G.current;null==I._onePage&&I.updateOnePage(p.j.fnGetOnePage(W));var q=I.more,_=Object(O.a)(),V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.cbWhenEqual,n=B[H];console.log("updateValueCellFromRow:",n),C!=n?j(null===n||void 0===n?"":n):(console.log("call cbWhenEqual"),t&&t())};return!0===B.IsLocked?I.canEdit=!1:null!=I.canEdit&&!0!==I.canEdit&&!1!==I.canEdit||(I.canEdit=M({extra:I.extra,more:q,row:B})),u.a.useEffect((function(){"string"===typeof t.cell||"number"===typeof t.cell||"boolean"===typeof t.cell?t.cell!=C&&j(t.cell):j(t.cell)}),[t.cell]),{forceUpdate:_,fnList:W,updateValueCellFromRow:V,oneTableCell:I,extra:I.extra,row:I.row,fieldName:I.fieldName,more:I.more,moreObj:I.more,canEdit:I.canEdit,updateFieldData:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.warn("updateFieldData:",e,I),e==v||null==v&&""==e?(console.warn("not update:",e,v,n),n&&n.cbError&&n.cbError({msg:"Nothing to change"})):(U(!0),i.HUtils.runFuntion(I.fnList,x,[Object(a.a)(Object(a.a)({},n),{},{apiController:p.j.fnGetApiPath(W),fieldName:n.fieldName||I.fieldName,row:I.row,newValue:e,cbSuccess:function(e){console.warn("cbss",e),U(!1),p.j.fnForceUpdateTable(W,[]),n&&n.cbSuccess&&n.cbSuccess(e),t.fnList&&t.fnList.cbSuccessUpdate&&t.fnList.cbSuccessUpdate()},cbError:function(t){console.warn("cber",t),U(!1),n&&n.cbError&&n.cbError(e)}})]))},requestCustom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("requestCustom:",e),i.HUtils.runFuntion(I.fnList,T,[Object(a.a)({},e)])},getSharedConfig:function(){return{}},getMoreAttrsFromCustomConfig:function(){return i.MyTableCellHelpers.ConfigByTypes&&i.MyTableCellHelpers.ConfigByTypes[I.type]&&i.MyTableCellHelpers.ConfigByTypes[I.type].moreAttrs?i.MyTableCellHelpers.ConfigByTypes[I.type].moreAttrs:{}},getMorePropsButton:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.defaultStyle,n={},o=t||{};return P&&(n.disabled=!0),q&&q.button&&q.button.style&&(o=Object(a.a)(Object(a.a)({},o),q.button.style)),o&&Object.keys(o).length>0&&(n.style=o),n},renderHide:function(){return Object(w.jsx)("div",{className:"disabled"})},isUpdating:S,setIsUpdating:function(e){U(e)},isFetching:P,setIsFetching:k,valueCell:C,setValueCell:j,classNameWrap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s()(e,Object(a.a)({disabled:!1===I.canEdit,"a-scrwhhover":null!=q.scrwhhover?q.scrwhhover:n.scrwhhover||!1,"styled-mini":q.styledMini},null!=t.custom&&null!=t.custom.className?Object(o.a)({},t.custom.className,!0):{}))},styleWrap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return m.a.Cell_GetStyleCell({extra:D,more:q,row:B,defaultStyle:e,overideStyle:t})},onUpdateRow:function(e){i.HUtils.runFuntion(I.fnList,"onUpdateRow",[{row:B,newRow:e}])},getTextDisplaySelect:function(){var e="";if(q.fDisplay&&B[q.fDisplay]?e=B[q.fDisplay]:q.fShow&&B[q.fShow]&&(e=B[q.fShow]),""==e&&null!=C&&""!==C){var t=W.fnGetSourceData(),n=i.HOptions.getTextDisplayOfValueFromOptions(t,C);n&&(e=n)}return""==e&&(e=C||""),e},renderTopRight:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(w.jsx)(i.MyTableCell,Object(a.a)(Object(a.a)({},t),{},{fnList:W,more:q,oneTableCell:I,type:"_barTopRight",moreBtns:e,moreConfig:n}))},renderLoadingOverlay:function(){return Object(w.jsx)("div",{className:"a-overlay-center",children:Object(w.jsx)(i.MyLoading,{type:"threedotsvertical",size:12})})},onClickForm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.customMore,n=e.cbSuccess,o=e.customShowForm,l=t||q;console.warn("onClickForm:",l),k(!0),Object(h.FlowCheckApiShowModal)({extra:D,row:B,more:q,fnList:W,cb:function(e){var t=e.canShow;e.config;if(t){var r=I.getConfigForm({customMore:l}),c=B;if(l.fDefaultValues&&(c=B[l.fDefaultValues]?B[l.fDefaultValues]:{}),r){var s=i.MyFormControlHelpers.getConfigFormFromConfigV1(r,{defaultValues:c,fnList:Object(a.a)(Object(a.a)({},W),{},{onSubmitForm:function(e,t){var o=t.myForm;console.warn("onSubmitForm:",e);var r=I.getConfigApi({customMore:l});return new Promise((function(t,l){r?(r.query=Object.assign(r.query,e),Object(b.a)(r).then((function(e){console.warn("onClickBtn API rs",e),Object(h.FlowParseResponseAndNeedReload)({extra:D,row:B,fieldName:H,more:q,oneTableCell:I,response:e}),o.closeMyModal&&o.closeMyModal(),n&&n(e),t(e)})).catch((function(e){l(e)}))):(console.warn("Missing configApi"),l("Missing configApi"))}))}})}),f=I.getConfigModal({customMore:l});o?o(s,Object(a.a)({},f)):d.f.showFromMyForm(s,Object(a.a)({},f))}else console.error("Missing configForm:",r)}k(!1)}})},onClickApi:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.customMore,n=(e.cbSuccess,e.cbError),o=e.cbBeforeRequest,l=e.cbAfterRequest,r=t||q;console.warn("onClickApi:",r);var a=I.getConfigApi({customMore:r});r.confirmMsg?d.f.showConfirm({title:r.titleConfirm||"Confirm",msg:r.confirmMsg,onClickOK:function(e){a?(o&&o(),Object(b.a)(a).then((function(e){console.warn("onClickBtn API rs",e),Object(h.FlowParseResponseAndNeedReload)({extra:D,row:B,fieldName:H,more:r,oneTableCell:I,response:e})})).finally((function(){l&&l()}))):console.warn("Missing configApi"),e&&e.hide&&e.hide()}}):a?(o&&o(),Object(b.a)(a).then((function(e){console.warn("onClickBtn API rs",e),Object(h.FlowParseResponseAndNeedReload)({extra:D,row:B,fieldName:H,more:r,oneTableCell:I,response:e})})).finally((function(){l&&l()}))):(console.warn("Missing configApi"),n&&n())},onClickFiles:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.ctc,n=e.customMore,o=e.canUpload,l=n||q;console.warn("onClickFiles:",l),d.f.showFromComponent((function(e){return Object(w.jsx)(F,Object(a.a)(Object(a.a)({},e),{},{more:l,canUpload:o,ctc:t}))}),{title:"Modal",backdrop:"static",size:"xl",showHeader:!1,fnList:{updateCell:function(e,t){console.warn("Updatecell:",e,t)},fnGetApiPath:function(){return p.j.fnGetApiPath(W)},onChangeData:function(e){console.warn("onChangeData:",e,v),e&&v?e.Id===v.Id||v.hasOwnProperty&&e.hasOwnProperty&&v.hasOwnProperty("Photos")&&e.hasOwnProperty("Photos")?(i.HUtils.mergeObjIfExist(B[H],e),i.HUtils.runFuntion(I.fnList,"onUpdateRow",[{row:B,newRow:B}]),_()):console.warn("Update data row, wrong ID",e,v):console.warn("Update data row, wrong data",e,v)}}})}}}},511:function(e,t,n){"use strict";var o=n(52);t.a=o.apiWithConfigApi}}]);
//# sourceMappingURL=113.ca063c50.chunk.js.map