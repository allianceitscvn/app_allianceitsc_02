(this["webpackJsonpapp-admin-v5"]=this["webpackJsonpapp-admin-v5"]||[]).push([[51,119],{1338:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return te}));var o,i=t(61),a=t(4),r=t(13),l=t(22),c=t(0),s=t.n(c),d=t(1),f=t(510),u=t(20),b=t(11),h=t(79),p=t(9),j=t(703),m=t(87),g=t(35),x=t(2),v=u.b.div(o||(o=Object(l.a)(["\n  & .rdw-editor-main {\n    border: 1px solid #f1f1f1;\n    min-height: 100px;\n    max-height: 300px;\n    padding: 0px 5px;\n  }\n  & .a-mode-textarea textarea {\n    // border: 1px solid rgb(233, 236, 239);\n    // border-radius: 4px;\n    width: 100%;\n    min-height: 50vh;\n    outline: none;\n    border: 1px solid #e9ecef;\n  }\n  & .a-mode-preview {\n    max-height: calc(100vh - 10rem);\n    overflow: auto;\n  }\n"]))),O="textarea";var w,y=function(e){var n=e.valueCell,t=e.fnList,o=e.onSave,i=e.canEdit,l=e.title,c=s.a.useState(n||""),f=Object(r.a)(c,2),u=f[0],h=f[1],j=s.a.useState(O),w=Object(r.a)(j,2),y=w[0],C=(w[1],s.a.useState(!1)),M=Object(r.a)(C,2),k=M[0],F=M[1];return Object(x.jsxs)(v,{style:{maxHeight:"calc(100vh - 5rem)"},children:[b.f.renderHeader({cModal:e.inMyModal,hideClose:!0,title:function(e){return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{className:"btn-group",children:l}),Object(x.jsx)("div",{className:"btn-group",style:{position:"absolute",right:"1rem"},children:!0===i&&Object(x.jsx)(m.a,{disabled:k,onClick:function(){o?o(u,{fnList:Object(a.a)(Object(a.a)({},t),{},{changeLoading:function(e){F(e)}})}):d.HUtils.runFuntion(t,"updateCell",[u,{cbSuccess:function(e){console.warn("cbSuccess:",e),F(!1),p.g.hideModal(t)},cbError:function(e){console.warn("cbErrro:",e),e.msg&&g.showToastWarning(e.msg),F(!1)}}])},color:"success",children:"Save"})})]})}}),Object(x.jsx)("div",{children:y===O&&Object(x.jsx)("div",{className:"a-mode-textarea",children:Object(x.jsx)(d.MyBase,{type:"textarea",value:u,onChange:function(e){h(e)},attrs:{disabled:!0!==i}})})})]})},C={textarea:y,textarea_full:y},M=u.b.button(w||(w=Object(l.a)(["\n  background: #fdcd55;\n  border: 0px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: black;\n"]))),k=function(e){e.row;var n=e.cell,t=e.moreConfig||{},o=e.more||{},i=t.configEditInModal||o.configEditInModal||{},r=t.ctc||{},l=C.textarea,c=i.fieldName||r.fieldName||t.customFieldName;return Object(x.jsx)(M,{className:"a-shwhhover",title:i.titleTooltip||"Extent in window",onClick:function(){console.warn("show:",c),l&&b.f.showFromComponent((function(e){return Object(x.jsx)(l,Object(a.a)(Object(a.a)({},e),{},{canEdit:r.canEdit,title:p.k.fnGetHeaderTitle(r.fnList),onSave:function(e,n){var t=n.fnList;console.warn("onsave:",e,t),r.updateFieldData(e,{fieldName:c}),p.g.hideModal(t)},valueCell:n}))}),{showHeader:!1,backdrop:"static",showChangeSize:!0,showMiniClose:!0,fnList:{}})},children:Object(x.jsx)("i",{className:"fa fa-window-restore"})})};k.canShow=function(e){var n=e.moreConfig||{},t=e.more||{};return!0===(n.configEditInModal||t.configEditInModal||{}).show};var F,N,E=k,S=t(768);u.b.div(F||(F=Object(l.a)(["\n  cursor: pointer;\n  padding: 2px;\n  & > div {\n    max-height: 100px;\n    overflow: auto;\n    & p {\n      // display: initial;\n      // vertical-align: text-top;\n      margin-bottom: 0px;\n      margin-block-start: 0px;\n      margin-block-end: 0;\n      line-height: 1rem;\n      text-indent: 0px;\n    }\n    & br {\n      display: initial;\n      vertical-align: text-top;\n    }\n  }\n"]))),u.b.div(N||(N=Object(l.a)(["\n  & .rdw-editor-main {\n    border: 1px solid #f1f1f1;\n    min-height: 100px;\n    max-height: 300px;\n    padding: 0px 5px;\n  }\n  & .a-mode-textarea textarea {\n    // border: 1px solid rgb(233, 236, 239);\n    // border-radius: 4px;\n    width: 100%;\n    min-height: 50vh;\n    outline: none;\n    border: 1px solid #e9ecef;\n  }\n"])));var T,L,H,D,U,I,P,A=u.b.div(T||(T=Object(l.a)(["\n  position: absolute;\n  top: 8px;\n  right: 4px;\n  font-size: 18px;\n  border-radius: 4px;\n  line-height: 15px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  & button {\n    border-radius: 4px;\n  }\n  padding: 0px;\n  &:hover .a-shwhhover {\n    display: block;\n  }\n  & .a-shwhhover {\n    display: none;\n  }\n"]))),R=u.b.button(L||(L=Object(l.a)(["\n  background: #fdcd55;\n  border: 0px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: black;\n"]))),V=u.b.button(H||(H=Object(l.a)(["\n  padding: 0;\n  background: inherit;\n  border: 0px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: black;\n  & .mct-ui-badge {\n    transform: translate(25%, -25%);\n  }\n"]))),K=u.b.button(D||(D=Object(l.a)(["\n  background: transparent;\n  border: 0px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: var(--danger);\n  padding: 0px 2px;\n"]))),B=u.b.div(U||(U=Object(l.a)(["\n  border: 1px solid #e9ecef;\n  & pre {\n    word-break: break-word;\n  }\n"]))),G=u.b.div(I||(I=Object(l.a)(["\n  position: sticky;\n  display: flex;\n  top: 0;\n  height: 0px;\n  align-items: center;\n  justify-content: flex-end;\n  > div {\n    background: white;\n    padding: 2px 2px;\n    border: 1px solid #ddd;\n  }\n"]))),W=u.b.button(P||(P=Object(l.a)(["\n  background: transparent;\n  border: 0px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: #000;\n  padding: 0px 2px;\n"]))),_=function(e){var n=Object(c.useState)([]),t=Object(r.a)(n,2),o=t[0],i=t[1],l=Object(c.useState)(0),s=Object(r.a)(l,2),f=s[0],u=s[1],b=null;e.fnList&&e.fnList.fnGetData&&(b=e.fnList.fnGetData()),console.warn("render ModalDiffViewer",b),Object(c.useEffect)((function(){var e=document.querySelectorAll('tr>td[class*="diff-removed"]:first-child,tr>td[class*="diff-add"]:first-child');console.warn("count selector:",e),e&&e.length>0&&i(e)}),[]);var h=o.length;return b&&b.oldValue&&b.newValue?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(G,{children:Object(x.jsx)("div",{children:h>0&&Object(x.jsxs)("div",{children:[Object(x.jsx)("button",{disabled:f<=1,onClick:function(){var e=f;u(e-1),o&&o.length>e-2&&o[e-2].scrollIntoView()},children:"<"}),f>0?Object(x.jsx)("span",{children:"".concat(f," of ").concat(h)}):Object(x.jsx)("span",{children:"Total: ".concat(h)}),Object(x.jsx)("button",{disabled:f>=h,onClick:function(){var e=f;u(e+1),o&&o.length>e&&o[e].scrollIntoView()},children:">"})]})})}),Object(x.jsx)(B,{children:Object(x.jsx)(d.MyLib,Object(a.a)({type:"diff_viewer"},b))})]}):Object(x.jsx)("div",{children:"No data!"})},q=function(e){var n=e.row||{},t=e.configDiffView||{};return Object(x.jsx)(R,{onClick:function(){b.f.showFromComponent((function(e){return Object(x.jsx)(_,Object(a.a)({},e))}),{title:"Diff Viewer",size:"xl",modalScrollInside:!0,fnList:{fnGetData:function(){if(t&&t.fields&&t.fields.length>0){var e=n[t.fields[0]],o=n[t.fields[1]];if(e&&"{"==e[0]&&o&&"{"==o[0])try{e=JSON.parse(e),e=JSON.stringify(e,null,2),o=JSON.parse(o),o=JSON.stringify(o,null,2)}catch(i){console.warn("Parse json error!")}return Object(a.a)({oldValue:e,newValue:o,showDiffOnly:!1},t.props)}}}})},children:Object(x.jsx)("i",{className:"fa fa-window-restore"})})},z=function(e){var n=s.a.useRef(null);return Object(x.jsxs)("div",{children:[Object(x.jsx)("div",{style:{marginBottom:"4px"},children:Object(x.jsx)("input",{ref:n,className:"form-control",type:"text",defaultValue:e.cell||""})}),Object(x.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end"},children:Object(x.jsx)("button",{className:"btn btn-primary",onClick:function(){n.current&&(console.log("value:",n.current.value),e.ctc&&e.ctc.updateFieldData&&e.ctc.updateFieldData(n.current.value)),e.hide&&e.hide()},children:"Save"})})]})},J=function(e){var n=e.row||{},t=e.cell||"",o=e.ctc||null,i=e.config||{};return"html"==e.type?Object(x.jsx)(R,{onClick:function(){console.log("hi"),b.f.showFromComponent((function(e){return Object(x.jsx)(S.ModalHtmlEditor,Object(a.a)(Object(a.a)({},e),{},{htmlEditorLib:i.htmlEditorLib,onChange:function(n){console.warn("onChange:",n,n.Value,o.valueCell),d.HUtils.runFuntion(o,"updateFieldData",[n.Value===o.valueCell?"":n.Value,{}]),d.HUtils.runFuntion(e.fnList,"hideModal",[])},ctc:o,valueCell:o.valueCell,modeToolbar:i.modeToolbar,moreProps:i.morePropsHtmlEditor}))}),{title:p.k.fnGetHeaderTitle(o.fnList),showHeader:!1,backdrop:"static",fnList:{updateCell:function(e,n){console.warn("Updatecell:",e,n),o.updateFieldData(e,n)}}})},children:Object(x.jsx)("i",{className:"fa fa-edit"})}):Object(x.jsx)(b.i,{overlay:function(e){return Object(x.jsx)(z,Object(a.a)({row:n,cell:t,ctc:o},e))},overlayClassName:"m-popover",placement:"topRight",destroyTooltipOnHide:!0,children:Object(x.jsx)(R,{children:Object(x.jsx)("i",{className:"fa fa-edit"})})})},Q=function(e){var n=e.row,t=e.fnList,o=e.more.configCheckbox,i=null===o||void 0===o?void 0:o.fieldName,r=Object(a.a)(Object(a.a)(Object(a.a)({},e.extra),t.fnGetExtraDataTable().Columns[i]),{},{fieldName:i}),l=e.row[i],c=Object(f.a)({props:Object(a.a)(Object(a.a)({},e),{},{cell:l,extra:r,fieldName:i})}),s=!n[i];return i&&n?Object(x.jsx)("div",{children:Object(x.jsx)("input",{defaultChecked:n[i],checked:n[i],type:"checkbox",onClick:function(e){c.updateFieldData(s)}})}):Object(x.jsx)("div",{})},X=function(e){var n=0,t=e.row,o=e.fnList,i=e.more.configFileIcon,r=(i.file,null===i||void 0===i?void 0:i.fieldName),l=Object(a.a)(Object(a.a)(Object(a.a)({},e.extra),o.fnGetExtraDataTable().Columns[r]),{},{fieldName:r}),c=t[r],s=Object(f.a)({props:Object(a.a)(Object(a.a)({},e),{},{cell:c,extra:l,fieldName:r})});return(null===i||void 0===i?void 0:i.showBadge)&&(!0,t[r]&&t[r].Photos&&(n=t[r].Photos.length)),r&&t?Object(x.jsxs)(V,{onClick:function(){s.onClickFiles({ctc:s,canUpload:s.canEdit})},children:[Object(x.jsx)(j.b,{size:20,color:"#6088b3"}),p.k.fnRenderBadge(s.fnList,[{count:n}])]}):Object(x.jsx)("div",{})},Y=function(e){var n=e.more||{},t=e.moreConfig||{},o="";return n[h.KMore.configClear]&&n[h.KMore.configClear].hasOwnProperty("value")&&(o=n[h.KMore.configClear].value),Object(x.jsx)(K,{className:"a-shwhhover",title:"Clear",onClick:function(){console.warn("clear",e),d.HUtils.runFuntion(t.ctc,"updateFieldData",[o])},children:Object(x.jsx)("i",{className:"fa fa-times"})})},Z=function(e){e.more;var n=e.row||{},t=e.oneTableCell||{};return Object(x.jsx)(b.i,{overlay:function(o){return Object(x.jsx)("div",{style:{width:"250px",maxHeight:"300px",maxWidth:"300px"},children:Object(x.jsx)(d.MyUI,{type:"msgbox_confirm",styleBody:{whiteSpace:"pre-wrap"},title:"Delete row",msg:"Are you sure?",colorOK:"danger",onOK:function(){console.warn("onOK",e,o);d.HUtils.runFuntion(t.fnList,"fnRequestDelete",[{row:n,moreQuery:{},cbSuccess:function(){d.HUtils.runFuntion(t.fnList,"fnDeleteItem",[n])}}]),o.hide&&o.hide()},onCancel:function(){console.warn("onCancel"),o.hide&&o.hide()}})})},overlayClassName:"m-popover",placement:"topRight",destroyTooltipOnHide:!0,children:Object(x.jsx)(K,{className:"a-shwhhover",title:"Delete row",onClick:function(){},children:Object(x.jsx)("i",{className:"fa fa-trash"})})})},$=function(e){var n=e.cell;return Object(x.jsx)(W,{className:"a-shwhhover",title:"Show HTML",onClick:function(){console.warn("showPreviewHtml",e),b.f.showFromComponent(Object(x.jsx)(d.MyUI,{type:"html",html:n}),{title:"Show Preview HTML"})},children:Object(x.jsx)("i",{className:"fa fa-eye"})})},ee=function(e){var n=e.cell;return Object(x.jsx)(W,{className:"a-shwhhover",title:"Show Preview Mobile",onClick:function(){console.warn("showPreviewMobile",e),b.f.showFromComponent(Object(x.jsx)(d.MyUI,{type:"block_mobile",data:n}),{title:"Show Preview Mobile",size:"md"})},children:Object(x.jsx)("i",{className:"fa fa-eye"})})},ne=function(e){e.cell;var n=e.row,t=e.configWarning,o="",i="#fd7e14",a="fa-exclamation-triangle";return t&&"string"==typeof t?o=t:t&&(t.fieldName&&n[t.fieldName]?o=n[t.fieldName]:t.msg&&(o=t.msg),t.color&&(i=t.color),t.icon&&(a=t.icon)),o?Object(x.jsx)(b.k,{overlay:o,placement:"top",children:Object(x.jsx)(W,{className:"",title:o,onClick:function(){},children:Object(x.jsx)("i",{style:{color:i},className:"fa ".concat(a)})})}):null};function te(e){var n=e.oneTableCell||{},t=e.moreBtns,o=e.moreConfig||{},r=o.ctc||{},l=e.more||{},s=e.row||{},d=e.cell,f=Object(i.a)(t),u=o.configDiffView||l.configDiffView;if(u&&u.show){var b=!0;if(u.showCondition)for(var p=0,j=Object.keys(u.showCondition);p<j.length;p++){var m=j[p];if(s[m]!==u.showCondition[m]){b=!1;break}}b&&f.unshift(Object(x.jsx)(q,Object(a.a)(Object(a.a)({},e),{},{configDiffView:u})))}var g=!1,v="text";if(l[h.KMore.configEditIcon]&&l[h.KMore.configEditIcon].using){if(n.canEdit&&(g=!0),1==g&&l[h.KMore.configEditIcon].showWhen)for(var O=0,w=Object.keys(l[h.KMore.configEditIcon].showWhen);O<w.length;O++){var y=w[O];s[y]!=l[h.KMore.configEditIcon].showWhen[y]&&(g=!1)}l[h.KMore.configEditIcon].type&&(v=l[h.KMore.configEditIcon].type)}g&&f.unshift(Object(c.createElement)(J,Object(a.a)(Object(a.a)({},e),{},{key:"btedit",ctc:r,type:v,config:l[h.KMore.configEditIcon]})));var C=!1;l[h.KMore.configFileIcon]&&l[h.KMore.configFileIcon].show&&(C=!0),C&&f.unshift(Object(x.jsx)(X,Object(a.a)({},e),"fileupload"));var M=!1;l[h.KMore.configCheckbox]&&l[h.KMore.configCheckbox].show&&(M=!0),M&&f.unshift(Object(x.jsx)(Q,Object(a.a)({},e),"cb"));var k=null;l[h.KMore.showPreviewHTML]&&null!=d&&""!=d&&(k=!0),k&&f.unshift(Object(x.jsx)($,Object(a.a)({},e),"previewhtml")),E.canShow&&E.canShow(e)&&f.unshift(Object(x.jsx)(E,Object(a.a)({},e),"editinmodal"));var F=null;l[h.KMore.showClear]&&null!=d&&""!=d&&(F=!0),F&&f.push(Object(x.jsx)(Y,Object(a.a)({},e),"clr"));var N=null;return l[h.KMore.showDeleteRow]&&(N=!0),N&&f.push(Object(x.jsx)(Z,Object(a.a)({},e),"dlrow")),l[h.KMore.showBlockMobile]&&f.push(Object(x.jsx)(ee,Object(a.a)({},e),"blockMobile")),l[h.KMore.configWarning]&&f.push(Object(x.jsx)(ne,Object(a.a)(Object(a.a)({},e),{},{configWarning:l[h.KMore.configWarning]}),"warning")),l[h.KMore.showTestCanEdit]&&("41940"==s.Id&&console.warn("Test can edit:",r),f.push(Object(x.jsx)("div",{children:Object(x.jsx)("i",{className:"fa fa-pencil-square",style:!0===r.canEdit?{color:"#4dbd74"}:{color:"#f64e60"}})}))),f&&f.length>0?Object(x.jsx)(A,{className:"a-topRight",children:f}):Object(x.jsx)(x.Fragment,{})}},510:function(e,n,t){"use strict";var o=t(32),i=t(13),a=t(31),r=t(4),l=t(1),c=t(57),s=t.n(c),d=t(0),f=t.n(d),u=t(11),b=t(9),h=t(511),p=t(155),j=t(157),m=t(79),g=t(2),x="fnGetScreenCode",v=function(e){var n=e.oneTableCell,t=Object(r.a)({},n.fnList);return t[b.O]=function(){var e=n.row,o=n.extra,i=n.extra.Type.source,a=b.j.getSourceList(t);if(j.e(i))return j.b(a,i,e,o.Type.sourceField);if(i&&i.startsWith("["))return l.HJson.getObj(i);if(i&&i.startsWith("f")){var r=i.slice(1,i.length);return null!=e[r]&&Array.isArray(e[r])?e[r]:null!=e[i]&&Array.isArray(e[i])?e[i]:[]}return a[i]||[]},t[b.T]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.customMore,o=e.count,i=e.tooltip,a=n.row,r=n.more;return w.renderBadge({more:t||r,row:a,count:o,tooltip:i})},t[b.H]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.customTitle;return p.a.Cell_GetHeaderTitle({extra:n.extra,customTitle:t})},t[b.u]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,o=n.more,i=t;return o&&o.hasOwnProperty(e)&&(i=o[e]),i},t[b.v]=function(){var e=n.row,t=n.extra,o=n.more;return p.a.Cell_GetConfigModal({extra:t,more:o,row:e})},t[b.I]=function(){var e=n.row,t=n.extra,o=n.more,i=n.getValue();if(!1===Object(m.FlowGetCanShow)({extra:t,row:e,more:o}))return!0;return!(!o[m.KMore.hideWhenEmpty]||""!==i&&null!=i&&0!==i)||(!(!o[m.KMore.hideWhenNull]||null!=i)||!!(l.MyTableCellHelpers.ConfigByTypes&&l.MyTableCellHelpers.ConfigByTypes[n.type]&&l.MyTableCellHelpers.ConfigByTypes[n.type].isHide&&l.MyTableCellHelpers.ConfigByTypes[n.type].isHide(n)))},t.onSendMsg=function(e){console.error("missing onSendMsg, need update fnList",e)},t.onReExpand=function(){var e=n.row;l.HUtils.runFuntion(e,"_fnForceUpdateDetail")},n.fnList=t,t},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return l.HUtils.runFuntion(e.fnList,x,n)},w={renderBadge:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.more,t=void 0===n?{}:n,o=e.row,i=void 0===o?{}:o,a=e.count,r=e.tooltip,c=t.configBadge||t.badge;if(null!=a||c&&!0===c.show){var s=a,d=r;if(c&&c.fCount&&null!=i[c.fCount]&&(s=i[c.fCount]),s)return c&&c.fTooltip&&i[c.fTooltip]&&(d=i[c.fTooltip]),d?Object(g.jsx)(u.k,{overlay:Object(g.jsx)(l.MyUI,{type:"html",html:d}),children:Object(g.jsx)("span",{className:"mct-ui-badge",children:s})}):Object(g.jsx)("span",{className:"mct-ui-badge",children:s})}}},y=t(156),C="fnRequestUpdate",M="fnRequestCustom";function k(e){var n=e.ctc,t=e.more,o=n.row.Id,i=O(n),a={};t&&(t.fID&&n.row[t.fID]&&(o=n.row[t.fID]),a=t.configFile||t.file||{});var c=Object(r.a)({needRequestPhotos:!0,pasteAsFile:!0,showUploadFromGGDrive:!1},a),s={ScreenCode:i,ProjectId:"",Id:o,FieldName:n.fieldName};return Object(g.jsx)("div",{children:Object(g.jsx)(l.MyUI,{type:"file_manager",requestData:s,fnList:e.fnList,configFile:c,canUpload:e.canUpload})})}var F=function(e){e.fieldName;var n=e.extra,t=e.row,o=n||{},i=e.more,r=!1;if("boolean"===typeof o.CanEdit&&(r=o.CanEdit),1==r)if(null==i.fCanEdit&&null!=i.canEditF&&(i.fCanEdit=i.canEditF),"boolean"===typeof i.fCanEdit)r=i.fCanEdit;else if("string"===typeof i.fCanEdit&&i.fCanEdit.length>0)if(null!=t[i.fCanEdit])r=t[i.fCanEdit];else if(i.fCanEdit.indexOf(",")>-1){var l=i.fCanEdit.split(",");if(l&&l.length>0){var c,s=Object(a.a)(l);try{for(s.s();!(c=s.n()).done;){if(0==t[c.value]){r=!1;break}}}catch(h){s.e(h)}finally{s.f()}}}if(null!=i.lockF||null!=i.fLock){var d=i.lockF||i.fLock;if("boolean"==typeof d)r=!d;else if("string"==typeof d&&d.length>0)if(null!=t[d])r=!t[d];else if(d.indexOf(",")>-1){var f=d.split(",");if(f&&f.length>0){var u,b=Object(a.a)(f);try{for(b.s();!(u=b.n()).done;){if(1==t[u.value]){r=!1;break}}}catch(h){b.e(h)}finally{b.f()}}}}return r};n.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.props;0;var t=Object(d.useState)(0),a=Object(i.a)(t,2),c=(a[0],a[1],Object(d.useState)(null===n.cell||void 0===n.cell?"":n.cell)),j=Object(i.a)(c,2),x=j[0],O=j[1],w=n.cell,N=n.extra,E=N.fieldName,S=Object(d.useState)(!1),T=Object(i.a)(S,2),L=T[0],H=T[1],D=Object(d.useState)(!1),U=Object(i.a)(D,2),I=U[0],P=U[1],A=f.a.useRef(new l.OneTableCell(n)),R=A.current;R.row=n.row,R.extra=N,n.custom&&!0!==R._updateCustom&&(R.more=Object(r.a)(Object(r.a)({},n.custom.more),R.more),R._updateCustom=!0);var V=R.row,K=f.a.useRef(v({oneTableCell:R,row:V,extra:N,cell:w})),B=K.current;null==R._onePage&&R.updateOnePage(b.j.fnGetOnePage(B));var G=R.more,W=Object(y.a)(),_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.cbWhenEqual,t=V[E];console.log("updateValueCellFromRow:",t),x!=t?O(null===t||void 0===t?"":t):(console.log("call cbWhenEqual"),n&&n())};return!0===V.IsLocked?R.canEdit=!1:null!=R.canEdit&&!0!==R.canEdit&&!1!==R.canEdit||(R.canEdit=F({extra:R.extra,more:G,row:V})),f.a.useEffect((function(){"string"===typeof n.cell||"number"===typeof n.cell||"boolean"===typeof n.cell?n.cell!=x&&O(n.cell):O(n.cell)}),[n.cell]),{forceUpdate:W,fnList:B,updateValueCellFromRow:_,oneTableCell:R,extra:R.extra,row:R.row,fieldName:R.fieldName,more:R.more,moreObj:R.more,canEdit:R.canEdit,updateFieldData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.warn("updateFieldData:",e,R),e==w||null==w&&""==e?(console.warn("not update:",e,w,t),t&&t.cbError&&t.cbError({msg:"Nothing to change"})):(H(!0),l.HUtils.runFuntion(R.fnList,C,[Object(r.a)(Object(r.a)({},t),{},{apiController:b.j.fnGetApiPath(B),fieldName:t.fieldName||R.fieldName,row:R.row,newValue:e,cbSuccess:function(e){console.warn("cbss",e),H(!1),b.j.fnForceUpdateTable(B,[]),t&&t.cbSuccess&&t.cbSuccess(e),n.fnList&&n.fnList.cbSuccessUpdate&&n.fnList.cbSuccessUpdate()},cbError:function(n){console.warn("cber",n),H(!1),t&&t.cbError&&t.cbError(e)}})]))},requestCustom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("requestCustom:",e),l.HUtils.runFuntion(R.fnList,M,[Object(r.a)({},e)])},getSharedConfig:function(){return{}},getMoreAttrsFromCustomConfig:function(){return l.MyTableCellHelpers.ConfigByTypes&&l.MyTableCellHelpers.ConfigByTypes[R.type]&&l.MyTableCellHelpers.ConfigByTypes[R.type].moreAttrs?l.MyTableCellHelpers.ConfigByTypes[R.type].moreAttrs:{}},getMorePropsButton:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.defaultStyle,t={},o=n||{};return I&&(t.disabled=!0),G&&G.button&&G.button.style&&(o=Object(r.a)(Object(r.a)({},o),G.button.style)),o&&Object.keys(o).length>0&&(t.style=o),t},renderHide:function(){return Object(g.jsx)("div",{className:"disabled"})},isUpdating:L,setIsUpdating:function(e){H(e)},isFetching:I,setIsFetching:P,valueCell:x,setValueCell:O,classNameWrap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s()(e,Object(r.a)({disabled:!1===R.canEdit,"a-scrwhhover":null!=G.scrwhhover?G.scrwhhover:t.scrwhhover||!1,"styled-mini":G.styledMini},null!=n.custom&&null!=n.custom.className?Object(o.a)({},n.custom.className,!0):{}))},styleWrap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return p.a.Cell_GetStyleCell({extra:N,more:G,row:V,defaultStyle:e,overideStyle:n})},onUpdateRow:function(e){l.HUtils.runFuntion(R.fnList,"onUpdateRow",[{row:V,newRow:e}])},getTextDisplaySelect:function(){var e="";if(G.fDisplay&&V[G.fDisplay]?e=V[G.fDisplay]:G.fShow&&V[G.fShow]&&(e=V[G.fShow]),""==e&&null!=x&&""!==x){var n=B.fnGetSourceData(),t=l.HOptions.getTextDisplayOfValueFromOptions(n,x);t&&(e=t)}return""==e&&(e=x||""),e},renderTopRight:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(g.jsx)(l.MyTableCell,Object(r.a)(Object(r.a)({},n),{},{fnList:B,more:G,oneTableCell:R,type:"_barTopRight",moreBtns:e,moreConfig:t}))},renderLoadingOverlay:function(){return Object(g.jsx)("div",{className:"a-overlay-center",children:Object(g.jsx)(l.MyLoading,{type:"threedotsvertical",size:12})})},onClickForm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.customMore,t=e.cbSuccess,o=e.customShowForm,i=n||G;console.warn("onClickForm:",i),P(!0),Object(m.FlowCheckApiShowModal)({extra:N,row:V,more:G,fnList:B,cb:function(e){var n=e.canShow;e.config;if(n){var a=R.getConfigForm({customMore:i}),c=V;if(i.fDefaultValues&&(c=V[i.fDefaultValues]?V[i.fDefaultValues]:{}),a){var s=l.MyFormControlHelpers.getConfigFormFromConfigV1(a,{defaultValues:c,fnList:Object(r.a)(Object(r.a)({},B),{},{onSubmitForm:function(e,n){var o=n.myForm;console.warn("onSubmitForm:",e);var a=R.getConfigApi({customMore:i});return new Promise((function(n,i){a?(a.query=Object.assign(a.query,e),Object(h.a)(a).then((function(e){console.warn("onClickBtn API rs",e),Object(m.FlowParseResponseAndNeedReload)({extra:N,row:V,fieldName:E,more:G,oneTableCell:R,response:e}),o.closeMyModal&&o.closeMyModal(),t&&t(e),n(e)})).catch((function(e){i(e)}))):(console.warn("Missing configApi"),i("Missing configApi"))}))}})}),d=R.getConfigModal({customMore:i});o?o(s,Object(r.a)({},d)):u.f.showFromMyForm(s,Object(r.a)({},d))}else console.error("Missing configForm:",a)}P(!1)}})},onClickApi:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.customMore,t=(e.cbSuccess,e.cbError),o=e.cbBeforeRequest,i=e.cbAfterRequest,a=n||G;console.warn("onClickApi:",a);var r=R.getConfigApi({customMore:a});a.confirmMsg?u.f.showConfirm({title:a.titleConfirm||"Confirm",msg:a.confirmMsg,onClickOK:function(e){r?(o&&o(),Object(h.a)(r).then((function(e){console.warn("onClickBtn API rs",e),Object(m.FlowParseResponseAndNeedReload)({extra:N,row:V,fieldName:E,more:a,oneTableCell:R,response:e})})).finally((function(){i&&i()}))):console.warn("Missing configApi"),e&&e.hide&&e.hide()}}):r?(o&&o(),Object(h.a)(r).then((function(e){console.warn("onClickBtn API rs",e),Object(m.FlowParseResponseAndNeedReload)({extra:N,row:V,fieldName:E,more:a,oneTableCell:R,response:e})})).finally((function(){i&&i()}))):(console.warn("Missing configApi"),t&&t())},onClickFiles:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.ctc,t=e.customMore,o=e.canUpload,i=t||G;console.warn("onClickFiles:",i),u.f.showFromComponent((function(e){return Object(g.jsx)(k,Object(r.a)(Object(r.a)({},e),{},{more:i,canUpload:o,ctc:n}))}),{title:"Modal",backdrop:"static",size:"xl",showHeader:!1,fnList:{updateCell:function(e,n){console.warn("Updatecell:",e,n)},fnGetApiPath:function(){return b.j.fnGetApiPath(B)},onChangeData:function(e){console.warn("onChangeData:",e,w),e&&w?e.Id===w.Id||w.hasOwnProperty&&e.hasOwnProperty&&w.hasOwnProperty("Photos")&&e.hasOwnProperty("Photos")?(l.HUtils.mergeObjIfExist(V[E],e),l.HUtils.runFuntion(R.fnList,"onUpdateRow",[{row:V,newRow:V}]),W()):console.warn("Update data row, wrong ID",e,w):console.warn("Update data row, wrong data",e,w)}}})}}}},511:function(e,n,t){"use strict";var o=t(52);n.a=o.apiWithConfigApi},768:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return M})),t.d(n,"ModalHtmlEditor",(function(){return y}));var o,i,a=t(4),r=t(22),l=t(0),c=t.n(l),s=t(1),d=t(11),f=t(510),u=t(9),b=t(20),h=t(35),p=t(13),j=t(87),m=t(2),g=(b.b.div(o||(o=Object(r.a)(["\n  cursor: pointer;\n  padding: 2px;\n  & > div {\n    max-height: 100px;\n    overflow: auto;\n    & p {\n      // display: initial;\n      // vertical-align: text-top;\n      margin-bottom: 0px;\n      margin-block-start: 0px;\n      margin-block-end: 0;\n      line-height: 1rem;\n      text-indent: 0px;\n    }\n    & br {\n      display: initial;\n      vertical-align: text-top;\n    }\n  }\n"]))),b.b.div(i||(i=Object(r.a)(["\n  word-break: normal;\n  & .rdw-editor-main {\n    border: 1px solid #f1f1f1;\n    min-height: 100px;\n    max-height: 300px;\n    padding: 0px 5px;\n  }\n  & .a-mode-textarea textarea {\n    // border: 1px solid rgb(233, 236, 239);\n    // border-radius: 4px;\n    width: 100%;\n    min-height: 50vh;\n    outline: none;\n    border: 1px solid #e9ecef;\n  }\n"])))),x="html",v="textarea";var O,w,y=function(e){e.sourceData,e.valueSelected,e.onChange;var n=e.valueCell,t=e.fnList,o=e.moreProps,i=e.modeToolbar,a=c.a.useState(n||""),r=Object(p.a)(a,2),l=r[0],f=r[1],u=c.a.useState(x),b=Object(p.a)(u,2),O=b[0],w=b[1],y=c.a.useState(!1),C=Object(p.a)(y,2),M=C[0],k=C[1];return Object(m.jsxs)(g,{style:{maxHeight:"calc(100vh - 5rem)"},children:[d.f.renderHeader({cModal:e.inMyModal,title:function(e){return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{className:"btn-group",children:[Object(m.jsx)(j.a,{onClick:function(){w(x)},color:O===x?"primary":"secondary",children:"HTML"}),Object(m.jsx)(j.a,{onClick:function(){try{w(v)}catch(e){console.warn("parse json error!")}},color:O===v?"primary":"secondary",children:"Code"})]}),Object(m.jsx)("div",{className:"btn-group",style:{position:"absolute",right:"3rem"},children:Object(m.jsx)(j.a,{disabled:M,onClick:function(){s.HUtils.runFuntion(t,"updateCell",[l,{cbSuccess:function(e){console.warn("cbSuccess:",e),k(!1),s.HUtils.runFuntion(t,"hideModal",[])},cbError:function(e){console.warn("cbErrro:",e),e.msg&&h.showToastWarning(e.msg),k(!1)}}])},color:"success",children:"Save"})})]})}}),Object(m.jsxs)("div",{children:[O===x&&Object(m.jsx)("div",{className:"a-mode-html",children:"react-rte"==e.htmlEditorLib?Object(m.jsx)(s.MyLib,{type:"react_rte",html:l,onChange:function(e){f(e)},modeToolbar:i,moreProps:o}):Object(m.jsx)(s.MyLib,{type:"draft_wysiwyg",html:l,onBlur:function(e){var n=e.html;console.warn("AAA",n),n!=l&&f(n)},modeToolbar:i,moreProps:o})}),O===v&&Object(m.jsx)("div",{className:"a-mode-textarea",children:Object(m.jsx)(s.MyBase,{type:"textarea",value:l,onChange:function(e){f(e)},attrs:{}})})]})]})},C=b.b.div(O||(O=Object(r.a)(["\n  cursor: pointer;\n  padding: 2px;\n  & > div {\n    max-height: 100px;\n    overflow: auto;\n    & p {\n      // display: initial;\n      // vertical-align: text-top;\n      margin-bottom: 0px;\n      margin-block-start: 0px;\n      margin-block-end: 0;\n      line-height: 1rem;\n      text-indent: 0px;\n    }\n    & br {\n      display: initial;\n      vertical-align: text-top;\n    }\n  }\n"])));b.b.div(w||(w=Object(r.a)(["\n  & .rdw-editor-main {\n    border: 1px solid #f1f1f1;\n    min-height: 100px;\n    max-height: 300px;\n    padding: 0px 5px;\n  }\n  & .a-mode-textarea textarea {\n    // border: 1px solid rgb(233, 236, 239);\n    // border-radius: 4px;\n    width: 100%;\n    min-height: 50vh;\n    outline: none;\n    border: 1px solid #e9ecef;\n  }\n"])));function M(e){var n=Object(f.a)({props:e});return Object(m.jsx)(C,{className:n.classNameWrap("mct-html_editor"),onClick:function(){n.canEdit&&d.f.showFromComponent((function(e){return Object(m.jsx)(y,Object(a.a)(Object(a.a)({},e),{},{onChange:function(t){console.warn("onChange:",t,t.Value,n.valueCell),s.HUtils.runFuntion(n,"updateFieldData",[t.Value===n.valueCell?"":t.Value,{}]),s.HUtils.runFuntion(e.fnList,"hideModal",[])},ctc:n,valueCell:n.valueCell}))}),{title:u.k.fnGetHeaderTitle(n.fnList),showHeader:!1,backdrop:"static",fnList:{updateCell:function(e,t){console.warn("Updatecell:",e,t),n.updateFieldData(e,t)}}})},children:Object(m.jsx)(s.MyUI,{type:"html",html:n.valueCell,style:Object(a.a)({},n.more.styleControl)})})}}}]);
//# sourceMappingURL=51.5cbe38f3.chunk.js.map