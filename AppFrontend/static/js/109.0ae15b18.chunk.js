(this["webpackJsonpapp-admin-v5"]=this["webpackJsonpapp-admin-v5"]||[]).push([[109],{1355:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return M}));var o,r=t(4),a=t(22),l=t(87),i=t(11),c=t(9),s=t(155),u=t(20),d=t(510),f=t(13),p=t(1),m=t(0),b=t.n(m),g=t(35),h=t(2),j=u.b.div(o||(o=Object(a.a)(["\n  & .rdw-editor-main {\n    border: 1px solid #f1f1f1;\n    min-height: 100px;\n    max-height: 300px;\n    padding: 0px 5px;\n  }\n  & .a-mode-textarea textarea {\n    // border: 1px solid rgb(233, 236, 239);\n    // border-radius: 4px;\n    width: 100%;\n    min-height: 50vh;\n    outline: none;\n    border: 1px solid #e9ecef;\n  }\n  & .a-mode-preview {\n    max-height: calc(100vh - 10rem);\n    overflow: auto;\n  }\n"]))),v="html",y="textarea",w="preview";var C,O=function(e){var n=e.valueCell,t=e.fnList,o=e.onSave,a=b.a.useState(n||""),s=Object(f.a)(a,2),u=s[0],d=s[1],m=b.a.useState(v),C=Object(f.a)(m,2),O=C[0],x=C[1],M=b.a.useState(!1),F=Object(f.a)(M,2),T=F[0],S=F[1];return Object(h.jsxs)(j,{style:{maxHeight:"calc(100vh - 5rem)"},children:[i.f.renderHeader({cModal:e.inMyModal,title:function(e){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{className:"btn-group",children:[Object(h.jsx)(l.a,{onClick:function(){x(v)},color:O===v?"primary":"secondary",children:"HTML"}),Object(h.jsx)(l.a,{onClick:function(){x(y)},color:O===y?"primary":"secondary",children:"Code"}),Object(h.jsx)(l.a,{onClick:function(){x(w)},color:O===w?"primary":"secondary",children:"Preview"})]}),Object(h.jsx)("div",{className:"btn-group",style:{position:"absolute",right:"3rem"},children:Object(h.jsx)(l.a,{disabled:T,onClick:function(){o?o(u,{fnList:Object(r.a)(Object(r.a)({},t),{},{changeLoading:function(e){S(e)}})}):p.HUtils.runFuntion(t,"updateCell",[u,{cbSuccess:function(e){console.warn("cbSuccess:",e),S(!1),c.g.hideModal(t)},cbError:function(e){console.warn("cbErrro:",e),e.msg&&g.showToastWarning(e.msg),S(!1)}}])},color:"success",children:"Save"})})]})}}),Object(h.jsxs)("div",{children:[O===v&&Object(h.jsx)("div",{className:"a-mode-html",children:Object(h.jsx)(p.MyLib,{type:"draft_wysiwyg",html:u,onBlur:function(e){var n=e.html;console.warn("AAA",n),n!=u&&d(n)}})}),O===y&&Object(h.jsx)("div",{className:"a-mode-textarea",children:Object(h.jsx)(p.MyBase,{type:"textarea",value:u,onChange:function(e){d(e)},attrs:{}})}),O===w&&Object(h.jsx)("div",{className:"a-mode-preview",children:Object(h.jsx)(p.MyUI,{type:"html",html:u})})]})]})},x=u.b.div(C||(C=Object(a.a)(["\n  display: grid;\n  padding: 2px;\n  grid-column-gap: 2px;\n  grid-row-gap: 2px;\n  grid-template-columns: ",";\n  max-height: ",";\n  & > button {\n    flex: 1;\n  }\n"])),(function(e){return e.configGrid.templateColumns}),(function(e){return e.configGrid.maxHeight}));function M(e){var n=Object(d.a)({props:e}),t=s.a.TableCell_GetLink(n),o="Body";return Object(h.jsxs)(x,{className:n.classNameWrap("mtc-cs-email-action"),configGrid:{templateColumns:"1fr",maxHeight:"60px"},children:[Object(h.jsx)(l.a,{color:"primary",title:"Edit Body",onClick:function(){console.warn("Click",t),i.f.showFromComponent((function(e){return Object(h.jsx)(O,Object(r.a)(Object(r.a)({},e),{},{onSave:function(e,t){var r=t.fnList;console.warn("onsave:",e,r),n.updateFieldData(e,{fieldName:o}),c.g.hideModal(r)},ctc:n,valueCell:n.row.Body}))}),{title:c.k.fnGetHeaderTitle(n.fnList),showHeader:!1,backdrop:"static",fnList:{updateCell:function(e,t){console.warn("Updatecell:",e,t),n.updateFieldData(e,t)}}})},children:Object(h.jsx)("i",{className:"fa fa-edit"})}),Object(h.jsx)(l.a,{color:"primary",title:"Test Send Email",onClick:function(){console.warn("Click",t),i.f.showFromMyPage({UIType:"simulator_sender_email"},{title:"Email Sender"})},children:Object(h.jsx)("i",{className:"fa fa-send"})})]})}},510:function(e,n,t){"use strict";var o=t(32),r=t(13),a=t(31),l=t(4),i=t(1),c=t(57),s=t.n(c),u=t(0),d=t.n(u),f=t(11),p=t(9),m=t(511),b=t(155),g=t(157),h=t(79),j=t(2),v="fnGetScreenCode",y=function(e){var n=e.oneTableCell,t=Object(l.a)({},n.fnList);return t[p.O]=function(){var e=n.row,o=n.extra,r=n.extra.Type.source,a=p.j.getSourceList(t);if(g.e(r))return g.b(a,r,e,o.Type.sourceField);if(r&&r.startsWith("["))return i.HJson.getObj(r);if(r&&r.startsWith("f")){var l=r.slice(1,r.length);return null!=e[l]&&Array.isArray(e[l])?e[l]:null!=e[r]&&Array.isArray(e[r])?e[r]:[]}return a[r]||[]},t[p.T]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.customMore,o=e.count,r=e.tooltip,a=n.row,l=n.more;return C.renderBadge({more:t||l,row:a,count:o,tooltip:r})},t[p.H]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.customTitle;return b.a.Cell_GetHeaderTitle({extra:n.extra,customTitle:t})},t[p.u]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,o=n.more,r=t;return o&&o.hasOwnProperty(e)&&(r=o[e]),r},t[p.v]=function(){var e=n.row,t=n.extra,o=n.more;return b.a.Cell_GetConfigModal({extra:t,more:o,row:e})},t[p.I]=function(){var e=n.row,t=n.extra,o=n.more,r=n.getValue();if(!1===Object(h.FlowGetCanShow)({extra:t,row:e,more:o}))return!0;return!(!o[h.KMore.hideWhenEmpty]||""!==r&&null!=r&&0!==r)||(!(!o[h.KMore.hideWhenNull]||null!=r)||!!(i.MyTableCellHelpers.ConfigByTypes&&i.MyTableCellHelpers.ConfigByTypes[n.type]&&i.MyTableCellHelpers.ConfigByTypes[n.type].isHide&&i.MyTableCellHelpers.ConfigByTypes[n.type].isHide(n)))},t.onSendMsg=function(e){console.error("missing onSendMsg, need update fnList",e)},t.onReExpand=function(){var e=n.row;i.HUtils.runFuntion(e,"_fnForceUpdateDetail")},n.fnList=t,t},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return i.HUtils.runFuntion(e.fnList,v,n)},C={renderBadge:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.more,t=void 0===n?{}:n,o=e.row,r=void 0===o?{}:o,a=e.count,l=e.tooltip,c=t.configBadge||t.badge;if(null!=a||c&&!0===c.show){var s=a,u=l;if(c&&c.fCount&&null!=r[c.fCount]&&(s=r[c.fCount]),s)return c&&c.fTooltip&&r[c.fTooltip]&&(u=r[c.fTooltip]),u?Object(j.jsx)(f.k,{overlay:Object(j.jsx)(i.MyUI,{type:"html",html:u}),children:Object(j.jsx)("span",{className:"mct-ui-badge",children:s})}):Object(j.jsx)("span",{className:"mct-ui-badge",children:s})}}},O=t(156),x="fnRequestUpdate",M="fnRequestCustom";function F(e){var n=e.ctc,t=e.more,o=n.row.Id,r=w(n),a={};t&&(t.fID&&n.row[t.fID]&&(o=n.row[t.fID]),a=t.configFile||t.file||{});var c=Object(l.a)({needRequestPhotos:!0,pasteAsFile:!0,showUploadFromGGDrive:!1},a),s={ScreenCode:r,ProjectId:"",Id:o,FieldName:n.fieldName};return Object(j.jsx)("div",{children:Object(j.jsx)(i.MyUI,{type:"file_manager",requestData:s,fnList:e.fnList,configFile:c,canUpload:e.canUpload})})}var T=function(e){e.fieldName;var n=e.extra,t=e.row,o=n||{},r=e.more,l=!1;if("boolean"===typeof o.CanEdit&&(l=o.CanEdit),1==l)if(null==r.fCanEdit&&null!=r.canEditF&&(r.fCanEdit=r.canEditF),"boolean"===typeof r.fCanEdit)l=r.fCanEdit;else if("string"===typeof r.fCanEdit&&r.fCanEdit.length>0)if(null!=t[r.fCanEdit])l=t[r.fCanEdit];else if(r.fCanEdit.indexOf(",")>-1){var i=r.fCanEdit.split(",");if(i&&i.length>0){var c,s=Object(a.a)(i);try{for(s.s();!(c=s.n()).done;){if(0==t[c.value]){l=!1;break}}}catch(m){s.e(m)}finally{s.f()}}}if(null!=r.lockF||null!=r.fLock){var u=r.lockF||r.fLock;if("boolean"==typeof u)l=!u;else if("string"==typeof u&&u.length>0)if(null!=t[u])l=!t[u];else if(u.indexOf(",")>-1){var d=u.split(",");if(d&&d.length>0){var f,p=Object(a.a)(d);try{for(p.s();!(f=p.n()).done;){if(1==t[f.value]){l=!1;break}}}catch(m){p.e(m)}finally{p.f()}}}}return l};n.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.props;0;var t=Object(u.useState)(0),a=Object(r.a)(t,2),c=(a[0],a[1],Object(u.useState)(null===n.cell||void 0===n.cell?"":n.cell)),g=Object(r.a)(c,2),v=g[0],w=g[1],C=n.cell,S=n.extra,E=S.fieldName,k=Object(u.useState)(!1),N=Object(r.a)(k,2),L=N[0],H=N[1],U=Object(u.useState)(!1),A=Object(r.a)(U,2),P=A[0],R=A[1],B=d.a.useRef(new i.OneTableCell(n)),D=B.current;D.row=n.row,D.extra=S,n.custom&&!0!==D._updateCustom&&(D.more=Object(l.a)(Object(l.a)({},n.custom.more),D.more),D._updateCustom=!0);var I=D.row,G=d.a.useRef(y({oneTableCell:D,row:I,extra:S,cell:C})),_=G.current;null==D._onePage&&D.updateOnePage(p.j.fnGetOnePage(_));var q=D.more,V=Object(O.a)(),W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.cbWhenEqual,t=I[E];console.log("updateValueCellFromRow:",t),v!=t?w(null===t||void 0===t?"":t):(console.log("call cbWhenEqual"),n&&n())};return!0===I.IsLocked?D.canEdit=!1:null!=D.canEdit&&!0!==D.canEdit&&!1!==D.canEdit||(D.canEdit=T({extra:D.extra,more:q,row:I})),d.a.useEffect((function(){"string"===typeof n.cell||"number"===typeof n.cell||"boolean"===typeof n.cell?n.cell!=v&&w(n.cell):w(n.cell)}),[n.cell]),{forceUpdate:V,fnList:_,updateValueCellFromRow:W,oneTableCell:D,extra:D.extra,row:D.row,fieldName:D.fieldName,more:D.more,moreObj:D.more,canEdit:D.canEdit,updateFieldData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.warn("updateFieldData:",e,D),e==C||null==C&&""==e?(console.warn("not update:",e,C,t),t&&t.cbError&&t.cbError({msg:"Nothing to change"})):(H(!0),i.HUtils.runFuntion(D.fnList,x,[Object(l.a)(Object(l.a)({},t),{},{apiController:p.j.fnGetApiPath(_),fieldName:t.fieldName||D.fieldName,row:D.row,newValue:e,cbSuccess:function(e){console.warn("cbss",e),H(!1),p.j.fnForceUpdateTable(_,[]),t&&t.cbSuccess&&t.cbSuccess(e),n.fnList&&n.fnList.cbSuccessUpdate&&n.fnList.cbSuccessUpdate()},cbError:function(n){console.warn("cber",n),H(!1),t&&t.cbError&&t.cbError(e)}})]))},requestCustom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("requestCustom:",e),i.HUtils.runFuntion(D.fnList,M,[Object(l.a)({},e)])},getSharedConfig:function(){return{}},getMoreAttrsFromCustomConfig:function(){return i.MyTableCellHelpers.ConfigByTypes&&i.MyTableCellHelpers.ConfigByTypes[D.type]&&i.MyTableCellHelpers.ConfigByTypes[D.type].moreAttrs?i.MyTableCellHelpers.ConfigByTypes[D.type].moreAttrs:{}},getMorePropsButton:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.defaultStyle,t={},o=n||{};return P&&(t.disabled=!0),q&&q.button&&q.button.style&&(o=Object(l.a)(Object(l.a)({},o),q.button.style)),o&&Object.keys(o).length>0&&(t.style=o),t},renderHide:function(){return Object(j.jsx)("div",{className:"disabled"})},isUpdating:L,setIsUpdating:function(e){H(e)},isFetching:P,setIsFetching:R,valueCell:v,setValueCell:w,classNameWrap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s()(e,Object(l.a)({disabled:!1===D.canEdit,"a-scrwhhover":null!=q.scrwhhover?q.scrwhhover:t.scrwhhover||!1,"styled-mini":q.styledMini},null!=n.custom&&null!=n.custom.className?Object(o.a)({},n.custom.className,!0):{}))},styleWrap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return b.a.Cell_GetStyleCell({extra:S,more:q,row:I,defaultStyle:e,overideStyle:n})},onUpdateRow:function(e){i.HUtils.runFuntion(D.fnList,"onUpdateRow",[{row:I,newRow:e}])},getTextDisplaySelect:function(){var e="";if(q.fDisplay&&I[q.fDisplay]?e=I[q.fDisplay]:q.fShow&&I[q.fShow]&&(e=I[q.fShow]),""==e&&null!=v&&""!==v){var n=_.fnGetSourceData(),t=i.HOptions.getTextDisplayOfValueFromOptions(n,v);t&&(e=t)}return""==e&&(e=v||""),e},renderTopRight:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(j.jsx)(i.MyTableCell,Object(l.a)(Object(l.a)({},n),{},{fnList:_,more:q,oneTableCell:D,type:"_barTopRight",moreBtns:e,moreConfig:t}))},renderLoadingOverlay:function(){return Object(j.jsx)("div",{className:"a-overlay-center",children:Object(j.jsx)(i.MyLoading,{type:"threedotsvertical",size:12})})},onClickForm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.customMore,t=e.cbSuccess,o=e.customShowForm,r=n||q;console.warn("onClickForm:",r),R(!0),Object(h.FlowCheckApiShowModal)({extra:S,row:I,more:q,fnList:_,cb:function(e){var n=e.canShow;e.config;if(n){var a=D.getConfigForm({customMore:r}),c=I;if(r.fDefaultValues&&(c=I[r.fDefaultValues]?I[r.fDefaultValues]:{}),a){var s=i.MyFormControlHelpers.getConfigFormFromConfigV1(a,{defaultValues:c,fnList:Object(l.a)(Object(l.a)({},_),{},{onSubmitForm:function(e,n){var o=n.myForm;console.warn("onSubmitForm:",e);var a=D.getConfigApi({customMore:r});return new Promise((function(n,r){a?(a.query=Object.assign(a.query,e),Object(m.a)(a).then((function(e){console.warn("onClickBtn API rs",e),Object(h.FlowParseResponseAndNeedReload)({extra:S,row:I,fieldName:E,more:q,oneTableCell:D,response:e}),o.closeMyModal&&o.closeMyModal(),t&&t(e),n(e)})).catch((function(e){r(e)}))):(console.warn("Missing configApi"),r("Missing configApi"))}))}})}),u=D.getConfigModal({customMore:r});o?o(s,Object(l.a)({},u)):f.f.showFromMyForm(s,Object(l.a)({},u))}else console.error("Missing configForm:",a)}R(!1)}})},onClickApi:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.customMore,t=(e.cbSuccess,e.cbError),o=e.cbBeforeRequest,r=e.cbAfterRequest,a=n||q;console.warn("onClickApi:",a);var l=D.getConfigApi({customMore:a});a.confirmMsg?f.f.showConfirm({title:a.titleConfirm||"Confirm",msg:a.confirmMsg,onClickOK:function(e){l?(o&&o(),Object(m.a)(l).then((function(e){console.warn("onClickBtn API rs",e),Object(h.FlowParseResponseAndNeedReload)({extra:S,row:I,fieldName:E,more:a,oneTableCell:D,response:e})})).finally((function(){r&&r()}))):console.warn("Missing configApi"),e&&e.hide&&e.hide()}}):l?(o&&o(),Object(m.a)(l).then((function(e){console.warn("onClickBtn API rs",e),Object(h.FlowParseResponseAndNeedReload)({extra:S,row:I,fieldName:E,more:a,oneTableCell:D,response:e})})).finally((function(){r&&r()}))):(console.warn("Missing configApi"),t&&t())},onClickFiles:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.ctc,t=e.customMore,o=e.canUpload,r=t||q;console.warn("onClickFiles:",r),f.f.showFromComponent((function(e){return Object(j.jsx)(F,Object(l.a)(Object(l.a)({},e),{},{more:r,canUpload:o,ctc:n}))}),{title:"Modal",backdrop:"static",size:"xl",showHeader:!1,fnList:{updateCell:function(e,n){console.warn("Updatecell:",e,n)},fnGetApiPath:function(){return p.j.fnGetApiPath(_)},onChangeData:function(e){console.warn("onChangeData:",e,C),e&&C?e.Id===C.Id||C.hasOwnProperty&&e.hasOwnProperty&&C.hasOwnProperty("Photos")&&e.hasOwnProperty("Photos")?(i.HUtils.mergeObjIfExist(I[E],e),i.HUtils.runFuntion(D.fnList,"onUpdateRow",[{row:I,newRow:I}]),V()):console.warn("Update data row, wrong ID",e,C):console.warn("Update data row, wrong data",e,C)}}})}}}},511:function(e,n,t){"use strict";var o=t(52);n.a=o.apiWithConfigApi}}]);
//# sourceMappingURL=109.0ae15b18.chunk.js.map